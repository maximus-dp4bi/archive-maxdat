
DELETE FROM F_METRIC
WHERE D_METRIC_PROJECT_ID IN (
  SELECT D_METRIC_PROJECT_ID 
  FROM D_METRIC_PROJECT mp
  INNER JOIN D_PROJECT pj on mp.D_PROJECT_ID = pj.D_PROJECT_ID
  INNER JOIN D_PROGRAM pg on mp.D_PROGRAM_ID = pg.D_PROGRAM_ID
  WHERE pg.PROGRAM_NAME = 'Unknown'
);

DELETE 
FROM D_METRIC_PROJECT
WHERE D_METRIC_PROJECT_ID IN (
	SELECT D_METRIC_PROJECT_ID 
	FROM D_METRIC_PROJECT mp
	INNER JOIN D_PROJECT pj on mp.D_PROJECT_ID = pj.D_PROJECT_ID
	INNER JOIN D_PROGRAM pg on mp.D_PROGRAM_ID = pg.D_PROGRAM_ID
	WHERE pg.PROGRAM_NAME = 'Unknown'
);

INSERT INTO CC_L_PATCH_LOG ( PATCH_VERSION , SCRIPT_SEQUENCE , SCRIPT_NAME) 
	VALUES ('2.5','006','006_DELETE_INVALID_METRIC_PROJECT_RECORDS');

COMMIT;