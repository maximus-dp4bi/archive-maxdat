alter session set nls_date_format = 'YYYY-MM-DD HH24:MI:SS';

--Check for any unexpected TXEB SITE records
SELECT * 
FROM CC_D_SITE
WHERE SITE_NAME NOT IN ('Athens','Austin','Edinburg','Midland','Unknown');

--Check for any CC_F_AGENT_ACTIVITY_BY_DATE records still assoc. w/ the Unknown Site dimension
SELECT dproj.PROJECT_NAME, dprog.PROGRAM_NAME, dgeo.GEOGRAPHY_NAME, ds.SITE_NAME, da.LAST_NAME, da.FIRST_NAME, dd.D_DATE, dat.ACTIVITY_TYPE_NAME
FROM CC_F_AGENT_ACTIVITY_BY_DATE faabd
INNER JOIN CC_D_PROJECT dproj on faabd.D_PROJECT_ID = dproj.PROJECT_ID
INNER JOIN CC_D_PROGRAM dprog on faabd.D_PROGRAM_ID = dprog.PROGRAM_ID
INNER JOIN CC_D_ACTIVITY_TYPE dat on faabd.D_ACTIVITY_TYPE_ID = dat.D_ACTIVITY_TYPE_ID
INNER JOIN CC_D_SITE ds on faabd.D_SITE_ID = ds.D_SITE_ID
INNER JOIN CC_D_AGENT da on faabd.D_AGENT_ID = da.D_AGENT_ID
INNER JOIN CC_D_DATES dd on faabd.D_DATE_ID = dd.D_DATE_ID
INNER JOIN CC_D_GROUP dg on faabd.D_GROUP_ID = dg.D_GROUP_ID
INNER JOIN CC_D_GEOGRAPHY_MASTER dgeo on faabd.D_GEOGRAPHY_MASTER_ID = dgeo.GEOGRAPHY_MASTER_ID 
WHERE ds.SITE_NAME = 'Unknown'
ORDER BY dproj.PROJECT_NAME, dprog.PROGRAM_NAME, dgeo.GEOGRAPHY_NAME, ds.SITE_NAME, da.LAST_NAME, da.FIRST_NAME, dd.D_DATE, dat.ACTIVITY_TYPE_NAME;

--Check for any CC_F_AGENT_BY_DATE records still assoc. w/ the Unknown Site dimension
SELECT dproj.PROJECT_NAME, dprog.PROGRAM_NAME, dgeo.GEOGRAPHY_NAME, ds.SITE_NAME, da.LAST_NAME, da.FIRST_NAME, dd.D_DATE
FROM CC_F_AGENT_BY_DATE fabd
INNER JOIN CC_D_PROJECT_TARGETS dpt on fabd.D_PROJECT_TARGETS_ID = dpt.D_PROJECT_TARGETS_ID
INNER JOIN CC_D_PROJECT dproj on dpt.PROJECT_ID = dproj.PROJECT_ID
INNER JOIN CC_D_PROGRAM dprog on fabd.D_PROGRAM_ID = dprog.PROGRAM_ID
INNER JOIN CC_D_SITE ds on fabd.D_SITE_ID = ds.D_SITE_ID
INNER JOIN CC_D_AGENT da on fabd.D_AGENT_ID = da.D_AGENT_ID
INNER JOIN CC_D_DATES dd on fabd.D_DATE_ID = dd.D_DATE_ID
INNER JOIN CC_D_GROUP dg on fabd.D_GROUP_ID = dg.D_GROUP_ID
INNER JOIN CC_D_GEOGRAPHY_MASTER dgeo on fabd.D_GEOGRAPHY_MASTER_ID = dgeo.GEOGRAPHY_MASTER_ID 
WHERE ds.SITE_NAME = 'Unknown'
ORDER BY dproj.PROJECT_NAME, dprog.PROGRAM_NAME, dgeo.GEOGRAPHY_NAME, ds.SITE_NAME, da.LAST_NAME, da.FIRST_NAME, dd.D_DATE;