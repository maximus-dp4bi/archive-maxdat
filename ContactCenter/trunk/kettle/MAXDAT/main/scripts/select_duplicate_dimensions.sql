-- Activity Types
SELECT * 
FROM 
	(SELECT
			D_ACTIVITY_TYPE_ID
	  , ACTIVITY_TYPE_NAME
	  , VERSION
	  , RECORD_EFF_DT
	  , RECORD_END_DT
	  , LEAD (RECORD_EFF_DT , 1, NULL) OVER (PARTITION BY ACTIVITY_TYPE_NAME ORDER BY ACTIVITY_TYPE_NAME, VERSION, RECORD_EFF_DT, RECORD_END_DT) as NEXT_EFF_DT
	  FROM CC_D_ACTIVITY_TYPE a
	  ORDER BY ACTIVITY_TYPE_NAME, VERSION, RECORD_EFF_DT, RECORD_END_DT
	  )sub 
WHERE RECORD_END_DT > NEXT_EFF_DT
ORDER BY ACTIVITY_TYPE_NAME, VERSION, RECORD_EFF_DT, RECORD_END_DT
;


--  Agents
SELECT * 
FROM 
	(SELECT
			D_AGENT_ID
	  , LOGIN_ID
	  , FIRST_NAME
    , LAST_NAME
	  , VERSION
	  , RECORD_EFF_DT
	  , RECORD_END_DT
	  , LEAD (RECORD_EFF_DT , 1, NULL) OVER (PARTITION BY LOGIN_ID ORDER BY LOGIN_ID, VERSION, RECORD_EFF_DT, RECORD_END_DT) as NEXT_EFF_DT
	  FROM CC_D_AGENT a
	  ORDER BY LOGIN_ID, VERSION, RECORD_EFF_DT, RECORD_END_DT
	  )sub 
WHERE RECORD_END_DT > NEXT_EFF_DT
ORDER BY LOGIN_ID, VERSION, RECORD_EFF_DT, RECORD_END_DT
;

-- Contact Queues
SELECT * 
FROM 
	(SELECT
			D_CONTACT_QUEUE_ID
	  , QUEUE_NUMBER
	  , QUEUE_NAME
	  , VERSION
	  , RECORD_EFF_DT
	  , RECORD_END_DT
	  , LEAD (RECORD_EFF_DT , 1, NULL) OVER (PARTITION BY QUEUE_NUMBER ORDER BY QUEUE_NUMBER, VERSION, RECORD_EFF_DT, RECORD_END_DT) as NEXT_EFF_DT
	  FROM CC_D_CONTACT_QUEUE a
	  ORDER BY QUEUE_NUMBER, VERSION, RECORD_EFF_DT, RECORD_END_DT
	  )sub 
WHERE RECORD_END_DT > NEXT_EFF_DT
ORDER BY QUEUE_NUMBER, VERSION, RECORD_EFF_DT, RECORD_END_DT
;

-- Groups
SELECT * 
FROM 
	(SELECT
			D_GROUP_ID
	  , GROUP_NAME
	  , VERSION
	  , RECORD_EFF_DT
	  , RECORD_END_DT
	  , LEAD (RECORD_EFF_DT , 1, NULL) OVER (PARTITION BY GROUP_NAME ORDER BY GROUP_NAME, VERSION, RECORD_EFF_DT, RECORD_END_DT) as NEXT_EFF_DT
	  FROM CC_D_GROUP a
	  ORDER BY GROUP_NAME, VERSION, RECORD_EFF_DT, RECORD_END_DT
	  )sub 
WHERE RECORD_END_DT > NEXT_EFF_DT
ORDER BY GROUP_NAME, VERSION, RECORD_EFF_DT, RECORD_END_DT
;


-- IVR Self Service Path
SELECT * 
FROM 
	(SELECT
			D_IVR_SELF_SERVICE_PATH_ID
	  , BEGIN_NODE
    , END_NODE
	  , VERSION
	  , RECORD_EFF_DT
	  , RECORD_END_DT
	  , LEAD (RECORD_EFF_DT , 1, NULL) OVER (PARTITION BY BEGIN_NODE, END_NODE ORDER BY BEGIN_NODE, END_NODE, VERSION, RECORD_EFF_DT, RECORD_END_DT) as NEXT_EFF_DT
	  FROM CC_D_IVR_SELF_SERVICE_PATH a
	  ORDER BY BEGIN_NODE, END_NODE, VERSION, RECORD_EFF_DT, RECORD_END_DT
	  )sub 
WHERE RECORD_END_DT > NEXT_EFF_DT
ORDER BY BEGIN_NODE, END_NODE, VERSION, RECORD_EFF_DT, RECORD_END_DT
;


-- Production Plan
SELECT * 
FROM 
	(SELECT
			PRODUCTION_PLAN_ID
	  , PRODUCTION_PLAN_NAME
    , PROJECT_ID
    , PROGRAM_ID
    , GEOGRAPHY_MASTER_ID
	  , EFFECTIVE_DATE
    , END_DATE
	  , LEAD (EFFECTIVE_DATE , 1, NULL) OVER (
        PARTITION BY PRODUCTION_PLAN_NAME, PROJECT_ID, PROGRAM_ID, GEOGRAPHY_MASTER_ID 
        ORDER BY PRODUCTION_PLAN_NAME, PROJECT_ID, PROGRAM_ID, GEOGRAPHY_MASTER_ID, EFFECTIVE_DATE, END_DATE
    ) as NEXT_EFF_DT
	  FROM CC_D_PRODUCTION_PLAN a
	  ORDER BY PRODUCTION_PLAN_NAME, PROJECT_ID, PROGRAM_ID, GEOGRAPHY_MASTER_ID, EFFECTIVE_DATE, END_DATE
	  )sub 
WHERE END_DATE > NEXT_EFF_DT
ORDER BY PRODUCTION_PLAN_NAME, PROJECT_ID, PROGRAM_ID, GEOGRAPHY_MASTER_ID, EFFECTIVE_DATE, END_DATE
;

-- Sites
SELECT * 
FROM 
	(SELECT
			D_SITE_ID
	  , SITE_NAME
	  , VERSION
	  , RECORD_EFF_DT
	  , RECORD_END_DT
	  , LEAD (RECORD_EFF_DT , 1, NULL) OVER (PARTITION BY SITE_NAME ORDER BY SITE_NAME, VERSION, RECORD_EFF_DT, RECORD_END_DT) as NEXT_EFF_DT
	  FROM CC_D_SITE a
	  ORDER BY SITE_NAME, VERSION, RECORD_EFF_DT, RECORD_END_DT
	  )sub 
WHERE RECORD_END_DT > NEXT_EFF_DT
ORDER BY SITE_NAME, VERSION, RECORD_EFF_DT, RECORD_END_DT
;

-- Units of Work
SELECT UNIT_OF_WORK_NAME 
FROM CC_D_UNIT_OF_WORK
GROUP BY UNIT_OF_WORK_NAME
HAVING COUNT(*) > 1
;

