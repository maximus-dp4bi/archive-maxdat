-- DELETE DAYLIGHT SAVINGS TIME INTERVALS THAT DON'T EXIST!!

DELETE
FROM CC_S_ACD_INTERVAL ai
WHERE ai.INTERVAL_ID IN (SELECT INTERVAL_ID FROM CC_S_INTERVAL si WHERE si.INTERVAL_START_DATE >= to_date('09-MAR-2014 02:00:00', 'dd-MON-yyyy HH:MI:SS') AND si.INTERVAL_START_DATE < to_date('09-MAR-2014 03:00:00', 'dd-MON-yyyy HH:MI:SS'));

DELETE CC_S_INTERVAL WHERE INTERVAL_START_DATE = to_date('10-MAR-2013 02:00:00', 'dd-MON-yyyy HH:MI:SS');
DELETE CC_S_INTERVAL WHERE INTERVAL_START_DATE = to_date('10-MAR-2013 02:15:00', 'dd-MON-yyyy HH:MI:SS');
DELETE CC_S_INTERVAL WHERE INTERVAL_START_DATE = to_date('10-MAR-2013 02:30:00', 'dd-MON-yyyy HH:MI:SS');
DELETE CC_S_INTERVAL WHERE INTERVAL_START_DATE = to_date('10-MAR-2013 02:45:00', 'dd-MON-yyyy HH:MI:SS');

DELETE CC_S_INTERVAL WHERE INTERVAL_START_DATE = to_date('09-MAR-2014 02:00:00', 'dd-MON-yyyy HH:MI:SS');
DELETE CC_S_INTERVAL WHERE INTERVAL_START_DATE = to_date('09-MAR-2014 02:15:00', 'dd-MON-yyyy HH:MI:SS');
DELETE CC_S_INTERVAL WHERE INTERVAL_START_DATE = to_date('09-MAR-2014 02:30:00', 'dd-MON-yyyy HH:MI:SS');
DELETE CC_S_INTERVAL WHERE INTERVAL_START_DATE = to_date('09-MAR-2014 02:45:00', 'dd-MON-yyyy HH:MI:SS');

DELETE CC_S_INTERVAL WHERE INTERVAL_START_DATE = to_date('08-MAR-2015 02:00:00', 'dd-MON-yyyy HH:MI:SS');
DELETE CC_S_INTERVAL WHERE INTERVAL_START_DATE = to_date('08-MAR-2015 02:15:00', 'dd-MON-yyyy HH:MI:SS');
DELETE CC_S_INTERVAL WHERE INTERVAL_START_DATE = to_date('08-MAR-2015 02:30:00', 'dd-MON-yyyy HH:MI:SS');
DELETE CC_S_INTERVAL WHERE INTERVAL_START_DATE = to_date('08-MAR-2015 02:45:00', 'dd-MON-yyyy HH:MI:SS');

DELETE CC_S_INTERVAL WHERE INTERVAL_START_DATE = to_date('13-MAR-2016 02:00:00', 'dd-MON-yyyy HH:MI:SS');
DELETE CC_S_INTERVAL WHERE INTERVAL_START_DATE = to_date('13-MAR-2016 02:15:00', 'dd-MON-yyyy HH:MI:SS');
DELETE CC_S_INTERVAL WHERE INTERVAL_START_DATE = to_date('13-MAR-2016 02:30:00', 'dd-MON-yyyy HH:MI:SS');
DELETE CC_S_INTERVAL WHERE INTERVAL_START_DATE = to_date('13-MAR-2016 02:45:00', 'dd-MON-yyyy HH:MI:SS');

DELETE CC_S_INTERVAL WHERE INTERVAL_START_DATE = to_date('12-MAR-2017 02:00:00', 'dd-MON-yyyy HH:MI:SS');
DELETE CC_S_INTERVAL WHERE INTERVAL_START_DATE = to_date('12-MAR-2017 02:15:00', 'dd-MON-yyyy HH:MI:SS');
DELETE CC_S_INTERVAL WHERE INTERVAL_START_DATE = to_date('13-MAR-2017 02:30:00', 'dd-MON-yyyy HH:MI:SS');
DELETE CC_S_INTERVAL WHERE INTERVAL_START_DATE = to_date('13-MAR-2017 02:45:00', 'dd-MON-yyyy HH:MI:SS');

INSERT INTO CC_L_PATCH_LOG (PATCH_VERSION, SCRIPT_SEQUENCE, SCRIPT_NAME)
VALUES ('0.3.1',118,'118_DELETE_INVALID_DST_INTERVAL_RECORDS');

COMMIT;