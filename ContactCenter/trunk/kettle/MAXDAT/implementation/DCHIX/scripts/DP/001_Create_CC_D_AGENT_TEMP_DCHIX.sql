--Create temp table CC_D_AGENT_TEMP_DCHIX for QA Scorecard

CREATE SEQUENCE SEQ_CC_D_AGENT_TEMP_DCHIX START WITH 1 INCREMENT BY 1 MAXVALUE 9999999999999999999 MINVALUE 1 CACHE 20 ;

CREATE TABLE CC_D_AGENT_TEMP_DCHIX
  (
    D_AGENT_ID NUMBER (19) NOT NULL ,
    LOGIN_ID NVARCHAR2 (100) NOT NULL ,
    FIRST_NAME       VARCHAR2 (50) NOT NULL ,
    MIDDLE_INITIAL   VARCHAR2 (20) NOT NULL ,
    LAST_NAME        VARCHAR2 (50) NOT NULL ,
    JOB_TITLE        VARCHAR2 (50) NOT NULL ,
    LANGUAGE         VARCHAR2 (50) NOT NULL ,
    SITE_NAME        VARCHAR2 (50) NOT NULL ,
    HOURLY_RATE      NUMBER (5,2) NOT NULL ,
    RATE_CURRENCY    VARCHAR2 (3) NOT NULL ,
    HIRE_DATE        DATE ,
    TERMINATION_DATE DATE ,
    VERSION          NUMBER (10) NOT NULL ,
    RECORD_EFF_DT    DATE NOT NULL ,
    RECORD_END_DT    DATE NOT NULL
  )
  TABLESPACE MAXDAT_DATA LOGGING ENABLE ROW MOVEMENT ;
  
ALTER TABLE CC_D_AGENT_TEMP_DCHIX ADD CONSTRAINT CC_D_AGENT_TEMP_REC_DATE_CK CHECK
(
  RECORD_EFF_DT <= RECORD_END_DT
)
;

CREATE UNIQUE INDEX CC_D_AGENT_TEMP__IDX ON CC_D_AGENT_TEMP_DCHIX
  (
    D_AGENT_ID ASC
  )
  TABLESPACE MAXDAT_INDX LOGGING ;
  
  ALTER TABLE CC_D_AGENT_TEMP_DCHIX ADD CONSTRAINT CC_D_AGENT_TEMP_PK PRIMARY KEY
  (
    D_AGENT_ID
  )
  ;
  
  ALTER TABLE CC_D_AGENT_TEMP_DCHIX ADD CONSTRAINT CC_D_AGENT_TEMP__UN UNIQUE
  (
    LOGIN_ID , RECORD_EFF_DT
  )
  ;
  
  
  CREATE OR REPLACE TRIGGER BI_CC_D_AGENT_TEMP_DCHIX
      BEFORE INSERT ON CC_D_AGENT_TEMP_DCHIX
      FOR EACH ROW 
      ENABLE 
  BEGIN
  IF INSERTING AND :NEW.D_AGENT_ID IS NULL THEN 
            SELECT SEQ_CC_D_AGENT_TEMP_DCHIX.NEXTVAL INTO :NEW.D_AGENT_ID FROM DUAL;      
  END IF;
  END;  
  /


CREATE OR REPLACE VIEW CC_D_AGENT_TEMP_DCHIX_SV  AS
SELECT * FROM CC_D_AGENT_TEMP_DCHIX ;

GRANT SELECT ON CC_D_AGENT_TEMP_DCHIX_SV TO MAXDAT_READ_ONLY;

GRANT select on CC_D_AGENT_TEMP_DCHIX to DP_SCORECARD_DCHIX WITH GRANT OPTION;