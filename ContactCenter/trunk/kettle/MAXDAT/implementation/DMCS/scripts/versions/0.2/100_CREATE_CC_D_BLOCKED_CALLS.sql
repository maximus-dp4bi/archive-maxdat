--Create new table CC_D_BLOCKED_CALLS and new view CC_D_BLOCKED_CALLS_SV

CREATE TABLE CC_D_BLOCKED_CALLS
  (
    D_DATE DATE NOT NULL,
    BLOCKED_CALLS NUMBER(7,0) ,
    LAST_UPDATE_DT            DATE NOT NULL ,
    LAST_UPDATE_BY            VARCHAR2 (30) NOT NULL
  )
  TABLESPACE MAXDAT_DATA LOGGING ;

CREATE OR REPLACE TRIGGER BIU_CC_D_BLOCKED_CALLS
    BEFORE INSERT OR UPDATE ON CC_D_BLOCKED_CALLS
    FOR EACH ROW 
    ENABLE 
BEGIN
:NEW.LAST_UPDATE_DT := SYSDATE;
:NEW.LAST_UPDATE_BY := USER;
END; 
/

CREATE OR REPLACE VIEW CC_D_BLOCKED_CALLS_SV
AS SELECT 
	CC_D_BLOCKED_CALLS.D_DATE, 
	CC_D_BLOCKED_CALLS.BLOCKED_CALLS,
	CC_D_BLOCKED_CALLS.LAST_UPDATE_DT,
	CC_D_BLOCKED_CALLS.LAST_UPDATE_BY 
   FROM 
	CC_D_BLOCKED_CALLS;

CREATE PUBLIC SYNONYM CC_D_BLOCKED_CALLS_SV FOR CC_D_BLOCKED_CALLS_SV;

CREATE PUBLIC SYNONYM CC_D_BLOCKED_CALLS FOR CC_D_BLOCKED_CALLS;

GRANT ALL ON CC_D_BLOCKED_CALLS TO MAXDAT_REPORTS;

