CREATE TABLE CC_S_ACD_QUEUE_INTERVAL 
    ( 
     ACD_QUEUE_INTERVAL_ID NUMBER (19)  NOT NULL , 
     INTERVAL_DATE DATE DEFAULT SYSDATE  NOT NULL , 
     CONTACT_QUEUE_ID NUMBER (19)  NOT NULL , 
     INTERVAL_ID NUMBER (19)  NOT NULL , 
     CONTACTS_RECEIVED_FROM_IVR NUMBER (12,0) DEFAULT 0  NOT NULL , 
     CONTACTS_OFFERED NUMBER (12,0) DEFAULT 0  NOT NULL , 
     CONTACTS_HANDLED NUMBER (12,0) DEFAULT 0  NOT NULL , 
     CONTACTS_ABANDONED NUMBER (12,0) DEFAULT 0  NOT NULL , 
     MIN_HANDLE_TIME NUMBER (11,2) DEFAULT 0  NOT NULL , 
     MAX_HANDLE_TIME NUMBER (11,2) DEFAULT 0  NOT NULL , 
     MEAN_HANDLE_TIME NUMBER (11,2) DEFAULT 0  NOT NULL , 
     MEDIAN_HANDLE_TIME NUMBER (11,2) DEFAULT 0  NOT NULL , 
     STDDEV_HANDLE_TIME NUMBER (11,2) DEFAULT 0  NOT NULL , 
     MIN_SPEED_TO_HANDLE NUMBER (11,2) DEFAULT 0  NOT NULL , 
     MAX_SPEED_TO_HANDLE NUMBER (11,2) DEFAULT 0  NOT NULL , 
     MEAN_SPEED_TO_HANDLE NUMBER (11,2) DEFAULT 0  NOT NULL , 
     MEDIAN_SPEED_TO_HANDLE NUMBER (11,2) DEFAULT 0  NOT NULL , 
     STDDEV_SPEED_TO_HANDLE NUMBER (11,2) DEFAULT 0  NOT NULL , 
     MIN_SPEED_OF_ANSWER NUMBER (11,2) DEFAULT 0  NOT NULL , 
     MAX_SPEED_OF_ANSWER NUMBER (11,2) DEFAULT 0  NOT NULL , 
     MEAN_SPEED_OF_ANSWER NUMBER (11,2) DEFAULT 0  NOT NULL , 
     MEDIAN_SPEED_OF_ANSWER NUMBER (11,2) DEFAULT 0  NOT NULL , 
     STDDEV_SPEED_OF_ANSWER NUMBER (11,2) DEFAULT 0  NOT NULL , 
     SPEED_OF_ANSWER_PERIOD_1 NUMBER (7) DEFAULT 0  NOT NULL , 
     SPEED_OF_ANSWER_PERIOD_2 NUMBER (7) DEFAULT 0  NOT NULL , 
     SPEED_OF_ANSWER_PERIOD_3 NUMBER (7) DEFAULT 0  NOT NULL , 
     SPEED_OF_ANSWER_PERIOD_4 NUMBER (7) DEFAULT 0  NOT NULL , 
     SPEED_OF_ANSWER_PERIOD_5 NUMBER (7) DEFAULT 0  NOT NULL , 
     SPEED_OF_ANSWER_PERIOD_6 NUMBER (7) DEFAULT 0  NOT NULL , 
     SPEED_OF_ANSWER_PERIOD_7 NUMBER (7) DEFAULT 0  NOT NULL , 
     SPEED_OF_ANSWER_PERIOD_8 NUMBER (7) DEFAULT 0  NOT NULL , 
     SPEED_OF_ANSWER_PERIOD_9 NUMBER (7) DEFAULT 0  NOT NULL , 
     SPEED_OF_ANSWER_PERIOD_10 NUMBER (7) DEFAULT 0  NOT NULL , 
     CALLS_ABANDONED_PERIOD_1 NUMBER (7) DEFAULT 0  NOT NULL , 
     CALLS_ABANDONED_PERIOD_2 NUMBER (7) DEFAULT 0  NOT NULL , 
     CALLS_ABANDONED_PERIOD_3 NUMBER (7) DEFAULT 0  NOT NULL , 
     CALLS_ABANDONED_PERIOD_4 NUMBER (7) DEFAULT 0  NOT NULL , 
     CALLS_ABANDONED_PERIOD_5 NUMBER (7) DEFAULT 0  NOT NULL , 
     CALLS_ABANDONED_PERIOD_6 NUMBER (7) DEFAULT 0  NOT NULL , 
     CALLS_ABANDONED_PERIOD_7 NUMBER (7) DEFAULT 0  NOT NULL , 
     CALLS_ABANDONED_PERIOD_8 NUMBER (7) DEFAULT 0  NOT NULL , 
     CALLS_ABANDONED_PERIOD_9 NUMBER (7) DEFAULT 0  NOT NULL , 
     CALLS_ABANDONED_PERIOD_10 NUMBER (7) DEFAULT 0  NOT NULL , 
     LABOR_MINUTES_TOTAL NUMBER (10,2) DEFAULT 0  NOT NULL , 
     LABOR_MINUTES_WAITING NUMBER (10,2) DEFAULT 0  NOT NULL , 
     HEADCOUNT_AVAILABLE NUMBER (7,2) DEFAULT 0  NOT NULL , 
     CONTACT_INVENTORY NUMBER (12,0) DEFAULT 0  NOT NULL , 
     CONTACT_INVENTORY_JEOPARDY NUMBER (12,0) DEFAULT 0  NOT NULL , 
     CONTACT_INVENTORY_AGE_TOTAL NUMBER (5,2) DEFAULT 0  NOT NULL , 
     MIN_CONTACT_INVENTORY_AGE NUMBER (5,2) DEFAULT 0  NOT NULL , 
     MAX_CONTACT_INVENTORY_AGE NUMBER (5,2) DEFAULT 0  NOT NULL , 
     MEAN_CONTACT_INVENTORY_AGE NUMBER (5,2) DEFAULT 0  NOT NULL , 
     MEDIAN_CONTACT_INVENTORY_AGE NUMBER (5,2) DEFAULT 0  NOT NULL , 
     STDDEV_CONTACT_INVENTORY_AGE NUMBER (5,2) DEFAULT 0  NOT NULL , 
     CONTACTS_TRANSFERRED NUMBER (12,0) DEFAULT 0  NOT NULL , 
     OUTFLOW_CONTACTS NUMBER (12,0) DEFAULT 0  NOT NULL , 
     ANSWER_WAIT_TIME_TOTAL NUMBER (12,2) DEFAULT 0  NOT NULL , 
     ABANDON_TIME_TOTAL NUMBER (12,2) DEFAULT 0  NOT NULL , 
     TALK_TIME_TOTAL NUMBER (12,2) DEFAULT 0  NOT NULL , 
     AFTER_CALL_WORK_TIME_TOTAL NUMBER (12,2) DEFAULT 0  NOT NULL , 
     SERVICE_LEVEL_ANSWERED_PERCENT NUMBER (5,2) DEFAULT 0  NOT NULL , 
     SERVICE_LEVEL_ANSWERED_COUNT NUMBER (12,0) DEFAULT 0  NOT NULL , 
     SERVICE_LEVEL_ABANDONED NUMBER (9,2) DEFAULT 0 , 
     CALLS_ON_HOLD NUMBER (12,0) DEFAULT , 
     HOLD_TIME_TOTAL NUMBER (12,2) DEFAULT 0  NOT NULL , 
     IVR_TIME_TOTAL NUMBER (12,2) DEFAULT 0 , 
     SHORT_ABANDONS NUMBER (12,0) , 
     CONTACTS_BLOCKED NUMBER (12,0) DEFAULT 0  NOT NULL , 
     ICR_DEFAULT_ROUTED NUMBER (12,0) DEFAULT 0  NOT NULL , 
     NETWORK_DEFAULT_ROUTED NUMBER (12,0) DEFAULT 0  NOT NULL , 
     RETURN_BUSY NUMBER (12,0) DEFAULT 0  NOT NULL , 
     CALLS_RONA NUMBER (12,0) DEFAULT 0  NOT NULL , 
     RETURN_RELEASE NUMBER (12,0) DEFAULT 0  NOT NULL , 
     CALLS_ROUTED_NON_AGENT NUMBER (12,0) DEFAULT 0  NOT NULL , 
     ERROR_COUNT NUMBER (12,0) DEFAULT 0  NOT NULL , 
     AGENT_ERROR_COUNT NUMBER (12,0) DEFAULT 0  NOT NULL , 
     RETURN_RING NUMBER (12,0) DEFAULT 0  NOT NULL , 
     INCOMPLETE_CALLS NUMBER (12,0) DEFAULT 0  NOT NULL , 
     CALLS_GIVEN_FORCE_DISCONNECT NUMBER (12,0) DEFAULT 0  NOT NULL , 
     CALLS_GIVEN_ROUTE_TO NUMBER (12,0) DEFAULT 0  NOT NULL , 
     CALL_TYPE VARCHAR2 (200) , 
     EXTRACT_DT DATE DEFAULT SYSDATE  NOT NULL , 
     LAST_UPDATE_DT DATE DEFAULT SYSDATE  NOT NULL , 
     LAST_UPDATE_BY VARCHAR2 (30)  NOT NULL ,
     MAX_ABANDON_TIME NUMBER DEFAULT 0  NOT NULL,
     ABANDON_THRESHOLD NUMBER(12,0), 
     SHORT_CALLS NUMBER(12,0),
     MAX_CALLS_QUEUED NUMBER (12,0),
     CALLS_ANSWERED NUMBER(12,0),
     HANDLE_TIME NUMBER, 
     CTVRU_TIME NUMBER, 
     SERVICE_LEVEL_CALLS NUMBER, 
     ROUTER_QUEUE_WAIT_TIME NUMBER
    ) 
        TABLESPACE MAXDAT_DATA 
        LOGGING 
;


CREATE INDEX CC_S_ACD_Q_INT_CC_S_CNTCT_Q_FK ON CC_S_ACD_QUEUE_INTERVAL 
    ( 
     CONTACT_QUEUE_ID ASC 
    ) 
    TABLESPACE MAXDAT_INDX 
    LOGGING 
;
CREATE INDEX CC_S_ACD_Q_INT_CC_S_INT_FK ON CC_S_ACD_QUEUE_INTERVAL 
    ( 
     ACD_QUEUE_INTERVAL_ID ASC 
    ) 
    TABLESPACE MAXDAT_INDX 
    LOGGING 
;



-- Fact table

CREATE TABLE CC_F_ACD_QUEUE_INTERVAL
  (
    F_CC_ACD_QUEUE_INTRVL_ID  NUMBER (19) NOT NULL ,
    D_DATE_ID                      NUMBER (19) NOT NULL ,
    D_CONTACT_QUEUE_ID             NUMBER (19) NOT NULL ,
    D_INTERVAL_ID                  NUMBER (19) NOT NULL ,
    CONTACTS_RECEIVED_FROM_IVR     NUMBER (12,0) DEFAULT 0 NOT NULL ,
    CONTACTS_OFFERED               NUMBER (12,0) DEFAULT 0 NOT NULL ,
    CONTACTS_HANDLED               NUMBER (12,0) DEFAULT 0 NOT NULL ,
    CONTACTS_ABANDONED             NUMBER (12,0) DEFAULT 0 NOT NULL ,
    MIN_HANDLE_TIME                NUMBER (11,2) DEFAULT 0 NOT NULL ,
    MAX_HANDLE_TIME                NUMBER (11,2) DEFAULT 0 NOT NULL ,
    MEAN_HANDLE_TIME               NUMBER (11,2) DEFAULT 0 NOT NULL ,
    MEDIAN_HANDLE_TIME             NUMBER (11,2) DEFAULT 0 NOT NULL ,
    STDDEV_HANDLE_TIME             NUMBER (11,2) DEFAULT 0 NOT NULL ,
    MIN_SPEED_TO_HANDLE            NUMBER (11,2) DEFAULT 0 NOT NULL ,
    MAX_SPEED_TO_HANDLE            NUMBER (11,2) DEFAULT 0 NOT NULL ,
    MEAN_SPEED_TO_HANDLE           NUMBER (11,2) DEFAULT 0 NOT NULL ,
    MEDIAN_SPEED_TO_HANDLE         NUMBER (11,2) DEFAULT 0 NOT NULL ,
    STDDEV_SPEED_TO_HANDLE         NUMBER (11,2) DEFAULT 0 NOT NULL ,
    MIN_SPEED_OF_ANSWER            NUMBER (11,2) DEFAULT 0 NOT NULL ,
    MAX_SPEED_OF_ANSWER            NUMBER (11,2) DEFAULT 0 NOT NULL ,
    MEAN_SPEED_OF_ANSWER           NUMBER (11,2) DEFAULT 0 NOT NULL ,
    MEDIAN_SPEED_OF_ANSWER         NUMBER (11,2) DEFAULT 0 NOT NULL ,
    STDDEV_SPEED_OF_ANSWER         NUMBER (11,2) DEFAULT 0 NOT NULL ,
    SPEED_OF_ANSWER_PERIOD_1       NUMBER (7) DEFAULT 0 NOT NULL ,
    SPEED_OF_ANSWER_PERIOD_2       NUMBER (7) DEFAULT 0 NOT NULL ,
    SPEED_OF_ANSWER_PERIOD_3       NUMBER (7) DEFAULT 0 NOT NULL ,
    SPEED_OF_ANSWER_PERIOD_4       NUMBER (7) DEFAULT 0 NOT NULL ,
    SPEED_OF_ANSWER_PERIOD_5       NUMBER (7) DEFAULT 0 NOT NULL ,
    SPEED_OF_ANSWER_PERIOD_6       NUMBER (7) DEFAULT 0 NOT NULL ,
    SPEED_OF_ANSWER_PERIOD_7       NUMBER (7) DEFAULT 0 NOT NULL ,
    SPEED_OF_ANSWER_PERIOD_8       NUMBER (7) DEFAULT 0 NOT NULL ,
    SPEED_OF_ANSWER_PERIOD_9       NUMBER (7) DEFAULT 0 NOT NULL ,
    SPEED_OF_ANSWER_PERIOD_10      NUMBER (7) DEFAULT 0 NOT NULL ,
    CALLS_ABANDONED_PERIOD_1       NUMBER (7) DEFAULT 0 NOT NULL ,
    CALLS_ABANDONED_PERIOD_2       NUMBER (7) DEFAULT 0 NOT NULL ,
    CALLS_ABANDONED_PERIOD_3       NUMBER (7) DEFAULT 0 NOT NULL ,
    CALLS_ABANDONED_PERIOD_4       NUMBER (7) DEFAULT 0 NOT NULL ,
    CALLS_ABANDONED_PERIOD_5       NUMBER (7) DEFAULT 0 NOT NULL ,
    CALLS_ABANDONED_PERIOD_6       NUMBER (7) DEFAULT 0 NOT NULL ,
    CALLS_ABANDONED_PERIOD_7       NUMBER (7) DEFAULT 0 NOT NULL ,
    CALLS_ABANDONED_PERIOD_8       NUMBER (7) DEFAULT 0 NOT NULL ,
    CALLS_ABANDONED_PERIOD_9       NUMBER (7) DEFAULT 0 NOT NULL ,
    CALLS_ABANDONED_PERIOD_10      NUMBER (7) DEFAULT 0 NOT NULL ,
    LABOR_MINUTES_TOTAL            NUMBER (10,2) DEFAULT 0 NOT NULL ,
    LABOR_MINUTES_AVAILABLE        NUMBER (9,2) DEFAULT 0 NOT NULL ,
    LABOR_MINUTES_WAITING          NUMBER (10,2) DEFAULT 0 NOT NULL ,
    HEADCOUNT_TOTAL                NUMBER (7,2) DEFAULT 0 NOT NULL ,
    HEADCOUNT_AVAILABLE            NUMBER (7,2) DEFAULT 0 NOT NULL ,
    HEADCOUNT_UNAVAILABLE          NUMBER (7,2) DEFAULT 0 NOT NULL ,
    CONTACT_INVENTORY              NUMBER (12,0) DEFAULT 0 NOT NULL ,
    CONTACT_INVENTORY_JEOPARDY     NUMBER (12,0) DEFAULT 0 NOT NULL ,
    MIN_CONTACT_INVENTORY_AGE      NUMBER (5,2) DEFAULT 0 NOT NULL ,
    MAX_CONTACT_INVENTORY_AGE      NUMBER (5,2) DEFAULT 0 NOT NULL ,
    MEAN_CONTACT_INVENTORY_AGE     NUMBER (5,2) DEFAULT 0 NOT NULL ,
    MEDIAN_CONTACT_INVENTORY_AGE   NUMBER (5,2) DEFAULT 0 NOT NULL ,
    STDDEV_CONTACT_INVENTORY_AGE   NUMBER (5,2) DEFAULT 0 NOT NULL ,
    CONTACTS_TRANSFERRED           NUMBER (12,0) DEFAULT 0 NOT NULL ,
    OUTFLOW_CONTACTS               NUMBER (12,0) DEFAULT 0 NOT NULL ,
    ANSWER_WAIT_TIME_TOTAL         NUMBER (12,2) DEFAULT 0 NOT NULL ,
    ABANDON_TIME_TOTAL             NUMBER (12,2) DEFAULT 0 NOT NULL ,
    TALK_TIME_TOTAL                NUMBER (12,2) DEFAULT 0 NOT NULL ,
    AFTER_CALL_WORK_TIME_TOTAL     NUMBER (12,2) DEFAULT 0 NOT NULL ,
    SERVICE_LEVEL_ANSWERED_PERCENT NUMBER (5,2) DEFAULT 0 NOT NULL ,
    SERVICE_LEVEL_ANSWERED_COUNT   NUMBER (12,0) DEFAULT 0 NOT NULL ,
    SERVICE_LEVEL_ABANDONED        NUMBER (9,2) DEFAULT 0 ,
    CALLS_ON_HOLD                  NUMBER (12,0)  ,
    HOLD_TIME_TOTAL                NUMBER (12,2) DEFAULT 0 NOT NULL ,
    SHORT_ABANDONS                 NUMBER (12,0)  ,
    SHORT_CALLS                    NUMBER (12,0)  ,
    CONTACTS_BLOCKED               NUMBER (12,0) DEFAULT 0 NOT NULL ,
    ICR_DEFAULT_ROUTED             NUMBER (12,0) DEFAULT 0 NOT NULL ,
    NETWORK_DEFAULT_ROUTED         NUMBER (12,0) DEFAULT 0 NOT NULL ,
    RETURN_BUSY                    NUMBER (12,0) DEFAULT 0 NOT NULL ,
    CALLS_RONA                     NUMBER (12,0) DEFAULT 0 NOT NULL ,
    RETURN_RELEASE                 NUMBER (12,0) DEFAULT 0 NOT NULL ,
    CALLS_ROUTED_NON_AGENT         NUMBER (12,0) DEFAULT 0 NOT NULL ,
    ERROR_COUNT                    NUMBER (12,0) DEFAULT 0 NOT NULL ,
    AGENT_ERROR_COUNT              NUMBER (12,0) DEFAULT 0 NOT NULL ,
    RETURN_RING                    NUMBER (12,0) DEFAULT 0 NOT NULL ,
    INCOMPLETE_CALLS               NUMBER (12,0) DEFAULT 0 NOT NULL ,
    CALLS_GIVEN_FORCE_DISCONNECT   NUMBER (12,0) DEFAULT 0 ,
    CALLS_GIVEN_ROUTE_TO           NUMBER (12,0) DEFAULT 0 ,
    CREATE_DATE                    DATE DEFAULT SYSDATE NOT NULL ,
    LAST_UPDATE_DATE               DATE DEFAULT SYSDATE NOT NULL,
    MAX_ABANDON_TIME               NUMBER  DEFAULT 0  NOT NULL ,
    QUEUE_NUMBER                   NUMBER (19),
    ABANDON_THRESHOLD 		   NUMBER(12,0),
    MAX_CALLS_QUEUED NUMBER (12,0),
    CALLS_ANSWERED NUMBER(12,0),
    HANDLE_TIME NUMBER, 
    CTVRU_TIME NUMBER, 
    SERVICE_LEVEL_CALLS NUMBER, 
    ROUTER_QUEUE_WAIT_TIME NUMBER, 
    RAW_CONTACTS_OFFERED NUMBER
  )
  TABLESPACE MAXDAT_DATA LOGGING ENABLE ROW MOVEMENT ;
CREATE INDEX CC_F_ACD_Q_INTERVAL_IDX2 ON CC_F_ACD_QUEUE_INTERVAL
  (
    D_DATE_ID ASC
  )
  TABLESPACE MAXDAT_INDX LOGGING ;
CREATE INDEX CC_F_ACD_Q_INTERVAL_IDX3 ON CC_F_ACD_QUEUE_INTERVAL
  (
    D_PROJECT_ID ASC
  )
  TABLESPACE MAXDAT_INDX LOGGING ;
CREATE INDEX CC_F_ACD_Q_INTERVAL_IDX4 ON CC_F_ACD_QUEUE_INTERVAL
  (
    D_PROGRAM_ID ASC
  )
  TABLESPACE MAXDAT_INDX LOGGING ;
CREATE INDEX CC_F_ACD_Q_INTERVAL_IDX5 ON CC_F_ACD_QUEUE_INTERVAL
  (
    D_GEOGRAPHY_MASTER_ID ASC
  )
  TABLESPACE MAXDAT_INDX LOGGING ;
CREATE INDEX CC_F_ACD_Q_INTERVAL_IDX6 ON CC_F_ACD_QUEUE_INTERVAL
  (
    D_UNIT_OF_WORK_ID ASC
  )
  TABLESPACE MAXDAT_INDX LOGGING ;
CREATE INDEX CC_F_ACD_Q_INTERVAL_IDX7 ON CC_F_ACD_QUEUE_INTERVAL
  (
    D_CONTACT_QUEUE_ID ASC
  )
  TABLESPACE MAXDAT_INDX LOGGING ;
CREATE INDEX CC_F_ACD_Q_INTERVAL_IDX8 ON CC_F_ACD_QUEUE_INTERVAL
  (
    D_INTERVAL_ID ASC
  )
  TABLESPACE MAXDAT_INDX LOGGING ;

ALTER TABLE CC_F_ACD_QUEUE_INTERVAL ADD CONSTRAINT CC_F_ACD_QUEUE_INTERVAL_PK PRIMARY KEY
(
  F_CC_ACD_QUEUE_INTRVL_ID
)
;
ALTER TABLE CC_F_ACD_QUEUE_INTERVAL ADD CONSTRAINT CC_F_ACD_Q_INTERVAL__UN UNIQUE
(
  D_DATE_ID , D_PROJECT_ID , D_PROGRAM_ID , D_GEOGRAPHY_MASTER_ID , D_UNIT_OF_WORK_ID , D_INTERVAL_ID , D_CONTACT_QUEUE_ID )
 
;

ALTER TABLE CC_S_ACD_QUEUE_INTERVAL 
    ADD CONSTRAINT CC_S_ACD_Q_INTERVAL_PK PRIMARY KEY ( ACD_QUEUE_INTERVAL_ID ) ;


ALTER TABLE CC_S_ACD_QUEUE_INTERVAL 
    ADD CONSTRAINT CC_S_ACD_Q_INTERVAL__UN UNIQUE ( INTERVAL_DATE , CONTACT_QUEUE_ID , INTERVAL_ID  ) ;
    
    

ALTER TABLE CC_S_ACD_QUEUE_INTERVAL 
    ADD CONSTRAINT CC_S_ACD_Q_INT_CC_S_CNTCTQ_FK FOREIGN KEY 
    ( 
     CONTACT_QUEUE_ID
    ) 
    REFERENCES CC_S_CONTACT_QUEUE 
    ( 
     CONTACT_QUEUE_ID
    ) 
    NOT DEFERRABLE 
;


ALTER TABLE CC_S_ACD_QUEUE_INTERVAL 
    ADD CONSTRAINT CC_S_ACD_Q_INT_CC_S_INT_FK FOREIGN KEY 
    ( 
     INTERVAL_ID
    ) 
    REFERENCES CC_S_INTERVAL 
    ( 
     INTERVAL_ID
    ) 
    NOT DEFERRABLE 
;


ALTER TABLE CC_F_ACD_QUEUE_INTERVAL ADD CONSTRAINT F_ACD_Q_INTRVL_D_CNTCT_Q_FK FOREIGN KEY ( D_CONTACT_QUEUE_ID ) REFERENCES CC_D_CONTACT_QUEUE ( D_CONTACT_QUEUE_ID ) NOT DEFERRABLE ;

ALTER TABLE CC_F_ACD_QUEUE_INTERVAL ADD CONSTRAINT F_ACD_Q_INTRVL_D_DATES_FK FOREIGN KEY ( D_DATE_ID ) REFERENCES CC_D_DATES ( D_DATE_ID ) NOT DEFERRABLE ;

ALTER TABLE CC_F_ACD_QUEUE_INTERVAL ADD CONSTRAINT F_ACD_Q_INTRVL_D_GEO_FK FOREIGN KEY ( D_GEOGRAPHY_MASTER_ID ) REFERENCES CC_D_GEOGRAPHY_MASTER ( GEOGRAPHY_MASTER_ID ) NOT DEFERRABLE ;

ALTER TABLE CC_F_ACD_QUEUE_INTERVAL ADD CONSTRAINT F_ACD_Q_INTRVL_D_INT_FK FOREIGN KEY ( D_INTERVAL_ID ) REFERENCES CC_D_INTERVAL ( D_INTERVAL_ID ) NOT DEFERRABLE ;

ALTER TABLE CC_F_ACD_QUEUE_INTERVAL ADD CONSTRAINT F_ACD_Q_INTRVL_D_PRG_FK FOREIGN KEY ( D_PROGRAM_ID ) REFERENCES CC_D_PROGRAM ( PROGRAM_ID ) NOT DEFERRABLE ;

ALTER TABLE CC_F_ACD_QUEUE_INTERVAL ADD CONSTRAINT F_ACD_Q_INTRVL_D_PRJ_FK FOREIGN KEY ( D_PROJECT_ID ) REFERENCES CC_D_PROJECT ( PROJECT_ID ) NOT DEFERRABLE ;

ALTER TABLE CC_F_ACD_QUEUE_INTERVAL ADD CONSTRAINT F_ACD_Q_INTRVL_D_UOW_FK FOREIGN KEY ( D_UNIT_OF_WORK_ID ) REFERENCES CC_D_UNIT_OF_WORK ( UOW_ID ) NOT DEFERRABLE ;

CREATE SEQUENCE SEQ_CC_S_ACD_Q_INTERVAL 
    START WITH 1 
    INCREMENT BY 1 
    MAXVALUE 9999999999999999999 
    MINVALUE 1 
    CACHE 20 
;

CREATE SEQUENCE SEQ_CC_F_ACD_Q_INTERVAL START WITH 1 INCREMENT BY 1 MAXVALUE 9999999999999999999 MINVALUE 1 CACHE 20 ;

CREATE OR REPLACE TRIGGER BIU_CC_S_ACD_Q_INTERVAL 
    BEFORE INSERT OR UPDATE ON CC_S_ACD_QUEUE_INTERVAL 
    FOR EACH ROW 
BEGIN 
IF INSERTING AND :NEW.ACD_QUEUE_INTERVAL_ID IS NULL THEN 
          SELECT SEQ_CC_S_ACD_Q_INTERVAL.NEXTVAL INTO :NEW.ACD_QUEUE_INTERVAL_ID FROM DUAL;
END IF;
IF INSERTING THEN 
          :NEW.EXTRACT_DT := SYSDATE;
END IF;
IF :NEW.LAST_UPDATE_BY IS NULL THEN 
          :NEW.LAST_UPDATE_BY := USER;
END IF;
:NEW.LAST_UPDATE_DT := SYSDATE;
END; 
/    

CREATE OR REPLACE VIEW CC_F_ACD_QUEUE_INTERVAL_SV  AS
SELECT CC_F_ACD_QUEUE_INTERVAL.* FROM CC_F_ACD_QUEUE_INTERVAL ;

CREATE OR REPLACE TRIGGER BI_CC_F_ACD_Q_INTERVAL 
    BEFORE INSERT ON CC_F_ACD_QUEUE_INTERVAL 
    FOR EACH ROW 
    ENABLE 
BEGIN
IF INSERTING AND :NEW.F_CC_ACD_QUEUE_INTRVL_ID IS NULL THEN 
          SELECT SEQ_CC_F_ACD_Q_INTERVAL.NEXTVAL INTO :NEW.F_CC_ACD_QUEUE_INTRVL_ID FROM DUAL;      
END IF;
END;  
/