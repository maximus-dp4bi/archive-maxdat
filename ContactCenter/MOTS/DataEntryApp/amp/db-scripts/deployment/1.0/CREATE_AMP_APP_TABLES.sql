
--SEQUENCES

CREATE SEQUENCE SEQ_AMP_ROLE START WITH 1 INCREMENT BY 1 MAXVALUE 9999999999999999999 MINVALUE 1 CACHE 20 ;

CREATE SEQUENCE SEQ_AMP_USER START WITH 1 INCREMENT BY 1 MAXVALUE 9999999999999999999 MINVALUE 1 CACHE 20 ;

CREATE SEQUENCE SEQ_D_METRIC_VALIDATION_RULE START WITH 1 INCREMENT BY 1 MAXVALUE 9999999999999999999 MINVALUE 1 CACHE 20 ;

CREATE SEQUENCE SEQ_D_COMPARISON_METRIC START WITH 1 INCREMENT BY 1 MAXVALUE 9999999999999999999 MINVALUE 1 CACHE 20 ;


--TABLES 

CREATE TABLE AMP_ROLE
  (
    ID          NUMBER (19) NOT NULL ,
    DESCRIPTION VARCHAR2 (250) ,
    NAME        VARCHAR2 (50) ,
    TYPE        VARCHAR2 (50)
  )
  LOGGING ;
ALTER TABLE AMP_ROLE ADD CONSTRAINT ROLE_PK PRIMARY KEY ( ID ) ;

CREATE TABLE AMP_USER
  (
    ID                  NUMBER (19) NOT NULL ,
    ACCOUNT_EXPIRED     NUMBER (1) NOT NULL ,
    ACCOUNT_LOCKED      NUMBER (1) NOT NULL ,
    ADDRESS             VARCHAR2 (150 CHAR) ,
    CITY                VARCHAR2 (50 CHAR) ,
    COUNTRY             VARCHAR2 (100 CHAR) ,
    POSTAL_CODE         VARCHAR2 (15 CHAR) ,
    PROVINCE            VARCHAR2 (100 CHAR) ,
    CREDENTIALS_EXPIRED NUMBER (1) NOT NULL ,
    EMAIL               VARCHAR2 (255 CHAR) ,
    ACCOUNT_ENABLED     NUMBER (1) ,
    FIRST_NAME          VARCHAR2 (50 CHAR) ,
    LAST_NAME           VARCHAR2 (50 CHAR) ,
    PASSWORD            VARCHAR2 (255 CHAR) ,
    PASSWORD_HINT       VARCHAR2 (255 CHAR) ,
    PHONE_NUMBER        VARCHAR2 (255 CHAR) ,
    USERNAME            VARCHAR2 (50 CHAR) NOT NULL ,
    VERSION             NUMBER (10) ,
    WEBSITE             VARCHAR2 (255 CHAR)
  )
  LOGGING ;
ALTER TABLE AMP_USER ADD CONSTRAINT APP_USER_PK PRIMARY KEY ( ID ) ;
ALTER TABLE AMP_USER ADD CONSTRAINT AMP_USER__UN2 UNIQUE ( USERNAME ) ;

CREATE TABLE AMP_USER_AMP_ROLE
  (
    USER_ID NUMBER (19) NOT NULL ,
    ROLE_ID NUMBER (19) NOT NULL
  )
  LOGGING ;
ALTER TABLE AMP_USER_AMP_ROLE ADD CONSTRAINT USER_ROLE_PK PRIMARY KEY ( USER_ID, ROLE_ID ) ;

CREATE TABLE D_PROJECT_USER
  (
    D_PROJECT_USER_ID  NUMBER (19) NOT NULL ,
    D_PROJECT_ID       NUMBER (19) NOT NULL ,
    APP_USER_ID        NUMBER (19) NOT NULL ,
    D_PROJECT_ROLE_ID  NUMBER (19) NOT NULL ,
    FUNCTIONAL_AREA    VARCHAR2 (50) NOT NULL ,
    IS_ACTIVE_FLAG     VARCHAR2 (1) NOT NULL ,
    CREATE_DATE        DATE ,
    CREATED_BY         VARCHAR2 (50) ,
    LAST_MODIFIED_DATE DATE ,
    UPDATED_BY         VARCHAR2 (50)
  )
  LOGGING ;
ALTER TABLE D_PROJECT_USER ADD CONSTRAINT D_PROJECT_USER_PK PRIMARY KEY ( D_PROJECT_USER_ID ) ;


CREATE TABLE D_PROJECT_GEOGRAPHY_MASTER
  (
    D_PROJECT_ID          NUMBER (19) NOT NULL ,
    D_GEOGRAPHY_MASTER_ID NUMBER (19) NOT NULL
  )
  LOGGING ;

CREATE TABLE D_PROJECT_PROGRAM
  (
    D_PROJECT_ID NUMBER (19) NOT NULL ,
    D_PROGRAM_ID NUMBER (19) NOT NULL
  )
  LOGGING ;


CREATE TABLE D_COMPARISON_METRIC
  (
    D_COMPARISON_METRIC_ID      NUMBER (19) NOT NULL ,
    D_METRIC_VALIDATION_RULE_ID NUMBER (19) NOT NULL ,
    D_COMPARISON_METRIC_DEF_ID  NUMBER (19) NOT NULL ,
    COMPARISON_METRIC_LOC       VARCHAR2 (250) NOT NULL ,
    ALIAS                       VARCHAR2 (50) NOT NULL
  )
  LOGGING ;
ALTER TABLE D_COMPARISON_METRIC ADD CONSTRAINT D_COMPARISON_METRIC_PK PRIMARY KEY ( D_COMPARISON_METRIC_ID ) ;
ALTER TABLE D_COMPARISON_METRIC ADD CONSTRAINT D_COMPARISON_METRIC__UN UNIQUE ( D_METRIC_VALIDATION_RULE_ID , ALIAS ) ;

CREATE TABLE D_METRIC_VALIDATION_RULE
  (
    D_METRIC_VALIDATION_RULE_ID NUMBER (19) NOT NULL ,
    D_METRIC_DEFINITION_ID      NUMBER (19) NOT NULL ,
    RULE_NAME                   VARCHAR2 (250) NOT NULL ,
    RULE_DESCRIPTION            VARCHAR2 (4000) NOT NULL ,
    RULE_MESSAGE                VARCHAR2 (250) NOT NULL ,
    RULE_VALIDATION_TYPE        VARCHAR2 (250) NOT NULL ,
    RULE_SEVERITY_INDICATOR     VARCHAR2 (250) NOT NULL ,
    METRIC_VALUE_TYPE           VARCHAR2 (250) NOT NULL ,
    METRIC_VALUE_LOCATION       VARCHAR2 (250) NOT NULL ,
    PREVENT_SUBMIT              NUMBER (1) NOT NULL ,
    ALLOW_IGNORE_WITH_COMMENT   NUMBER (1) NOT NULL ,
    IS_EXPRESSION_RULE          NUMBER (1) NOT NULL ,
    RULE_EXPRESSION             VARCHAR2 (4000) NOT NULL ,
    CREATE_DATE                 DATE ,
    CREATED_BY                  VARCHAR2 (50) ,
    LAST_MODIFIED_DATE          DATE ,
    UPDATED_BY                  VARCHAR2 (50)
  )
  LOGGING ;

CREATE INDEX D_METRIC_VALIDATION_RULE__IDX ON D_METRIC_VALIDATION_RULE
  (
    D_METRIC_DEFINITION_ID ASC
  )
  LOGGING ;
ALTER TABLE D_METRIC_VALIDATION_RULE ADD CONSTRAINT D_METRIC_VALIDATION_RULE_PK PRIMARY KEY ( D_METRIC_VALIDATION_RULE_ID ) ;
ALTER TABLE D_METRIC_VALIDATION_RULE ADD CONSTRAINT D_METRIC_VALIDATION_RULE__UN UNIQUE ( D_METRIC_DEFINITION_ID , RULE_NAME ) ;

CREATE TABLE D_METRIC_TYPE
  (
    D_METRIC_TYPE_ID    NUMBER (19) NOT NULL ,
    METRIC_TYPE_NAME    VARCHAR2 (50) NOT NULL ,
    METRIC_CATEGORY     VARCHAR2 (50) NOT NULL ,
    METRIC_SUB_CATEGORY VARCHAR2 (50) ,
    SORT_ORDER          NUMBER (4)
  )
  LOGGING ;
ALTER TABLE D_METRIC_TYPE ADD CONSTRAINT D_METRIC_TYPE_PK PRIMARY KEY ( D_METRIC_TYPE_ID ) ;


-- FOREIGN KEYS

ALTER TABLE D_PROJECT_USER ADD CONSTRAINT D_PROJECT_USER_AMP_ROLE_FK FOREIGN KEY ( D_PROJECT_ROLE_ID ) REFERENCES AMP_ROLE ( ID ) NOT DEFERRABLE ;

ALTER TABLE D_PROJECT_USER ADD CONSTRAINT D_PROJECT_USER_APP_USER_FK FOREIGN KEY ( APP_USER_ID ) REFERENCES AMP_USER ( ID ) NOT DEFERRABLE ;

ALTER TABLE D_PROJECT_USER ADD CONSTRAINT D_PROJECT_USER_D_PROJECT_FK FOREIGN KEY ( D_PROJECT_ID ) REFERENCES D_PROJECT ( D_PROJECT_ID ) NOT DEFERRABLE ;

ALTER TABLE AMP_USER_AMP_ROLE ADD CONSTRAINT USER_ROLE_APP_USER_FK FOREIGN KEY ( USER_ID ) REFERENCES AMP_USER ( ID ) NOT DEFERRABLE ;

ALTER TABLE AMP_USER_AMP_ROLE ADD CONSTRAINT USER_ROLE_ROLE_FK FOREIGN KEY ( ROLE_ID ) REFERENCES AMP_ROLE ( ID ) NOT DEFERRABLE ;

ALTER TABLE D_PROJECT_GEOGRAPHY_MASTER ADD CONSTRAINT D_PRJ_GEO_D_GEO_FK FOREIGN KEY ( D_GEOGRAPHY_MASTER_ID ) REFERENCES D_GEOGRAPHY_MASTER ( D_GEOGRAPHY_MASTER_ID ) NOT DEFERRABLE ;

ALTER TABLE D_PROJECT_GEOGRAPHY_MASTER ADD CONSTRAINT D_PRJ_GEO_D_PRJ_FK FOREIGN KEY ( D_PROJECT_ID ) REFERENCES D_PROJECT ( D_PROJECT_ID ) NOT DEFERRABLE ;

ALTER TABLE D_PROJECT_PROGRAM ADD CONSTRAINT D_PRJ_PRG_D_PRG_FK FOREIGN KEY ( D_PROGRAM_ID ) REFERENCES D_PROGRAM ( D_PROGRAM_ID ) NOT DEFERRABLE ;

ALTER TABLE D_PROJECT_PROGRAM ADD CONSTRAINT D_PRJ_PRG_D_PRJ_FK FOREIGN KEY ( D_PROJECT_ID ) REFERENCES D_PROJECT ( D_PROJECT_ID ) NOT DEFERRABLE ;

ALTER TABLE D_COMPARISON_METRIC ADD CONSTRAINT D_CMP_MTRC_MTRC_DEF_FK FOREIGN KEY ( D_COMPARISON_METRIC_DEF_ID ) REFERENCES D_METRIC_DEFINITION ( D_METRIC_DEFINITION_ID ) NOT DEFERRABLE ;

ALTER TABLE D_COMPARISON_METRIC ADD CONSTRAINT D_CMP_MTRC_MTRC_VLDTN_RL_FK FOREIGN KEY ( D_METRIC_VALIDATION_RULE_ID ) REFERENCES D_METRIC_VALIDATION_RULE ( D_METRIC_VALIDATION_RULE_ID ) NOT DEFERRABLE ;

ALTER TABLE D_METRIC_VALIDATION_RULE ADD CONSTRAINT D_VLDTN_RLE_COMP_MTRC_DEF_FK FOREIGN KEY ( D_METRIC_DEFINITION_ID ) REFERENCES D_METRIC_DEFINITION ( D_METRIC_DEFINITION_ID ) NOT DEFERRABLE ;

