
CREATE TABLE D_CONTROL_CHART_PARAMETERS
(D_CONTROL_CHART_ID NUMBER NOT NULL
 ,D_METRIC_PROJECT_ID NUMBER NOT NULL
 ,REPORT_TYPE VARCHAR2(10)
 ,MU NUMBER(19,6)
 ,SIGMA NUMBER(19,6)
 ,UCL_OF_SIGMA NUMBER(19,6)
 ,LCL_OF_SIGMA NUMBER(19,6)
 ,UPPER_CONTROL_LIMIT NUMBER(19,6)
 ,LOWER_CONTROL_LIMIT NUMBER(19,6)
 ,CENTER_LINE NUMBER(19,6)
 ,UPPER_SPECIFICATION_LIMIT NUMBER(19,6)
 ,LOWER_SPECIFICATION_LIMIT NUMBER(19,6)
 ,UPPER_WARNING_LIMIT NUMBER(19,6)
 ,LOWER_WARNING_LIMIT NUMBER(19,6)
 ,CP NUMBER(19,6)
 ,CPK NUMBER(19,6)
 ,NUMBER_OF_OBSERVATIONS NUMBER
 ,PARAMETER_EFF_DT DATE
 ,PARAMETER_END_DT DATE
 ,CREATE_DATE DATE
 ,LAST_MODIFIED_DATE DATE
 ,CREATED_BY VARCHAR2(50)
 ,UPDATED_BY VARCHAR2(50));
 
CREATE UNIQUE INDEX D_CONTROL_CHART_PARAMETERS_UK ON D_CONTROL_CHART_PARAMETERS 
    (  D_CONTROL_CHART_ID  )  LOGGING ;
 
 ALTER TABLE D_CONTROL_CHART_PARAMETERS 
    ADD CONSTRAINT D_CONTROL_CHART_PARAMETERS_PK PRIMARY KEY ( D_CONTROL_CHART_ID ) ;

ALTER TABLE D_CONTROL_CHART_PARAMETERS 
    ADD CONSTRAINT D_CCP_METRIC_PROJ_FK FOREIGN KEY 
    ( D_METRIC_PROJECT_ID ) REFERENCES D_METRIC_PROJECT (D_METRIC_PROJECT_ID) NOT DEFERRABLE ;

CREATE SEQUENCE SEQ_D_CONTROL_CHART 
    START WITH 1 
    INCREMENT BY 1 
    MAXVALUE 9999999999999999999 
    MINVALUE 1 
    CACHE 20 ;

CREATE OR REPLACE TRIGGER BIU_D_CONTROL_CHART_PARAMETERS 
    BEFORE INSERT OR UPDATE ON D_CONTROL_CHART_PARAMETERS 
    FOR EACH ROW 
BEGIN
IF INSERTING AND :NEW.D_CONTROL_CHART_ID IS NULL THEN 
  SELECT SEQ_D_CONTROL_CHART.NEXTVAL INTO :NEW.D_CONTROL_CHART_ID FROM DUAL;    
	:NEW.CREATE_DATE := SYSDATE;  
	:NEW.CREATED_BY := USER;
END IF;
:NEW.UPDATED_BY := USER;
:NEW.LAST_MODIFIED_DATE := SYSDATE;
END;
/ 

INSERT INTO CC_L_PATCH_LOG ( PATCH_VERSION , SCRIPT_SEQUENCE , SCRIPT_NAME) 
	VALUES ('2.9','002','002_ADD_D_CONTROL_CHART_PARAMETERS');
 
COMMIT;