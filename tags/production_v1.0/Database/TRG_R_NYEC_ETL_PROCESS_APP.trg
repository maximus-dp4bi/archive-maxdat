CREATE OR REPLACE TRIGGER MAXDAT."TRG_R_NYEC_ETL_PROCESS_APP" BEFORE
  INSERT OR
  UPDATE ON NYEC_ETL_PROCESS_APP FOR EACH ROW
BEGIN
  IF Inserting THEN
    IF :new.cepa_Id IS NULL THEN
      SELECT Seq_cepa_Id.Nextval INTO :NEW.cepa_Id FROM Dual;
    END IF;
    IF :NEW.STG_EXTRACT_DATE IS NULL THEN
      :NEW.STG_EXTRACT_DATE  := SYSDATE;
    END IF;
  END IF;
  :NEW.STG_LAST_UPDATE_DATE := SYSDATE;
  
END;
/
