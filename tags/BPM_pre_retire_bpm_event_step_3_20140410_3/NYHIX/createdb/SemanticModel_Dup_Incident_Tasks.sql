-- NYHIX-2739 Manage Work Duplicate Incident Tasks

create or replace view D_MW_INCIDENT_CURRENT_SV as
select MW."Source Reference ID" as "Incident ID"
     , IDR.TRACKING_NUMBER as "Incident Tracking Number"
     , MW."MW_BI_ID"
     , MW."Task ID"
     , MW."Age in Business Days"
     , MW."Age in Calendar Days"
     , MW."Create Date"
     , MW."Complete Date"
     , MW."Jeopardy Flag"
     , MW."SLA Days"
     , MW."SLA Days Type"
     , MW."SLA Jeopardy Days"
     , MW."SLA Target Days"
     , MW."Timeliness Status"
     , MW."Cancel Work Date"
     , MW."Cancel Work Flag"
     , MW."Complete Flag"
     , MW."Created By Name"
     , MW."Status Age in Business Days"
     , MW."Status Age in Calendar Days"
     , MW."Unit of Work"
     , MW."Current Escalated Flag"
     , MW."Current Escalated To Name"
     , MW."Current Forwarded By Name"
     , MW."Current Forwarded Flag"
     , MW."Current Group Name"
     , MW."Current Group Parent Name"
     , MW."Current Group Supervisor Name"
     , MW."Current Last Update By Name"
     , MW."Current Owner Name"
     , MW."Current Task Status"
     , MW."Current Task Type"
     , MW."Current Team Name"
     , MW."Current Team Parent Name"
     , MW."Current Team Supervisor Name"
     , MW."CLIENT_ID",MW."CASE_ID"
     , MW."Current Last Update Date"
     , MW."Current Status Date"
     , MW."Cancel By"
     , MW."Cancel Reason"
     , MW."Cancel Method"
     , MW."TASK_PRIORITY"
  from D_MW_CURRENT MW, D_IDR_CURRENT IDR
 where "Source Reference Type" = 'Incident ID' 
   and "Source Reference ID" = IDR.INCIDENT_ID
union all
select MW."Source Reference ID" as "Incident ID"
     , APP.INCIDENT_TRACKING_NUMBER as "Incident Tracking Number"
     , MW."MW_BI_ID"
     , MW."Task ID"
     , MW."Age in Business Days"
     , MW."Age in Calendar Days"
     , MW."Create Date"
     , MW."Complete Date"
     , MW."Jeopardy Flag"
     , MW."SLA Days"
     , MW."SLA Days Type"
     , MW."SLA Jeopardy Days"
     , MW."SLA Target Days"
     , MW."Timeliness Status"
     , MW."Cancel Work Date"
     , MW."Cancel Work Flag"
     , MW."Complete Flag"
     , MW."Created By Name"
     , MW."Status Age in Business Days"
     , MW."Status Age in Calendar Days"
     , MW."Unit of Work"
     , MW."Current Escalated Flag"
     , MW."Current Escalated To Name"
     , MW."Current Forwarded By Name"
     , MW."Current Forwarded Flag"
     , MW."Current Group Name"
     , MW."Current Group Parent Name"
     , MW."Current Group Supervisor Name"
     , MW."Current Last Update By Name"
     , MW."Current Owner Name"
     , MW."Current Task Status"
     , MW."Current Task Type"
     , MW."Current Team Name"
     , MW."Current Team Parent Name"
     , MW."Current Team Supervisor Name"
     , MW."CLIENT_ID",MW."CASE_ID"
     , MW."Current Last Update Date"
     , MW."Current Status Date"
     , MW."Cancel By"
     , MW."Cancel Reason"
     , MW."Cancel Method"
     , MW."TASK_PRIORITY"
  from D_MW_CURRENT MW, D_APPEALS_CURRENT APP
 where "Source Reference Type" = 'Incident ID' 
   and "Source Reference ID" = APP.INCIDENT_ID
union all
select MW."Source Reference ID" as "Incident ID"
     , CMP.INCIDENT_TRACKING_NUMBER as "Incident Tracking Number"
     , MW."MW_BI_ID"
     , MW."Task ID"
     , MW."Age in Business Days"
     , MW."Age in Calendar Days"
     , MW."Create Date"
     , MW."Complete Date"
     , MW."Jeopardy Flag"
     , MW."SLA Days"
     , MW."SLA Days Type"
     , MW."SLA Jeopardy Days"
     , MW."SLA Target Days"
     , MW."Timeliness Status"
     , MW."Cancel Work Date"
     , MW."Cancel Work Flag"
     , MW."Complete Flag"
     , MW."Created By Name"
     , MW."Status Age in Business Days"
     , MW."Status Age in Calendar Days"
     , MW."Unit of Work"
     , MW."Current Escalated Flag"
     , MW."Current Escalated To Name"
     , MW."Current Forwarded By Name"
     , MW."Current Forwarded Flag"
     , MW."Current Group Name"
     , MW."Current Group Parent Name"
     , MW."Current Group Supervisor Name"
     , MW."Current Last Update By Name"
     , MW."Current Owner Name"
     , MW."Current Task Status"
     , MW."Current Task Type"
     , MW."Current Team Name"
     , MW."Current Team Parent Name"
     , MW."Current Team Supervisor Name"
     , MW."CLIENT_ID",MW."CASE_ID"
     , MW."Current Last Update Date"
     , MW."Current Status Date"
     , MW."Cancel By"
     , MW."Cancel Reason"
     , MW."Cancel Method"
     , MW."TASK_PRIORITY"
  from D_MW_CURRENT MW, D_COMPLAINT_CURRENT CMP
 where "Source Reference Type" = 'Incident ID' 
   and "Source Reference ID" = CMP.INCIDENT_ID;

create or replace public synonym D_MW_INCIDENT_CURRENT_SV for D_MW_INCIDENT_CURRENT_SV;
grant select on D_MW_INCIDENT_CURRENT_SV to MAXDAT_READ_ONLY;


