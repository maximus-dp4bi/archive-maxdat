CREATE SEQUENCE SEQ_CEMW_ID
 NOMAXVALUE
 NOMINVALUE
 NOCYCLE
/


CREATE OR REPLACE TRIGGER "MAXDAT"."TRG_R_CORP_ETL_MANAGE_WORK" BEFORE
  INSERT OR
  UPDATE ON corp_etl_manage_work FOR EACH ROW 
BEGIN 
  IF Inserting THEN 
    IF :new.cemw_Id IS NULL THEN
      SELECT Seq_cemw_Id.Nextval INTO :NEW.cemw_Id FROM Dual;
    END IF;
    IF :NEW.STG_EXTRACT_DATE IS NULL THEN
      :NEW.STG_EXTRACT_DATE  := SYSDATE;
    END IF;
  END IF;
  :NEW.STG_LAST_UPDATE_DATE := SYSDATE;
END;
/
ALTER TRIGGER "MAXDAT"."TRG_R_CORP_ETL_MANAGE_WORK" ENABLE;
