
-- INSERT 2021 HOLIDAYS INTO THE TABLE 
INSERT INTO PUBLIC.HOLIDAYS(HOLIDAY_YEAR,HOLIDAY_DATE,DESCRIPTION,CREATED_BY,CREATE_TS,UPDATED_BY,UPDATE_TS)
VALUES('2021','01/01/2021','New Year’s Day','SS153729',CURRENT_TIMESTAMP(),'SS153729',CURRENT_TIMESTAMP());
INSERT INTO PUBLIC.HOLIDAYS(HOLIDAY_YEAR,HOLIDAY_DATE,DESCRIPTION,CREATED_BY,CREATE_TS,UPDATED_BY,UPDATE_TS)
VALUES ('2021','01/18/2021','Martin Luther King Day','SS153729',CURRENT_TIMESTAMP(),'SS153729',CURRENT_TIMESTAMP());
INSERT INTO PUBLIC.HOLIDAYS(HOLIDAY_YEAR,HOLIDAY_DATE,DESCRIPTION,CREATED_BY,CREATE_TS,UPDATED_BY,UPDATE_TS)
VALUES ('2021','02/15/2021','Presidents Day','SS153729',CURRENT_TIMESTAMP(),'SS153729',CURRENT_TIMESTAMP());
INSERT INTO PUBLIC.HOLIDAYS(HOLIDAY_YEAR,HOLIDAY_DATE,DESCRIPTION,CREATED_BY,CREATE_TS,UPDATED_BY,UPDATE_TS)
VALUES ('2021','05/31/2021','Memorial Day','SS153729',CURRENT_TIMESTAMP(),'SS153729',CURRENT_TIMESTAMP());
INSERT INTO PUBLIC.HOLIDAYS(HOLIDAY_YEAR,HOLIDAY_DATE,DESCRIPTION,CREATED_BY,CREATE_TS,UPDATED_BY,UPDATE_TS)
VALUES ('2021','07/05/2021','Independence Day','SS153729',CURRENT_TIMESTAMP(),'SS153729',CURRENT_TIMESTAMP());
INSERT INTO PUBLIC.HOLIDAYS(HOLIDAY_YEAR,HOLIDAY_DATE,DESCRIPTION,CREATED_BY,CREATE_TS,UPDATED_BY,UPDATE_TS)
VALUES ('2021','09/06/2021','Labor Day','SS153729',CURRENT_TIMESTAMP(),'SS153729',CURRENT_TIMESTAMP());
INSERT INTO PUBLIC.HOLIDAYS(HOLIDAY_YEAR,HOLIDAY_DATE,DESCRIPTION,CREATED_BY,CREATE_TS,UPDATED_BY,UPDATE_TS)
VALUES ('2021','10/11/2021','Columbus Day','SS153729',CURRENT_TIMESTAMP(),'SS153729',CURRENT_TIMESTAMP());
INSERT INTO PUBLIC.HOLIDAYS(HOLIDAY_YEAR,HOLIDAY_DATE,DESCRIPTION,CREATED_BY,CREATE_TS,UPDATED_BY,UPDATE_TS)
VALUES ('2021','11/11/2021','Veterans Day','SS153729',CURRENT_TIMESTAMP(),'SS153729',CURRENT_TIMESTAMP());
INSERT INTO PUBLIC.HOLIDAYS(HOLIDAY_YEAR,HOLIDAY_DATE,DESCRIPTION,CREATED_BY,CREATE_TS,UPDATED_BY,UPDATE_TS)
VALUES ('2021','11/25/2021','Thanksgiving Day','SS153729',CURRENT_TIMESTAMP(),'SS153729',CURRENT_TIMESTAMP());
INSERT INTO PUBLIC.HOLIDAYS(HOLIDAY_YEAR,HOLIDAY_DATE,DESCRIPTION,CREATED_BY,CREATE_TS,UPDATED_BY,UPDATE_TS)
VALUES ('2021','12/24/2021','Christmas','SS153729',CURRENT_TIMESTAMP(),'SS153729',CURRENT_TIMESTAMP());

-- SELECT * FROM PUBLIC.HOLIDAYS;

--UPDATE D_Dates table after inserting holidays
UPDATE PUBLIC.d_dates dd
SET business_day_flag = 'N'
WHERE EXISTS(SELECT 1 FROM PUBLIC.holidays h WHERE dd.d_date = h.holiday_date);

