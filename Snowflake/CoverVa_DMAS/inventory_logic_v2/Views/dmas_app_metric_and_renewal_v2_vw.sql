CREATE OR REPLACE VIEW coverva_dmas.dmas_app_metric_and_renewal_v2_vw
AS
SELECT appmetric_data_id,
       null renewal_data_id,
       Tracking_Number,
       Case_Number,
       Application_Type,
       App_Received_Date,
       FFM_Transfer_Date,
       FFM_Application_Type,
       Application_Status,
       Application_Source,
       Worker_ID,
       Stage,
       Range,
       Pending_due_to_VCL,
       VCL_Due_Date,
       Applicant_Last_Name,
       Applicant_First_Name,
       Application_ABD_Indicator,
       Case_ABD_Indicator,
       Application_LTC_Indicator,
       Case_LTC_Indicator,
       Application_Incarcerated_Indicator,
       Case_Incarcerated_Indicator,
       MA_PG_Indicator,
       Processing_Unit,       
       Filename
FROM coverva_dmas.app_metric_v2_full_load
UNION ALL
SELECT null appmetric_data_id,
       renewal_data_id,
       Tracking_Number,
       Case_Number,
       'Renewal' Application_Type,
       received_date App_Received_Date,
       null FFM_Transfer_Date,
       null FFM_Application_Type,
       processing_status Application_Status,
       Application_Source,
       Worker_ID,
       null Stage,
       null Range,
       null Pending_due_to_VCL,
       null VCL_Due_Date,
       SUBSTR(case_name,1,REGEXP_INSTR(case_name,',')-1) Applicant_Last_Name,
       SUBSTR(case_name,REGEXP_INSTR(case_name,',')+1) Applicant_First_Name,
       null Application_ABD_Indicator,
       potential_disability Case_ABD_Indicator,
       null Application_LTC_Indicator,
       null Case_LTC_Indicator,
       null Application_Incarcerated_Indicator,
       incarcerated Case_Incarcerated_Indicator,
       potential_pregnancy MA_PG_Indicator,
       Processing_Unit,       
       Filename
FROM coverva_dmas.renewal_data_full_load
;                              
                              
                              