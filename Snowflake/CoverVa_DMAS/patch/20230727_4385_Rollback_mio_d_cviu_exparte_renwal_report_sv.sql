create or replace view MARS_DP4BI_PROD.PUBLIC.MIO_D_QA_ADHOC_REPORTING_TOOL_SV(
	MONTH_NAME,
	MONTH_ID,
	INF_ID,
	INF_DMAS_IC_SUBMISSION,
	INF_CASE_IDENTIFIER,
	INF_ALTERNATIVE_CASE_NUMBER,
	INF_CASE_TYPE,
	INF_EW_CASE_UNIT,
	INF_EW_CASE_TYPE,
	INF_EW_CASE_SPECIALTY,
	INF_EW_CASE_DISPOSITION,
	INF_EW_CASE_DECISION_REASON,
	INF_EW_CASE_DISPOSITION_DATE_EST,
	INF_ELIGIBILITY_WORKER_EMP_ID,
	INF_ELIGIBILIITY_WORKER_NAME,
	INF_EW_SUPERVISOR,
	INF_EW_CASE_APPLICATION_SOURCE,
	INF_EW_TRAINING_STATUS,
	INF_ASSIGNED,
	INF_ASSIGNED_TO,
	INF_ASSIGNED_TO_NAME,
	INF_QA_STATUS,
	INF_QA_STATUS_DATE_EST,
	INF_QA_COMPLETE,
	INF_LAST_ASSIGNED_EST,
	INF_ASSIGNMENT_SOURCE,
	INF_ADDL_INFO,
	INF_PENDING_STATUS_REASONING,
	INF_OTHER_STATUS_REASONING,
	INF_CARDTYPE,
	INF_APP_SOURCE,
	INF_APP_TYPE,
	INF_SCORECARD_TYPE,
	INF_DECISION_REASON,
	INF_DECISION_DATE,
	INF_PW_APP,
	INF_QA_PERCENTAGE,
	INF_IMMEDIATE_COACHING,
	INF_SBT_BTN,
	INF_CREATED,
	INF_MODIFIED_BY,
	INF_UPDATED,
	INF_TABLE_NAME,
	INF_LOG_CREATED_ON,
	SCORE_ID,
	SCORE_DMAS_IC_SUBMISSION,
	SCORE_QA_INFO_ID,
	SCORE_QUESTION_IDENTIFIER,
	SCORE_QUESTION,
	SCORE_ANSWER,
	SCORE_POSSIBLE_POINTS,
	SCORE_MISSED_POINTS,
	SCORE_RESPONSIBLE_INDIVIDUAL_EMPID,
	SCORE_RESPONSIBLE_INDIVIDUAL_NAME,
	SCORE_RESPONSIBLE_INDIVIDUAL_SUPERVISOR,
	SCORE_IMMEDIATE_COACHING,
	SCORE_IMPACTS_ELGIBILITY,
	SCORE_IMMEDIATE_COACHING_NOTES,
	SCORE_IC_STATUS,
	SCORE_IC_ASSIGNED_TO_NAME,
	SCORE_IC_ASSIGNED_TO_EID,
	SCORE_DEDUCTION_NOTES,
	SCORE_EW_RESPONSE,
	SCORE_EW_RESPONSE_NOTES,
	SCORE_EW_RESPONSE_DATETIME_EST,
	SCORE_STAP_STATUS,
	SCORE_STAP_STATUS_DATE_EST,
	SCORE_STAP_NOTES,
	SCORE_STAP_MEETING_HELD,
	SCORE_STAP_ASSIGNED_TO_WORKER,
	SCORE_QA_RESPONSE,
	SCORE_QA_RESPONSE_NOTES,
	SCORE_QA_RESPONSE_DATETIME_EST,
	SCORE_MODIFIED_BY,
	SCORE_UPDATED,
	SCORE_CREATED,
	SCORE_TABLE_NAME,
	SCORE_LOG_CREATED_ON,
	SCORE_UPDATED_PROC,
	SCORE_EW_DOC3_NAME,
	SCORE_STAP_DOC2_NAME,
	SCORE_RESPONSBILE_INDIVIDUAL_TRAINING_STATUS,
	SCORE_STAP_DOC3_NAME,
	SCORE_EW_DOC1_NAME,
	SCORE_EW_DOC2_NAME,
	SCORE_STAP_DOC1_NAME,
	SCORE_IMMEDIATE_COACHING_DATETIME_EST,
	CPOOL_ID,
	CPOOL_CASE_IDENTIFIER,
	CPOOL_ALTERNATIVE_CASE_NUMBER,
	CPOOL_CASE_TYPE,
	CPOOL_UNIT,
	CPOOL_TYPE,
	CPOOL_SPECIALTY,
	CPOOL_DISPOSITION,
	CPOOL_DECISION_REASON,
	CPOOL_EW_DISPOSITION_DATE_EST,
	CPOOL_ELIGIBILITY_WORKER_EMP_ID,
	CPOOL_ELIGIBILIITY_WORKER_NAME,
	CPOOL_EW_SUPERVISOR,
	CPOOL_APPLICATION_SOURCE,
	CPOOL_EW_TRAINING_STATUS,
	CPOOL_ASSIGNED,
	CPOOL_ASSIGNED_TO,
	CPOOL_QA_STATUS,
	CPOOL_QA_STATUS_DATE_EST,
	CPOOL_QA_COMPLETE,
	CPOOL_LAST_ASSIGNED_EST,
	CPOOL_ASSIGNMENT_SOURCE,
	CPOOL_CATE_EMP_TERMED,
	CPOOL_INTAKE_EMP_ID,
	CPOOL_INTAKE_TRAINING_STATUS,
	CPOOL_INTAKE_EMP_TERMED,
	CPOOL_CREATED,
	CPOOL_MODIFIED_BY,
	CPOOL_UPDATED,
	CPOOL_TABLE_NAME,
	CPOOL_LOG_CREATED_ON,
	TOTAL_COUNT
) as
SELECT 
CONCAT(MONTHNAME(DECISION_DATE),'-',YEAR(DECISION_DATE)) AS MONTH_NAME,
CONCAT(YEAR(DECISION_DATE),'',MONTH(DECISION_DATE)) AS MONTH_ID,
INF.ID	AS	INF_ID	,
INF.DMAS_IC_SUBMISSION	AS	INF_DMAS_IC_SUBMISSION	,
INF.CASE_IDENTIFIER	AS	INF_CASE_IDENTIFIER	,
INF.ALTERNATIVE_CASE_NUMBER	AS	INF_ALTERNATIVE_CASE_NUMBER	,
INF.CASE_TYPE	AS	INF_CASE_TYPE	,
INF.EW_CASE_UNIT	AS	INF_EW_CASE_UNIT	,
INF.EW_CASE_TYPE	AS	INF_EW_CASE_TYPE	,
INF.EW_CASE_SPECIALTY	AS	INF_EW_CASE_SPECIALTY	,
INF.EW_CASE_DISPOSITION	AS	INF_EW_CASE_DISPOSITION	,
INF.EW_CASE_DECISION_REASON	AS	INF_EW_CASE_DECISION_REASON	,
INF.EW_CASE_DISPOSITION_DATE_EST	AS	INF_EW_CASE_DISPOSITION_DATE_EST	,
INF.ELIGIBILITY_WORKER_EMP_ID	AS	INF_ELIGIBILITY_WORKER_EMP_ID	,
INF.ELIGIBILIITY_WORKER_NAME	AS	INF_ELIGIBILIITY_WORKER_NAME	,
INF.EW_SUPERVISOR	AS	INF_EW_SUPERVISOR	,
INF.EW_CASE_APPLICATION_SOURCE	AS	INF_EW_CASE_APPLICATION_SOURCE	,
INF.EW_TRAINING_STATUS	AS	INF_EW_TRAINING_STATUS	,
INF.ASSIGNED	AS	INF_ASSIGNED	,
INF.ASSIGNED_TO	AS	INF_ASSIGNED_TO	,
INF.ASSIGNED_TO_NAME	AS	INF_ASSIGNED_TO_NAME	,
INF.QA_STATUS	AS	INF_QA_STATUS	,
INF.QA_STATUS_DATE_EST	AS	INF_QA_STATUS_DATE_EST	,
INF.QA_COMPLETE	AS	INF_QA_COMPLETE	,
INF.LAST_ASSIGNED_EST	AS	INF_LAST_ASSIGNED_EST	,
INF.ASSIGNMENT_SOURCE	AS	INF_ASSIGNMENT_SOURCE	,
INF.ADDL_INFO	AS	INF_ADDL_INFO	,
INF.PENDING_STATUS_REASONING	AS	INF_PENDING_STATUS_REASONING	,
INF.OTHER_STATUS_REASONING	AS	INF_OTHER_STATUS_REASONING	,
INF.CARDTYPE	AS	INF_CARDTYPE	,
INF.APP_SOURCE	AS	INF_APP_SOURCE	,
INF.APP_TYPE	AS	INF_APP_TYPE	,
INF.SCORECARD_TYPE	AS	INF_SCORECARD_TYPE	,
INF.DECISION_REASON	AS	INF_DECISION_REASON	,
INF.DECISION_DATE	AS	INF_DECISION_DATE	,
INF.PW_APP	AS	INF_PW_APP	,
INF.QA_PERCENTAGE	AS	INF_QA_PERCENTAGE	,
INF.IMMEDIATE_COACHING	AS	INF_IMMEDIATE_COACHING	,
INF.SBT_BTN	AS	INF_SBT_BTN	,
INF.CREATED	AS	INF_CREATED	,
INF.MODIFIED_BY	AS	INF_MODIFIED_BY	,
INF.UPDATED	AS	INF_UPDATED	,
INF.TABLE_NAME	AS	INF_TABLE_NAME	,
INF.LOG_CREATED_ON	AS	INF_LOG_CREATED_ON	,
SCORE.ID	AS	SCORE_ID	,
SCORE.DMAS_IC_SUBMISSION	AS	SCORE_DMAS_IC_SUBMISSION	,
SCORE.QA_INFO_ID	AS	SCORE_QA_INFO_ID	,
SCORE.QUESTION_IDENTIFIER	AS	SCORE_QUESTION_IDENTIFIER	,
SCORE.QUESTION	AS	SCORE_QUESTION	,
SCORE.ANSWER	AS	SCORE_ANSWER	,
SCORE.POSSIBLE_POINTS	AS	SCORE_POSSIBLE_POINTS	,
SCORE.MISSED_POINTS	AS	SCORE_MISSED_POINTS	,
SCORE.RESPONSIBLE_INDIVIDUAL_EMPID	AS	SCORE_RESPONSIBLE_INDIVIDUAL_EMPID	,
SCORE.RESPONSIBLE_INDIVIDUAL_NAME	AS	SCORE_RESPONSIBLE_INDIVIDUAL_NAME	,
SCORE.RESPONSIBLE_INDIVIDUAL_SUPERVISOR	AS	SCORE_RESPONSIBLE_INDIVIDUAL_SUPERVISOR	,
SCORE.IMMEDIATE_COACHING	AS	SCORE_IMMEDIATE_COACHING	,
SCORE.IMPACTS_ELGIBILITY	AS	SCORE_IMPACTS_ELGIBILITY	,
SCORE.IMMEDIATE_COACHING_NOTES	AS	SCORE_IMMEDIATE_COACHING_NOTES	,
SCORE.IC_STATUS	AS	SCORE_IC_STATUS	,
SCORE.IC_ASSIGNED_TO_NAME	AS	SCORE_IC_ASSIGNED_TO_NAME	,
SCORE.IC_ASSIGNED_TO_EID	AS	SCORE_IC_ASSIGNED_TO_EID	,
SCORE.DEDUCTION_NOTES	AS	SCORE_DEDUCTION_NOTES	,
SCORE.EW_RESPONSE	AS	SCORE_EW_RESPONSE	,
SCORE.EW_RESPONSE_NOTES	AS	SCORE_EW_RESPONSE_NOTES	,
SCORE.EW_RESPONSE_DATETIME_EST	AS	SCORE_EW_RESPONSE_DATETIME_EST	,
SCORE.STAP_STATUS	AS	SCORE_STAP_STATUS	,
SCORE.STAP_STATUS_DATE_EST	AS	SCORE_STAP_STATUS_DATE_EST	,
SCORE.STAP_NOTES	AS	SCORE_STAP_NOTES	,
SCORE.STAP_MEETING_HELD	AS	SCORE_STAP_MEETING_HELD	,
SCORE.STAP_ASSIGNED_TO_WORKER	AS	SCORE_STAP_ASSIGNED_TO_WORKER	,
SCORE.QA_RESPONSE	AS	SCORE_QA_RESPONSE	,
SCORE.QA_RESPONSE_NOTES	AS	SCORE_QA_RESPONSE_NOTES	,
SCORE.QA_RESPONSE_DATETIME_EST	AS	SCORE_QA_RESPONSE_DATETIME_EST	,
SCORE.MODIFIED_BY	AS	SCORE_MODIFIED_BY	,
SCORE.UPDATED	AS	SCORE_UPDATED	,
SCORE.CREATED	AS	SCORE_CREATED	,
SCORE.TABLE_NAME	AS	SCORE_TABLE_NAME	,
SCORE.LOG_CREATED_ON	AS	SCORE_LOG_CREATED_ON	,
SCORE.UPDATED_PROC	AS	SCORE_UPDATED_PROC	,
SCORE.EW_DOC3_NAME	AS	SCORE_EW_DOC3_NAME	,
SCORE.STAP_DOC2_NAME	AS	SCORE_STAP_DOC2_NAME	,
SCORE.RESPONSBILE_INDIVIDUAL_TRAINING_STATUS	AS	SCORE_RESPONSBILE_INDIVIDUAL_TRAINING_STATUS	,
SCORE.STAP_DOC3_NAME	AS	SCORE_STAP_DOC3_NAME	,
SCORE.EW_DOC1_NAME	AS	SCORE_EW_DOC1_NAME	,
SCORE.EW_DOC2_NAME	AS	SCORE_EW_DOC2_NAME	,
SCORE.STAP_DOC1_NAME	AS	SCORE_STAP_DOC1_NAME	,
SCORE.IMMEDIATE_COACHING_DATETIME_EST	AS	SCORE_IMMEDIATE_COACHING_DATETIME_EST	,
CPOOL.ID	AS	CPOOL_ID	,
CPOOL.CASE_IDENTIFIER	AS	CPOOL_CASE_IDENTIFIER	,
CPOOL.ALTERNATIVE_CASE_NUMBER	AS	CPOOL_ALTERNATIVE_CASE_NUMBER	,
CPOOL.CASE_TYPE	AS	CPOOL_CASE_TYPE	,
CPOOL.UNIT	AS	CPOOL_UNIT	,
CPOOL.TYPE	AS	CPOOL_TYPE	,
CPOOL.SPECIALTY	AS	CPOOL_SPECIALTY	,
CPOOL.DISPOSITION	AS	CPOOL_DISPOSITION	,
CPOOL.DECISION_REASON	AS	CPOOL_DECISION_REASON	,
CPOOL.EW_DISPOSITION_DATE_EST	AS	CPOOL_EW_DISPOSITION_DATE_EST	,
CPOOL.ELIGIBILITY_WORKER_EMP_ID	AS	CPOOL_ELIGIBILITY_WORKER_EMP_ID	,
CPOOL.ELIGIBILIITY_WORKER_NAME	AS	CPOOL_ELIGIBILIITY_WORKER_NAME	,
CPOOL.EW_SUPERVISOR	AS	CPOOL_EW_SUPERVISOR	,
CPOOL.APPLICATION_SOURCE	AS	CPOOL_APPLICATION_SOURCE	,
CPOOL.EW_TRAINING_STATUS	AS	CPOOL_EW_TRAINING_STATUS	,
CPOOL.ASSIGNED	AS	CPOOL_ASSIGNED	,
CPOOL.ASSIGNED_TO	AS	CPOOL_ASSIGNED_TO	,
CPOOL.QA_STATUS	AS	CPOOL_QA_STATUS	,
CPOOL.QA_STATUS_DATE_EST	AS	CPOOL_QA_STATUS_DATE_EST	,
CPOOL.QA_COMPLETE	AS	CPOOL_QA_COMPLETE	,
CPOOL.LAST_ASSIGNED_EST	AS	CPOOL_LAST_ASSIGNED_EST	,
CPOOL.ASSIGNMENT_SOURCE	AS	CPOOL_ASSIGNMENT_SOURCE	,
CPOOL.CATE_EMP_TERMED	AS	CPOOL_CATE_EMP_TERMED	,
CPOOL.INTAKE_EMP_ID	AS	CPOOL_INTAKE_EMP_ID	,
CPOOL.INTAKE_TRAINING_STATUS	AS	CPOOL_INTAKE_TRAINING_STATUS	,
CPOOL.INTAKE_EMP_TERMED	AS	CPOOL_INTAKE_EMP_TERMED	,
CPOOL.CREATED	AS	CPOOL_CREATED	,
CPOOL.MODIFIED_BY	AS	CPOOL_MODIFIED_BY	,
CPOOL.UPDATED	AS	CPOOL_UPDATED	,
CPOOL.TABLE_NAME	AS	CPOOL_TABLE_NAME	,
CPOOL.LOG_CREATED_ON	AS	CPOOL_LOG_CREATED_ON	,
1 AS TOTAL_COUNT  
FROM COVERVA_MIO.QA_INFO INF
JOIN COVERVA_MIO.QA_SCORES SCORE
ON INF.ID=SCORE.QA_INFO_ID
LEFT JOIN COVERVA_MIO.QA_CASE_POOL CPOOL 
ON INF.CASE_IDENTIFIER=CPOOL.CASE_IDENTIFIER
WHERE  INF.QA_COMPLETE=1
AND INF.DECISION_DATE BETWEEN DATE_TRUNC(MONTH, DATEADD(YEAR, -2, SYSDATE())) AND SYSDATE();


create or replace view MARS_DP4BI_PROD.PUBLIC.MIO_D_QA_ELIGIBILITY_TOOL_SV(
	MONTH_NAME,
	MONTH_ID,
	DECISION_DATE,
	EW_CASE_UNIT,
	CASE_TYPE,
	CARDTYPE,
	SCORECARD_CASE_ID,
	ELIGIBILITY_CASE_DISPOSITION_DATE,
	ELIGIBILITY_WORKER,
	ELIGIBILITY_WORKER_TMR_ID,
	ELIGIBILITY_WORKER_SUPERVISOR,
	QAS_NAME,
	INITIAL_SCORECARD_SUBMISSION_DATE,
	SCORECARD_LAST_UPDATE_DATE,
	SCORECARD_TRAINING_SUBISSION,
	SCORECARD_TYPE,
	SCORECARD_TOTAL_SCORE,
	QUESTION_NUMBER,
	QUESTION_POSSIBLE_POINTS,
	QUESTION_MISSED_POINTS,
	RESPONSIBLE_INDIVIDUAL_OF_QUESTION,
	RESPONSIBLE_INDIVIDUAL_OF_QUESTION_TMR_ID,
	RESPONSIBLE_INDIVIDUAL_OF_QUESTION_SUPERVSIOR,
	IMMEDIATE_COACHING_YN_OF_QUESTION,
	IMMEDIATE_COACHING_NOTES_OF_QUESTION,
	QUESTION_IMPACTS_ELIGIBILITY,
	EW_STAP_RESPONSE_OF_QUESTION,
	EW_STAP_NOTES_OF_QUESTION,
	EW_RESPONSE_TIMESTAMP_OF_QUESTION,
	STAP_STATUS_OF_QUESTION,
	SUPERVISOR_STAP_NOTES_OF_QUESTION,
	STAP_STATUS_TIMESTAMP_OF_QUESTION,
	STAP_MEETING_HELD_FOR_QUESTION,
	WORKER_ASSIGNED_TO_STAP_FOR_QUESTION_TMR_ID,
	QA_DISPUTE_RESPONSE_OF_QUESTION,
	QA_DISPUTE_RESPONSE_NOTES_OF_QUESTION,
	QA_DISPUTE_RESPONSE_TIMESTAMP_OF_QUESTION,
	TOTAL_COUNT
) as
SELECT 
    CONCAT(MONTHNAME(DECISION_DATE),'-',YEAR(DECISION_DATE)) AS MONTH_NAME,
    CONCAT(YEAR(DECISION_DATE),'',MONTH(DECISION_DATE)) AS MONTH_ID,
    INF.DECISION_DATE	AS	DECISION_DATE,
    INF.EW_CASE_UNIT AS EW_CASE_UNIT,
    INF.CASE_TYPE AS CASE_TYPE,
    INF.CARDTYPE AS CARDTYPE,
	INF.CASE_IDENTIFIER AS SCORECARD_CASE_ID,
    INF.EW_CASE_DISPOSITION_DATE_EST AS ELIGIBILITY_CASE_DISPOSITION_DATE,
    INF.ELIGIBILIITY_WORKER_NAME AS ELIGIBILITY_WORKER,
    INF.ELIGIBILITY_WORKER_EMP_ID AS ELIGIBILITY_WORKER_TMR_ID,
    INF.EW_SUPERVISOR AS ELIGIBILITY_WORKER_SUPERVISOR,
    INF.ASSIGNED_TO_NAME AS QAS_NAME,
    INF.QA_STATUS_DATE_EST AS INITIAL_SCORECARD_SUBMISSION_DATE,
    INF.UPDATED AS SCORECARD_LAST_UPDATE_DATE,
    INF.CARDTYPE AS SCORECARD_TRAINING_SUBISSION,
    INF.SCORECARD_TYPE AS SCORECARD_TYPE,
    INF.QA_PERCENTAGE AS SCORECARD_TOTAL_SCORE,
    SC.QUESTION_IDENTIFIER AS QUESTION_NUMBER,
    SC.POSSIBLE_POINTS AS QUESTION_POSSIBLE_POINTS,
    SC.MISSED_POINTS AS QUESTION_MISSED_POINTS,
    SC.RESPONSIBLE_INDIVIDUAL_NAME AS RESPONSIBLE_INDIVIDUAL_OF_QUESTION,
    SC.RESPONSIBLE_INDIVIDUAL_EMPID AS RESPONSIBLE_INDIVIDUAL_OF_QUESTION_TMR_ID,
    SC.RESPONSIBLE_INDIVIDUAL_SUPERVISOR AS RESPONSIBLE_INDIVIDUAL_OF_QUESTION_SUPERVSIOR,
    SC.IMMEDIATE_COACHING AS IMMEDIATE_COACHING_YN_OF_QUESTION,
    SC.IMMEDIATE_COACHING_NOTES  AS IMMEDIATE_COACHING_NOTES_OF_QUESTION,
    SC.IMPACTS_ELGIBILITY AS QUESTION_IMPACTS_ELIGIBILITY,    
    SC.EW_RESPONSE EW_STAP_RESPONSE_OF_QUESTION, 
    SC.EW_RESPONSE_NOTES AS EW_STAP_NOTES_OF_QUESTION, 
    SC.EW_RESPONSE_DATETIME_EST AS EW_RESPONSE_TIMESTAMP_OF_QUESTION, 
    SC.STAP_STATUS AS STAP_STATUS_OF_QUESTION,
    SC.STAP_NOTES AS SUPERVISOR_STAP_NOTES_OF_QUESTION, 
    SC.STAP_STATUS_DATE_EST AS STAP_STATUS_TIMESTAMP_OF_QUESTION, 
    SC.STAP_MEETING_HELD AS STAP_MEETING_HELD_FOR_QUESTION, 
    SC.STAP_ASSIGNED_TO_WORKER AS WORKER_ASSIGNED_TO_STAP_FOR_QUESTION_TMR_ID, 
    SC.QA_RESPONSE AS QA_DISPUTE_RESPONSE_OF_QUESTION, 
    SC.QA_RESPONSE_NOTES AS QA_DISPUTE_RESPONSE_NOTES_OF_QUESTION, 
    SC.QA_RESPONSE_DATETIME_EST AS QA_DISPUTE_RESPONSE_TIMESTAMP_OF_QUESTION,
    1 AS TOTAL_COUNT
  
 FROM COVERVA_MIO.QA_INFO INF
JOIN COVERVA_MIO.QA_SCORES SC
ON INF.ID=SC.QA_INFO_ID
WHERE  INF.QA_COMPLETE=1
AND INF.DECISION_DATE BETWEEN DATE_TRUNC(MONTH, DATEADD(YEAR, -2, SYSDATE())) AND SYSDATE();


create or replace view MARS_DP4BI_PROD.PUBLIC.MIO_D_CVIU_EXPARTE_RENWAL_REPORT_SV(
	REPORTING_MONTH,
	COUNTY,
	FILENAME,
	CASE_NUMBER,
	CLIENT_NAME,
	PRIMARY_WORKER_ID,
	AUTOMATED_EX_PARTE_RENEWAL_ATTEMPTED,
	RENEWAL_SUCCESSFUL,
	EXCEPTION_REASON,
	EX_PARTE_PROCESS,
	AID_CATEGORY_PRIOR_TO_EX_PARTE,
	CURRENT_RENEWAL_DATE,
	NEW_RENEWAL_DATE,
	DISPOSITION,
	UNIT,
	CASE_TYPE,
	"ATTEMPTED EX PARTE",
	"PASSED EX PARTE",
	"FAILED EX PARTE",
	"NON - ATTEMPT EX PARTE",
	"FAILED / NON - ATTEMPT EX PARTE CASES ASSIGNED TO LDSS",
	"FAILED / NON - ATTEMPT EX PARTE CASES ASSIGNED TO CVA",
	"TOTAL RENEWALS TO BE PROCESSED",
	"TOTAL RENEWALS PROCESSED",
	"TOTAL RENEWALS PENDING PROCESSED"
) as
SELECT DISTINCT TO_CHAR(CONCAT (
		MONTHNAME(TO_DATE(REPLACE(UPPER(FILENAME), 'EXPARTE_RUN_', ''), 'YYYYMMDD'))
		,'-'
		,YEAR(TO_DATE(REPLACE(UPPER(FILENAME), 'EXPARTE_RUN_', ''), 'YYYYMMDD'))
		)) AS REPORTING_MONTH
	,COUNTY AS COUNTY
	,FILENAME AS FILENAME 
	,EX.CASE_NUMBER AS CASE_NUMBER 
	,CLIENT_NAME AS CLIENT_NAME
	,PRIMARY_WORKER_ID AS PRIMARY_WORKER_ID
	,AUTOMATED_EX_PARTE_RENEWAL_ATTEMPTED AS AUTOMATED_EX_PARTE_RENEWAL_ATTEMPTED
	,RENEWAL_SUCCESSFUL
	,EXCEPTION_REASON
	,EX_PARTE_PROCESS
	,AID_CATEGORY_PRIOR_TO_EX_PARTE
	,CURRENT_RENEWAL_DATE
	,NEW_RENEWAL_DATE
	,DISPOSITION
	,UNIT
	,CASE_TYPE
	,CASE 
		WHEN (AUTOMATED_EX_PARTE_RENEWAL_ATTEMPTED = 'Y')
			AND (
				AID_CATEGORY_PRIOR_TO_EX_PARTE IN (
					108
					,109
					)
				)
			OR (
				AID_CATEGORY_PRIOR_TO_EX_PARTE IN (
					112
					,113
					)
				AND CONTAINS (
					PRIMARY_WORKER_ID
					,'900'
					)
				)
			THEN 1
		ELSE 0
		END AS "ATTEMPTED EX PARTE"
	,CASE 
		WHEN (AUTOMATED_EX_PARTE_RENEWAL_ATTEMPTED = 'Y')
			AND (RENEWAL_SUCCESSFUL = 'Y')
			AND (
				AID_CATEGORY_PRIOR_TO_EX_PARTE IN (
					108
					,109
					)
				)
			OR (
				AID_CATEGORY_PRIOR_TO_EX_PARTE IN (
					112
					,113
					)
				AND CONTAINS (
					PRIMARY_WORKER_ID
					,'900'
					)
				)
			THEN 1
		ELSE 0
		END AS "PASSED EX PARTE"
	,CASE 
		WHEN (AUTOMATED_EX_PARTE_RENEWAL_ATTEMPTED = 'Y')
			AND (RENEWAL_SUCCESSFUL = 'N')
			AND (
				AID_CATEGORY_PRIOR_TO_EX_PARTE IN (
					108
					,109
					)
				)
			OR (
				AID_CATEGORY_PRIOR_TO_EX_PARTE IN (
					112
					,113
					)
				AND CONTAINS (
					PRIMARY_WORKER_ID
					,'900'
					)
				)
			THEN 1
		ELSE 0
		END AS "FAILED EX PARTE"
	,CASE 
		WHEN (
				AUTOMATED_EX_PARTE_RENEWAL_ATTEMPTED IN (
					'F'
					,'N'
					,'Y'
					)
				)
			AND (RENEWAL_SUCCESSFUL = '')
			AND (
				AID_CATEGORY_PRIOR_TO_EX_PARTE IN (
					108
					,109
					)
				)
			OR (
				AID_CATEGORY_PRIOR_TO_EX_PARTE IN (
					112
					,113
					)
				AND CONTAINS (
					PRIMARY_WORKER_ID
					,'900'
					)
				)
			THEN 1
		ELSE 0
		END AS "NON-ATTEMPT EX PARTE"
	,CASE 
		WHEN (
				AUTOMATED_EX_PARTE_RENEWAL_ATTEMPTED IN (
					'F'
					,'N'
					,'Y'
					)
				)
			AND (RENEWAL_SUCCESSFUL = '')
			AND (
				AID_CATEGORY_PRIOR_TO_EX_PARTE IN (
					108
					,109
					)
				AND NOT CONTAINS (
					PRIMARY_WORKER_ID
					,'900'
					)
				)
			THEN 1
		ELSE 0
		END AS "FAILED/NON-ATTEMPT EX PARTE CASES ASSIGNED TO LDSS"
	,CASE 
		WHEN (
				AUTOMATED_EX_PARTE_RENEWAL_ATTEMPTED IN (
					'F'
					,'N'
					,'Y'
					)
				)
			AND (RENEWAL_SUCCESSFUL = '')
			AND (
				AID_CATEGORY_PRIOR_TO_EX_PARTE IN (
					108
					,109
					,112
					,113
					)
				AND CONTAINS (
					PRIMARY_WORKER_ID
					,'900'
					)
				)
			THEN 1
		ELSE 0
		END AS "FAILED/NON-ATTEMPT EX PARTE CASES ASSIGNED TO CVA"
	,CASE 
		WHEN (
				AUTOMATED_EX_PARTE_RENEWAL_ATTEMPTED IN (
					'F'
					,'N'
					,'Y'
					)
				)
			AND (RENEWAL_SUCCESSFUL = '')
			AND (
				AID_CATEGORY_PRIOR_TO_EX_PARTE IN (
					108
					,109
					,112
					,113
					)
				AND CONTAINS (
					PRIMARY_WORKER_ID
					,'900'
					)
				)
			THEN 1
		ELSE 0
		END AS "TOTAL RENEWALS TO BE PROCESSED"
	,CASE 
		WHEN (
				AUTOMATED_EX_PARTE_RENEWAL_ATTEMPTED IN (
					'F'
					,'N'
					,'Y'
					)
				)
			AND (RENEWAL_SUCCESSFUL = '')
			AND (
				AID_CATEGORY_PRIOR_TO_EX_PARTE IN (
					108
					,109
					,112
					,113
					)
				AND CONTAINS (
					PRIMARY_WORKER_ID
					,'900'
					)
				)
			AND DISPOSITION IS NOT NULL
			THEN 1
		ELSE 0
		END AS "TOTAL RENEWALS PROCESSED"
	,CASE 
		WHEN (
				AUTOMATED_EX_PARTE_RENEWAL_ATTEMPTED IN (
					'F'
					,'N'
					,'Y'
					)
				)
			AND (RENEWAL_SUCCESSFUL = '')
			AND (
				AID_CATEGORY_PRIOR_TO_EX_PARTE IN (
					108
					,109
					,112
					,113
					)
				AND CONTAINS (
					PRIMARY_WORKER_ID
					,'900'
					)
				)
			AND DISPOSITION IS NULL
			THEN 1
		ELSE 0
		END AS "TOTAL RENEWALS PENDING PROCESSED"
FROM COVERVA_DMAS.EXPARTE_RUN_FULL_LOAD EX
JOIN COVERVA_MIO.rpt_cviu_renewals RE ON EX.CASE_NUMBER = RE.CASE_NUMBER
WHERE case_type = 'R'
	AND unit = 'CVIU'
	AND exparte = 'Y';

