create or replace view PUBLIC.MIO_D_QA_ADHOC_REPORTING_TOOL_SV(
	MONTH_NAME,
	MONTH_ID,
	INF_ID,
	INF_DMAS_IC_SUBMISSION,
	INF_CASE_IDENTIFIER,
	INF_ALTERNATIVE_CASE_NUMBER,
	INF_CASE_TYPE,
	INF_EW_CASE_UNIT,
	INF_EW_CASE_TYPE,
	INF_EW_CASE_SPECIALTY,
	INF_EW_CASE_DISPOSITION,
	INF_EW_CASE_DECISION_REASON,
	INF_EW_CASE_DISPOSITION_DATE_EST,
	INF_ELIGIBILITY_WORKER_EMP_ID,
	INF_ELIGIBILIITY_WORKER_NAME,
	INF_EW_SUPERVISOR,
	INF_EW_CASE_APPLICATION_SOURCE,
	INF_EW_TRAINING_STATUS,
	INF_ASSIGNED,
	INF_ASSIGNED_TO,
	INF_ASSIGNED_TO_NAME,
	INF_QA_STATUS,
	INF_QA_STATUS_DATE_EST,
	INF_QA_COMPLETE,
	INF_LAST_ASSIGNED_EST,
	INF_ASSIGNMENT_SOURCE,
	INF_ADDL_INFO,
	INF_PENDING_STATUS_REASONING,
	INF_OTHER_STATUS_REASONING,
	INF_CARDTYPE,
	INF_APP_SOURCE,
	INF_APP_TYPE,
	INF_SCORECARD_TYPE,
	INF_DECISION_REASON,
	INF_DECISION_DATE,
	INF_PW_APP,
	INF_QA_PERCENTAGE,
	INF_IMMEDIATE_COACHING,
	INF_SBT_BTN,
	INF_CREATED,
	INF_MODIFIED_BY,
	INF_UPDATED,
	INF_TABLE_NAME,
	INF_LOG_CREATED_ON,
	SCORE_ID,
	SCORE_DMAS_IC_SUBMISSION,
	SCORE_QA_INFO_ID,
	SCORE_QUESTION_IDENTIFIER,
	SCORE_QUESTION,
	SCORE_ANSWER,
	SCORE_POSSIBLE_POINTS,
	SCORE_MISSED_POINTS,
	SCORE_RESPONSIBLE_INDIVIDUAL_EMPID,
	SCORE_RESPONSIBLE_INDIVIDUAL_NAME,
	SCORE_RESPONSIBLE_INDIVIDUAL_SUPERVISOR,
	SCORE_IMMEDIATE_COACHING,
	SCORE_IMPACTS_ELGIBILITY,
	SCORE_IMMEDIATE_COACHING_NOTES,
	SCORE_IC_STATUS,
	SCORE_IC_ASSIGNED_TO_NAME,
	SCORE_IC_ASSIGNED_TO_EID,
	SCORE_DEDUCTION_NOTES,
	SCORE_EW_RESPONSE,
	SCORE_EW_RESPONSE_NOTES,
	SCORE_EW_RESPONSE_DATETIME_EST,
	SCORE_STAP_STATUS,
	SCORE_STAP_STATUS_DATE_EST,
	SCORE_STAP_NOTES,
	SCORE_STAP_MEETING_HELD,
	SCORE_STAP_ASSIGNED_TO_WORKER,
	SCORE_QA_RESPONSE,
	SCORE_QA_RESPONSE_NOTES,
	SCORE_QA_RESPONSE_DATETIME_EST,
	SCORE_MODIFIED_BY,
	SCORE_UPDATED,
	SCORE_CREATED,
	SCORE_TABLE_NAME,
	SCORE_LOG_CREATED_ON,
	SCORE_UPDATED_PROC,
	SCORE_EW_DOC3_NAME,
	SCORE_STAP_DOC2_NAME,
	SCORE_RESPONSBILE_INDIVIDUAL_TRAINING_STATUS,
	SCORE_STAP_DOC3_NAME,
	SCORE_EW_DOC1_NAME,
	SCORE_EW_DOC2_NAME,
	SCORE_STAP_DOC1_NAME,
	SCORE_IMMEDIATE_COACHING_DATETIME_EST,
	CPOOL_ID,
	CPOOL_CASE_IDENTIFIER,
	CPOOL_ALTERNATIVE_CASE_NUMBER,
	CPOOL_CASE_TYPE,
	CPOOL_UNIT,
	CPOOL_TYPE,
	CPOOL_SPECIALTY,
	CPOOL_DISPOSITION,
	CPOOL_DECISION_REASON,
	CPOOL_EW_DISPOSITION_DATE_EST,
	CPOOL_ELIGIBILITY_WORKER_EMP_ID,
	CPOOL_ELIGIBILIITY_WORKER_NAME,
	CPOOL_EW_SUPERVISOR,
	CPOOL_APPLICATION_SOURCE,
	CPOOL_EW_TRAINING_STATUS,
	CPOOL_ASSIGNED,
	CPOOL_ASSIGNED_TO,
	CPOOL_QA_STATUS,
	CPOOL_QA_STATUS_DATE_EST,
	CPOOL_QA_COMPLETE,
	CPOOL_LAST_ASSIGNED_EST,
	CPOOL_ASSIGNMENT_SOURCE,
	CPOOL_CATE_EMP_TERMED,
	CPOOL_INTAKE_EMP_ID,
	CPOOL_INTAKE_TRAINING_STATUS,
	CPOOL_INTAKE_EMP_TERMED,
	CPOOL_CREATED,
	CPOOL_MODIFIED_BY,
	CPOOL_UPDATED,
	CPOOL_TABLE_NAME,
	CPOOL_LOG_CREATED_ON,
	EMP_RESPONSIBLE_INDIVIDUAL_EMAIL,
	TOTAL_COUNT
) COPY GRANTS AS
SELECT 
CONCAT(MONTHNAME(DECISION_DATE),'-',YEAR(DECISION_DATE)) AS MONTH_NAME,
CONCAT(YEAR(DECISION_DATE),'',MONTH(DECISION_DATE)) AS MONTH_ID,
INF.ID	AS	INF_ID	,
INF.DMAS_IC_SUBMISSION	AS	INF_DMAS_IC_SUBMISSION	,
INF.CASE_IDENTIFIER	AS	INF_CASE_IDENTIFIER	,
INF.ALTERNATIVE_CASE_NUMBER	AS	INF_ALTERNATIVE_CASE_NUMBER	,
INF.CASE_TYPE	AS	INF_CASE_TYPE	,
INF.EW_CASE_UNIT	AS	INF_EW_CASE_UNIT	,
INF.EW_CASE_TYPE	AS	INF_EW_CASE_TYPE	,
INF.EW_CASE_SPECIALTY	AS	INF_EW_CASE_SPECIALTY	,
INF.EW_CASE_DISPOSITION	AS	INF_EW_CASE_DISPOSITION	,
INF.EW_CASE_DECISION_REASON	AS	INF_EW_CASE_DECISION_REASON	,
INF.EW_CASE_DISPOSITION_DATE_EST	AS	INF_EW_CASE_DISPOSITION_DATE_EST	,
INF.ELIGIBILITY_WORKER_EMP_ID	AS	INF_ELIGIBILITY_WORKER_EMP_ID	,
INF.ELIGIBILIITY_WORKER_NAME	AS	INF_ELIGIBILIITY_WORKER_NAME	,
INF.EW_SUPERVISOR	AS	INF_EW_SUPERVISOR	,
INF.EW_CASE_APPLICATION_SOURCE	AS	INF_EW_CASE_APPLICATION_SOURCE	,
INF.EW_TRAINING_STATUS	AS	INF_EW_TRAINING_STATUS	,
INF.ASSIGNED	AS	INF_ASSIGNED	,
INF.ASSIGNED_TO	AS	INF_ASSIGNED_TO	,
INF.ASSIGNED_TO_NAME	AS	INF_ASSIGNED_TO_NAME	,
INF.QA_STATUS	AS	INF_QA_STATUS	,
INF.QA_STATUS_DATE_EST	AS	INF_QA_STATUS_DATE_EST	,
INF.QA_COMPLETE	AS	INF_QA_COMPLETE	,
INF.LAST_ASSIGNED_EST	AS	INF_LAST_ASSIGNED_EST	,
INF.ASSIGNMENT_SOURCE	AS	INF_ASSIGNMENT_SOURCE	,
INF.ADDL_INFO	AS	INF_ADDL_INFO	,
INF.PENDING_STATUS_REASONING	AS	INF_PENDING_STATUS_REASONING	,
INF.OTHER_STATUS_REASONING	AS	INF_OTHER_STATUS_REASONING	,
INF.CARDTYPE	AS	INF_CARDTYPE	,
INF.APP_SOURCE	AS	INF_APP_SOURCE	,
INF.APP_TYPE	AS	INF_APP_TYPE	,
INF.SCORECARD_TYPE	AS	INF_SCORECARD_TYPE	,
INF.DECISION_REASON	AS	INF_DECISION_REASON	,
INF.DECISION_DATE	AS	INF_DECISION_DATE	,
INF.PW_APP	AS	INF_PW_APP	,
INF.QA_PERCENTAGE	AS	INF_QA_PERCENTAGE	,
INF.IMMEDIATE_COACHING	AS	INF_IMMEDIATE_COACHING	,
INF.SBT_BTN	AS	INF_SBT_BTN	,
INF.CREATED	AS	INF_CREATED	,
INF.MODIFIED_BY	AS	INF_MODIFIED_BY	,
INF.UPDATED	AS	INF_UPDATED	,
INF.TABLE_NAME	AS	INF_TABLE_NAME	,
INF.LOG_CREATED_ON	AS	INF_LOG_CREATED_ON	,
SCORE.ID	AS	SCORE_ID	,
SCORE.DMAS_IC_SUBMISSION	AS	SCORE_DMAS_IC_SUBMISSION	,
SCORE.QA_INFO_ID	AS	SCORE_QA_INFO_ID	,
SCORE.QUESTION_IDENTIFIER	AS	SCORE_QUESTION_IDENTIFIER	,
SCORE.QUESTION	AS	SCORE_QUESTION	,
SCORE.ANSWER	AS	SCORE_ANSWER	,
SCORE.POSSIBLE_POINTS	AS	SCORE_POSSIBLE_POINTS	,
SCORE.MISSED_POINTS	AS	SCORE_MISSED_POINTS	,
SCORE.RESPONSIBLE_INDIVIDUAL_EMPID	AS	SCORE_RESPONSIBLE_INDIVIDUAL_EMPID	,
SCORE.RESPONSIBLE_INDIVIDUAL_NAME	AS	SCORE_RESPONSIBLE_INDIVIDUAL_NAME	,
SCORE.RESPONSIBLE_INDIVIDUAL_SUPERVISOR	AS	SCORE_RESPONSIBLE_INDIVIDUAL_SUPERVISOR	,
SCORE.IMMEDIATE_COACHING	AS	SCORE_IMMEDIATE_COACHING	,
SCORE.IMPACTS_ELGIBILITY	AS	SCORE_IMPACTS_ELGIBILITY	,
SCORE.IMMEDIATE_COACHING_NOTES	AS	SCORE_IMMEDIATE_COACHING_NOTES	,
SCORE.IC_STATUS	AS	SCORE_IC_STATUS	,
SCORE.IC_ASSIGNED_TO_NAME	AS	SCORE_IC_ASSIGNED_TO_NAME	,
SCORE.IC_ASSIGNED_TO_EID	AS	SCORE_IC_ASSIGNED_TO_EID	,
SCORE.DEDUCTION_NOTES	AS	SCORE_DEDUCTION_NOTES	,
SCORE.EW_RESPONSE	AS	SCORE_EW_RESPONSE	,
SCORE.EW_RESPONSE_NOTES	AS	SCORE_EW_RESPONSE_NOTES	,
SCORE.EW_RESPONSE_DATETIME_EST	AS	SCORE_EW_RESPONSE_DATETIME_EST	,
SCORE.STAP_STATUS	AS	SCORE_STAP_STATUS	,
SCORE.STAP_STATUS_DATE_EST	AS	SCORE_STAP_STATUS_DATE_EST	,
SCORE.STAP_NOTES	AS	SCORE_STAP_NOTES	,
SCORE.STAP_MEETING_HELD	AS	SCORE_STAP_MEETING_HELD	,
SCORE.STAP_ASSIGNED_TO_WORKER	AS	SCORE_STAP_ASSIGNED_TO_WORKER	,
SCORE.QA_RESPONSE	AS	SCORE_QA_RESPONSE	,
SCORE.QA_RESPONSE_NOTES	AS	SCORE_QA_RESPONSE_NOTES	,
SCORE.QA_RESPONSE_DATETIME_EST	AS	SCORE_QA_RESPONSE_DATETIME_EST	,
SCORE.MODIFIED_BY	AS	SCORE_MODIFIED_BY	,
SCORE.UPDATED	AS	SCORE_UPDATED	,
SCORE.CREATED	AS	SCORE_CREATED	,
SCORE.TABLE_NAME	AS	SCORE_TABLE_NAME	,
SCORE.LOG_CREATED_ON	AS	SCORE_LOG_CREATED_ON	,
SCORE.UPDATED_PROC	AS	SCORE_UPDATED_PROC	,
SCORE.EW_DOC3_NAME	AS	SCORE_EW_DOC3_NAME	,
SCORE.STAP_DOC2_NAME	AS	SCORE_STAP_DOC2_NAME	,
SCORE.RESPONSBILE_INDIVIDUAL_TRAINING_STATUS	AS	SCORE_RESPONSBILE_INDIVIDUAL_TRAINING_STATUS	,
SCORE.STAP_DOC3_NAME	AS	SCORE_STAP_DOC3_NAME	,
SCORE.EW_DOC1_NAME	AS	SCORE_EW_DOC1_NAME	,
SCORE.EW_DOC2_NAME	AS	SCORE_EW_DOC2_NAME	,
SCORE.STAP_DOC1_NAME	AS	SCORE_STAP_DOC1_NAME	,
SCORE.IMMEDIATE_COACHING_DATETIME_EST	AS	SCORE_IMMEDIATE_COACHING_DATETIME_EST	,
CPOOL.ID	AS	CPOOL_ID	,
CPOOL.CASE_IDENTIFIER	AS	CPOOL_CASE_IDENTIFIER	,
CPOOL.ALTERNATIVE_CASE_NUMBER	AS	CPOOL_ALTERNATIVE_CASE_NUMBER	,
CPOOL.CASE_TYPE	AS	CPOOL_CASE_TYPE	,
CPOOL.UNIT	AS	CPOOL_UNIT	,
CPOOL.TYPE	AS	CPOOL_TYPE	,
CPOOL.SPECIALTY	AS	CPOOL_SPECIALTY	,
CPOOL.DISPOSITION	AS	CPOOL_DISPOSITION	,
CPOOL.DECISION_REASON	AS	CPOOL_DECISION_REASON	,
CPOOL.EW_DISPOSITION_DATE_EST	AS	CPOOL_EW_DISPOSITION_DATE_EST	,
CPOOL.ELIGIBILITY_WORKER_EMP_ID	AS	CPOOL_ELIGIBILITY_WORKER_EMP_ID	,
CPOOL.ELIGIBILIITY_WORKER_NAME	AS	CPOOL_ELIGIBILIITY_WORKER_NAME	,
CPOOL.EW_SUPERVISOR	AS	CPOOL_EW_SUPERVISOR	,
CPOOL.APPLICATION_SOURCE	AS	CPOOL_APPLICATION_SOURCE	,
CPOOL.EW_TRAINING_STATUS	AS	CPOOL_EW_TRAINING_STATUS	,
CPOOL.ASSIGNED	AS	CPOOL_ASSIGNED	,
CPOOL.ASSIGNED_TO	AS	CPOOL_ASSIGNED_TO	,
CPOOL.QA_STATUS	AS	CPOOL_QA_STATUS	,
CPOOL.QA_STATUS_DATE_EST	AS	CPOOL_QA_STATUS_DATE_EST	,
CPOOL.QA_COMPLETE	AS	CPOOL_QA_COMPLETE	,
CPOOL.LAST_ASSIGNED_EST	AS	CPOOL_LAST_ASSIGNED_EST	,
CPOOL.ASSIGNMENT_SOURCE	AS	CPOOL_ASSIGNMENT_SOURCE	,
CPOOL.CATE_EMP_TERMED	AS	CPOOL_CATE_EMP_TERMED	,
CPOOL.INTAKE_EMP_ID	AS	CPOOL_INTAKE_EMP_ID	,
CPOOL.INTAKE_TRAINING_STATUS	AS	CPOOL_INTAKE_TRAINING_STATUS	,
CPOOL.INTAKE_EMP_TERMED	AS	CPOOL_INTAKE_EMP_TERMED	,
CPOOL.CREATED	AS	CPOOL_CREATED	,
CPOOL.MODIFIED_BY	AS	CPOOL_MODIFIED_BY	,
CPOOL.UPDATED	AS	CPOOL_UPDATED	,
CPOOL.TABLE_NAME	AS	CPOOL_TABLE_NAME	,
CPOOL.LOG_CREATED_ON	AS	CPOOL_LOG_CREATED_ON	,
EMP.EMP_EMAIL AS EMP_RESPONSIBLE_INDIVIDUAL_EMAIL,
1 AS TOTAL_COUNT  
FROM COVERVA_MIO.QA_INFO INF
JOIN COVERVA_MIO.QA_SCORES SCORE
ON INF.ID=SCORE.QA_INFO_ID
LEFT JOIN COVERVA_MIO.QA_CASE_POOL CPOOL 
ON INF.CASE_IDENTIFIER=CPOOL.CASE_IDENTIFIER
LEFT JOIN COVERVA_MIO.EMPLOYEES EMP
ON SCORE.RESPONSIBLE_INDIVIDUAL_EMPID=EMP.ID
WHERE  INF.QA_COMPLETE=1
AND INF.DECISION_DATE BETWEEN DATE_TRUNC(MONTH, DATEADD(YEAR, -2, SYSDATE())) AND SYSDATE();