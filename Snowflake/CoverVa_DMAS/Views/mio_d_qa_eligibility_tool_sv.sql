create or replace view MARS_DP4BI_PROD.PUBLIC.MIO_D_QA_ELIGIBILITY_TOOL_SV(
	MONTH_NAME,
	MONTH_ID,
	DECISION_DATE,
	EW_CASE_UNIT,
	CASE_TYPE,
	CARDTYPE,
	SCORECARD_CASE_ID,
	ELIGIBILITY_CASE_DISPOSITION_DATE,
	ELIGIBILITY_WORKER,
	ELIGIBILITY_WORKER_TMR_ID,
	ELIGIBILITY_WORKER_SUPERVISOR,
	QAS_NAME,
	INITIAL_SCORECARD_SUBMISSION_DATE,
	SCORECARD_LAST_UPDATE_DATE,
	SCORECARD_TRAINING_SUBISSION,
	SCORECARD_TYPE,
	SCORECARD_TOTAL_SCORE,
	QUESTION_NUMBER,
	QUESTION,
	QUESTION_POSSIBLE_POINTS,
	QUESTION_MISSED_POINTS,
	RESPONSIBLE_INDIVIDUAL_OF_QUESTION,
	RESPONSIBLE_INDIVIDUAL_OF_QUESTION_TMR_ID,
	RESPONSIBLE_INDIVIDUAL_OF_QUESTION_SUPERVSIOR,
	IMMEDIATE_COACHING_YN_OF_QUESTION,
	IMMEDIATE_COACHING_NOTES_OF_QUESTION,
	QUESTION_IMPACTS_ELIGIBILITY,
	EW_STAP_RESPONSE_OF_QUESTION,
	EW_STAP_NOTES_OF_QUESTION,
	EW_RESPONSE_TIMESTAMP_OF_QUESTION,
	STAP_STATUS_OF_QUESTION,
	SUPERVISOR_STAP_NOTES_OF_QUESTION,
	STAP_STATUS_TIMESTAMP_OF_QUESTION,
	STAP_MEETING_HELD_FOR_QUESTION,
	WORKER_ASSIGNED_TO_STAP_FOR_QUESTION_TMR_ID,
	QA_DISPUTE_RESPONSE_OF_QUESTION,
	QA_DISPUTE_RESPONSE_NOTES_OF_QUESTION,
	QA_DISPUTE_RESPONSE_TIMESTAMP_OF_QUESTION,
	QA_STATUS ,
	TOTAL_COUNT
) COPY GRANTS as
SELECT 
    CONCAT(MONTHNAME(DECISION_DATE),'-',YEAR(DECISION_DATE)) AS MONTH_NAME,
    CONCAT(YEAR(DECISION_DATE),'',MONTH(DECISION_DATE)) AS MONTH_ID,
    INF.DECISION_DATE	AS	DECISION_DATE,
    INF.EW_CASE_UNIT AS EW_CASE_UNIT,
    INF.CASE_TYPE AS CASE_TYPE,
    INF.CARDTYPE AS CARDTYPE,
	INF.CASE_IDENTIFIER AS SCORECARD_CASE_ID,
    INF.EW_CASE_DISPOSITION_DATE_EST AS ELIGIBILITY_CASE_DISPOSITION_DATE,
    INF.ELIGIBILIITY_WORKER_NAME AS ELIGIBILITY_WORKER,
    INF.ELIGIBILITY_WORKER_EMP_ID AS ELIGIBILITY_WORKER_TMR_ID,
    INF.EW_SUPERVISOR AS ELIGIBILITY_WORKER_SUPERVISOR,
    INF.ASSIGNED_TO_NAME AS QAS_NAME,
    INF.QA_STATUS_DATE_EST AS INITIAL_SCORECARD_SUBMISSION_DATE,
    INF.UPDATED AS SCORECARD_LAST_UPDATE_DATE,
    INF.CARDTYPE AS SCORECARD_TRAINING_SUBISSION,
    INF.SCORECARD_TYPE AS SCORECARD_TYPE,
    INF.QA_PERCENTAGE AS SCORECARD_TOTAL_SCORE,
    SC.QUESTION_IDENTIFIER AS QUESTION_NUMBER,
    SC.QUESTION AS QUESTION,
    SC.POSSIBLE_POINTS AS QUESTION_POSSIBLE_POINTS,
    SC.MISSED_POINTS AS QUESTION_MISSED_POINTS,
    SC.RESPONSIBLE_INDIVIDUAL_NAME AS RESPONSIBLE_INDIVIDUAL_OF_QUESTION,
    SC.RESPONSIBLE_INDIVIDUAL_EMPID AS RESPONSIBLE_INDIVIDUAL_OF_QUESTION_TMR_ID,
    SC.RESPONSIBLE_INDIVIDUAL_SUPERVISOR AS RESPONSIBLE_INDIVIDUAL_OF_QUESTION_SUPERVSIOR,
    SC.IMMEDIATE_COACHING AS IMMEDIATE_COACHING_YN_OF_QUESTION,
    SC.IMMEDIATE_COACHING_NOTES  AS IMMEDIATE_COACHING_NOTES_OF_QUESTION,
    SC.IMPACTS_ELGIBILITY AS QUESTION_IMPACTS_ELIGIBILITY,    
    SC.EW_RESPONSE EW_STAP_RESPONSE_OF_QUESTION, 
    SC.EW_RESPONSE_NOTES AS EW_STAP_NOTES_OF_QUESTION, 
    SC.EW_RESPONSE_DATETIME_EST AS EW_RESPONSE_TIMESTAMP_OF_QUESTION, 
    SC.STAP_STATUS AS STAP_STATUS_OF_QUESTION,
    SC.STAP_NOTES AS SUPERVISOR_STAP_NOTES_OF_QUESTION, 
    SC.STAP_STATUS_DATE_EST AS STAP_STATUS_TIMESTAMP_OF_QUESTION, 
    SC.STAP_MEETING_HELD AS STAP_MEETING_HELD_FOR_QUESTION, 
    SC.STAP_ASSIGNED_TO_WORKER AS WORKER_ASSIGNED_TO_STAP_FOR_QUESTION_TMR_ID, 
    SC.QA_RESPONSE AS QA_DISPUTE_RESPONSE_OF_QUESTION, 
    SC.QA_RESPONSE_NOTES AS QA_DISPUTE_RESPONSE_NOTES_OF_QUESTION, 
    SC.QA_RESPONSE_DATETIME_EST AS QA_DISPUTE_RESPONSE_TIMESTAMP_OF_QUESTION,
    INF.QA_STATUS as QA_STATUS ,
    1 AS TOTAL_COUNT
  
 FROM COVERVA_MIO.QA_INFO INF
JOIN COVERVA_MIO.QA_SCORES SC
ON INF.ID=SC.QA_INFO_ID
WHERE  INF.QA_COMPLETE=1
AND INF.DECISION_DATE BETWEEN DATE_TRUNC(MONTH, DATEADD(YEAR, -2, SYSDATE())) AND SYSDATE();