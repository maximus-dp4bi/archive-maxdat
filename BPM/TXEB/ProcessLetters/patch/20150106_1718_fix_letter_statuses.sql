
update corp_etl_proc_letters
set cancel_by = last_update_by_name
     ,cancel_dt = last_update_dt
     ,cancel_method = 'Normal'
     ,cancel_reason = 'Request cancelled by system due to status'
     ,instance_status = 'Complete'
     ,complete_dt = last_update_dt
 where status in('Voided','Canceled','Combined Similar Requests','Overcome by Events')
and instance_status = 'Active';

UPDATE corp_etl_proc_letters
set status = 'Sent',sent_dt = to_date('01/05/2015 01:46:35','mm/dd/yyyy hh24:mi:ss'),transmit_file_name = 'LetterRequests20150105.011955000870',transmit_file_dt = to_date('01/05/2015 01:19:55','mm/dd/yyyy hh24:mi:ss'), last_update_dt = to_date('01/05/2015 01:46:35','mm/dd/yyyy hh24:mi:ss'),last_update_by_name = 'MAXeb'
,ased_process_letter_req = to_date('01/05/2015 01:46:35','mm/dd/yyyy hh24:mi:ss'),assd_transmit = to_date('01/05/2015 01:46:35','mm/dd/yyyy hh24:mi:ss'),ased_transmit = to_date('01/05/2015 01:46:35','mm/dd/yyyy hh24:mi:ss')
,assd_receive_confirmation = to_date('01/05/2015 01:46:35','mm/dd/yyyy hh24:mi:ss'),asf_process_letter_req = 'Y',asf_transmit = 'Y',gwf_valid = 'Y'
where letter_request_id = 22633937;

update corp_etl_proc_letters l
set cancel_by = last_update_by_name
     ,cancel_dt = last_update_dt
     ,cancel_method = 'Normal'
     ,cancel_reason = 'Request cancelled by system due to status'
     ,instance_status = 'Complete'
     ,complete_dt = last_update_dt
     ,status = (select letter_status from letters_stg s where s.letter_id = l.letter_request_id)
where letter_request_id in(
6723013	,
6723039	,
6723088	,
6723179	,
6723194	,
6723204	,
6723048	,
6723135	,
6723042	,
6722989	,
6723125	,
6722980	,
6723001	,
6723059	,
6723073	,
6723087	,
6723213	,
6722990	,
6723060	,
6723066	,
6723193	,
6723074	,
6723100	,
6722994	,
6722976	,
6723163	,
6723136	,
6723226	,
6723225	,
6723005	,
6723020	,
6723032	,
6723002	,
6723116	,
6723164	,
6723203	,
6723014	,
6723028	,
6723126	,
6723053	,
6723115	,
6723265	,
6723029	,
6723178	,
6723147	,
6723038	,
6723214	,
6723145	,
6723255	,
6723246	,
6723256	,
6723099	,
6723245	,
6722977	,
6723049	,
20288489	,
21053934	,
21053984	,
21054114	,
21054276	,
21054316	,
21054356	,
21054386	,
21053980	,
21050780	,
21054184	,
21054194	,
21053990	,
21054100	,
21054120	,
21054160	,
21054220	,
21054290	,
21054300	,
21054310	,
21054340	,
21054350	,
21054360	,
21054364	,
21054384	,
21054394	,
21053999	,
21053927	,
21053977	,
21054037	,
21054067	,
21054077	,
21054097	,
21054169	,
21054189	,
21054199	,
21054379	,
21054217	,
21054267	,
21053207	,
21047451	,
21047551	,
21053983	,
21054143	,
21054173	,
21054233	,
21054253	,
21054313	,
21054323	,
21053941	,
21053971	,
21054011	,
21054383	,
21054393	,
21054098	,
21054108	,
21054248	,
21054268	,
21054021	,
21054091	,
21054171	,
21054181	,
21054191	,
21054201	,
21054281	,
21054331	,
21054351	,
21050831	,
21054105	,
21054125	,
21054298	,
21054308	,
21053942	,
21053952	,
21053982	,
21054135	,
21054175	,
21054215	,
21054225	,
21054122	,
21054252	,
21054292	,
21054352	,
21054362	,
21053926	,
21054365	,
21047463	,
21054076	,
21054126	,
21054156	,
21054186	,
21054236	,
21156833	,
21157313	,
21157383	,
21153016	,
21157297	,
21157307	,
21157347	,
21157286	,
21157396	,
21157375	,
21126147	,
21138128	,
21138198	,
21138248	,
21138308	,
21138328	,
21138348	,
21126146	,
21126186	,
21126654	,
21138087	,
21138117	,
21138127	,
21138137	,
21138257	,
21138267	,
21138277	,
21138397	,
21124752	,
21138179	,
21138189	,
21138269	,
21126194	,
21126745	,
21126785	,
21126815	,
21126875	,
21138066	,
21138086	,
21138126	,
21138136	,
21138206	,
21138246	,
21138306	,
21138376	,
21138386	,
21127047	,
21138085	,
21138245	,
21138275	,
21126673	,
21126683	,
21126693	,
21126703	,
21138525	,
21138080	,
21138170	,
21138290	,
21138360	,
21138390	,
21138520	,
21138084	,
21138174	,
21138304	,
21138314	,
21134853	,
21138112	,
21138202	,
21138212	,
21138282	,
21138302	,
21138312	,
21138322	,
21138422	,
21134892	,
21138261	,
21138311	,
21138371	,
21138113	,
21138143	,
21138173	,
21138203	,
21138273	,
21138303	,
21157378	,
21126749	,
21126759	,
21157399	,
21157342	,
21157392	,
21157402	,
21157582	,
21126690	,
21126850	,
21157401	,
21126752	,
21157581	,
21157290	,
21126728	,
21126818	,
21157580	,
21126978	,
21126681	,
21126691	,
21126851	,
6723266	,
6723282	,
6723296	,
6723312	,
6723325	,
6723335	,
6723348	,
6723360	,
6723370	,
6723384	,
6723398	,
6723409	,
6723419	,
6723429	,
6723441	,
6723455	,
6723468	,
6723482	,
6722979	,
6722992	,
6723004	,
6723019	,
6723031	,
6723041	,
6723052	,
6723064	,
6723077	,
6723090	,
6723103	,
6723118	,
6723128	,
6723138	,
6723155	,
6723166	,
6723183	,
6722975	,
6722988	,
6723000	,
6723012	,
6723027	,
6723037	,
6723047	,
6723058	,
6723071	,
6723084	,
6722971	,
6722981	,
6722995	,
6723006	,
6723023	,
6723033	,
6723043	,
6723054	,
6723067	,
6723079	,
6723092	,
6723105	,
6723120	,
6723130	,
6723140	,
6723157	,
6723169	,
6723188	,
6723198	,
6723208	,
6723218	,
6723235	,
6723250	,
6723260	,
6723270	,
6722972	,
6723196	,
6723206	,
6723216	,
6723232	,
6723248	,
6723258	,
6723268	,
6723286	,
6723298	,
6723317	,
6723327	,
6723337	,
6723350	,
6723362	,
6723372	,
6723388	,
6723400	,
6723411	,
6723421	,
6723431	,
6723443	,
6723458	,
6723471	,
6723281	,
6723295	,
6723308	,
6723324	,
6723334	,
6723344	,
6723359	,
6723369	,
6723383	,
6723397	,
6722982	,
6722996	,
6723008	,
6723024	,
6723034	,
6723044	,
6723055	,
6723068	,
6723081	,
6723094	,
6723107	,
6723121	,
6723131	,
6723141	,
6723158	,
6723172	,
6723189	,
6723199	,
6723209	,
6723219	,
6723236	,
6723251	,
6723261	,
6723271	,
6723290	,
6723301	,
6723320	,
6723330	,
6723340	,
6723355	,
6723365	,
6723375	,
6723391	,
6723403	,
6723414	,
6723408	,
6723418	,
6723428	,
6723440	,
6723454	,
6723467	,
6723481	,
6723078	,
6723091	,
6723104	,
6723119	,
6723129	,
6723139	,
6723156	,
6723167	,
6723184	,
6723197	,
6723207	,
6723217	,
6723234	,
6723249	,
6723259	,
6723269	,
6723287	,
6723299	,
6723318	,
6723328	,
6723338	,
6723353	,
6723363	,
6723373	,
6723389	,
6723401	,
6723412	,
6723424	,
6723434	,
6723449	,
6723462	,
6723475	,
6722974	,
6722987	,
6722999	,
6723010	,
6723026	,
6723036	,
6723046	,
6723057	,
6723070	,
6723083	,
6723097	,
6723110	,
6723123	,
6723133	,
6723143	,
6723161	,
6723174	,
6723191	,
6723201	,
6723211	,
6723222	,
6723240	,
6723253	,
6723263	,
6723275	,
6723292	,
6723304	,
6723322	,
6723422	,
6723432	,
6723444	,
6723460	,
6723472	,
6722978	,
6722991	,
6723003	,
6723015	,
6723030	,
6723040	,
6723050	,
6723062	,
6723075	,
6723089	,
6723101	,
6723117	,
6723127	,
6723137	,
6723149	,
6723165	,
6723180	,
6723195	,
6723205	,
6723215	,
6723227	,
6723247	,
6723257	,
6723267	,
6723283	,
6723297	,
6723314	,
6723326	,
6723332	,
6723342	,
6723357	,
6723367	,
6723381	,
6723395	,
6723405	,
6723416	,
6723426	,
6723438	,
6723452	,
6723465	,
6723479	,
6723289	,
6723300	,
6723319	,
6723329	,
6723339	,
6723354	,
6723364	,
6723374	,
6723390	,
6723402	,
6723413	,
6723423	,
6723433	,
6723448	,
6723461	,
6723473	,
6723098	,
6723114	,
6723124	,
6723336	,
6723349	,
6723361	,
6723371	,
6723385	,
6723399	,
6723410	,
6723420	,
6723430	,
6723442	,
6723457	,
6723469	,
6723483	,
6723134	,
6723144	,
6723162	,
6723176	,
6723192	,
6723202	,
6723212	,
6723223	,
6723241	,
6723254	,
6723264	,
6723276	,
6723293	,
6723306	,
6723323	,
6723333	,
6723343	,
6723358	,
6723368	,
6723382	,
6723396	,
6723406	,
6723417	,
6723427	,
6723439	,
6723453	,
6723466	,
6723480	,
6722973	,
6722986	,
6722997	,
6723009	,
6723025	,
6723035	,
6723045	,
6723056	,
6723069	,
6723082	,
6723095	,
6723108	,
6723122	,
6723132	,
6723142	,
6723160	,
6723173	,
6723190	,
6723200	,
6723210	,
6723220	,
6723239	,
6723252	,
6723262	,
6723272	,
6723291	,
6723303	,
6723321	,
6723331	,
6723341	,
6723356	,
6723366	,
6723376	,
6723393	,
6723404	,
6723415	,
6723425	,
6723437	,
6723450	,
6723464	,
6723478	);

update corp_etl_proc_letters
set status = 'Mailed'
    ,status_dt = to_date('12/04/2014','mm/dd/yyyy')
    ,mailed_dt = to_date('12/02/2014','mm/dd/yyyy')
    ,print_dt = to_date('12/02/2014','mm/dd/yyyy')
    ,ased_receive_confirmation = to_date('12/02/2014','mm/dd/yyyy')
    ,cancel_dt = null
    ,cancel_by = null
    ,cancel_reason = null
    ,cancel_method = null
where letter_request_id in(21048542,
21048694,
21052278,
21047769,
21053577,
21047624,
21051920,
21049264,
21048120,
21050235,
21048012,
21052947,
21051959,
21049257,
21051977,
21050698,
21049004,
21048003,
19782651);
    

--duplicate records in letters_stg table

delete from letters_stg
where letter_id in(272171	,
306521	,
306522	,
306893	,
368071	,
368276	,
439909	,
439910	,
469695	,
1394084	,
1394603	,
1861627	,
1938594	,
1948829	,
1948830	,
1948832	,
1949044	,
1949721	,
1950393	,
1950648	,
1950962	,
1951698	,
1952360	,
1952918	,
1955331	,
1955830	,
1956168	,
1956260	,
1957503	,
1957670	,
1957753	,
1958079	,
1958737	,
1959727	,
1959728	,
1960608	,
1964742	,
1965193	,
1965213	,
1965960	,
1966664	,
1966994	,
1967256	,
1967626	,
1968603	,
1971737	,
1971819	,
1972144	,
1972192	,
1972609	,
1972679	,
1972902	,
1973549	,
1973898	,
1974779	,
1974796	,
1975047	,
1975785	,
1975871	,
1977213	,
1977497	,
1978270	,
1979426	,
1979707	,
1981105	,
1981550	,
1981591	,
1981973	,
1983931	,
1984591	,
1984886	,
1985359	,
1985626	,
1986307	,
1986621	,
1989037	,
1990049	,
1992905	,
1994985	,
1996338	,
2000155	,
2000902	,
2002948	,
2003116	,
2003385	,
2005981	,
2006206	,
2006568	,
2008865	,
2010255	,
2010270	,
2011374	,
2011375	,
2011376	,
2011390	,
2011455	,
2011480	,
2011483	,
2011748	,
2015104	,
2030381	,
2053128	,
2053136	,
2053141	,
2053142	,
2053144	,
2064492	,
2064493	,
2064499	,
2064501	,
2064505	,
2067588	,
2302743	,
2303083	,
2303412	,
2303598	,
2303820	,
2303880	,
2303980	,
2307550	,
2311088	,
2312970	,
2314413	,
2326364	,
2326781	,
2326811	,
2328114	,
2328455	,
2328476	,
2330891	,
2358285	,
2359388	,
2360406	,
2361879	,
2362239	,
2364586	,
2364758	,
2368125	,
2376813	,
2382894	,
2409236	,
2411338	,
2411343	,
2413486	,
2414992	,
2415953	,
2418206	,
2418215	,
2418235	,
2418248	,
2418923	,
2420313	,
2420573	,
2420633	,
2421082	,
2424190	,
2424360	,
2426370	,
2426683	,
2426855	,
2530374	,
2531997	,
2538572	,
2776014	,
2776016	,
2777905	,
2778753	,
2779677	,
2779678	,
2784954	,
2788908	,
2788913	,
2788994	,
3288461	,
3288929	,
3289338	,
3289412	,
3291661	,
3291777	,
3291805	,
3292762	,
3293473	,
3293756	,
3293800	,
3294876	,
3294984	,
3295151	,
3295679	,
3296745	,
3296806	,
3297024	,
3297662	,
3297855	,
3297966	,
3298046	,
3298084	,
3298233	,
3298452	,
3298454	,
3298490	,
3298593	,
3298726	,
3298823	,
3298875	,
3299103	,
3301028	,
3312632	,
3314589	,
3316795	,
3318530	,
3319058	,
3319076	,
3319397	,
3319834	,
3320048	,
3320056	,
3320068	,
3320354	,
3320502	,
3321576	,
3321646	,
3322048	,
3326360	,
3326699	,
3326751	,
3327827	,
3328529	,
3333344	,
3334553	,
3798015	,
3798120	,
3798188	,
3798339	,
3799428	,
3799993	,
3800034	,
3801761	,
3802094	,
3804018	,
3804024	,
3804874	,
3804992	,
3805995	,
3806537	,
3807695	,
3807796	,
3812463	,
3812780	,
3813512	,
3817320	,
3819374	,
3840244	,
3841700	,
3842220	,
3842646	,
3842750	,
3844127	,
3844217	,
3846003	,
3846313	,
3846318	,
3846343	,
3846528	,
3846619	,
3846651	,
3846691	,
3846754	,
3846835	,
3846850	,
3848939	,
3850679	,
3857825	,
3862786	,
3868460	,
3869079	,
3869144	,
3869588	,
3871553	,
3872237	,
6783292	,
6783615	,
6783640	,
6783714	,
6783792	,
6785088	,
6785294	,
6786183	,
6786440	,
6786618	,
6788389	,
6792662	,
6792793	,
6796772	,
6797380	,
6799665	,
6801227	,
7927273	)
and residence_county is null;

delete from letters_stg s
where letter_id in(1394084	,
1394603	,
1861627	,
1938594	,
1949721	,
1950393	,
1950648	,
1950962	,
1951698	,
1952360	,
1952918	,
1955331	,
1955830	,
1956168	,
1956260	,
1957503	,
1957670	,
1957753	,
1958079	,
1958737	,
1959727	,
1959728	,
1960608	,
1964742	,
1965193	,
1965213	,
1965960	,
1966664	,
1966994	,
1967256	,
1967626	,
1968603	,
1971737	,
1971819	,
1972144	,
1972192	,
1972609	,
1972679	,
1972902	,
1973549	,
1973898	,
1974779	,
1974796	,
1975047	,
1975785	,
1975871	,
1977213	,
1977497	,
1978270	,
1979426	,
1979707	,
1981105	,
1981550	,
1981591	,
1981973	,
1983931	,
1984591	,
1984886	,
1985359	,
1985626	,
1986307	,
1986621	,
1989037	,
1990049	,
1992905	,
1994985	,
1996338	,
2000155	,
2000902	,
2002948	,
2003116	,
2003385	,
2005981	,
2006206	,
2006568	,
2008865	,
2010255	,
2010270	,
2015104	,
2030381	,
2067588	,
2302743	,
2303083	,
2303412	,
2303598	,
2303820	,
2303880	,
2303980	,
2307550	,
2311088	,
2312970	,
2314413	,
2326364	,
2326781	,
2326811	,
2328114	,
2328455	,
2328476	,
2330891	,
2358285	,
2359388	,
2360406	,
2361879	,
2362239	,
2364586	,
2364758	,
2368125	,
2376813	,
2382894	,
2409236	,
2411338	,
2411343	,
2413486	,
2414992	,
2415953	,
2418206	,
2418215	,
2418235	,
2418248	,
2418923	,
2420313	,
2420573	,
2420633	,
2421082	,
2424190	,
2424360	,
2426370	,
2426683	,
2426855	,
2530374	,
2531997	,
2538572	,
2776014	,
2776016	,
2777905	,
2778753	,
2779677	,
2779678	,
2784954	,
2788908	,
2788913	,
2788994	,
3288461	,
3288929	,
3289338	,
3289412	,
3291661	,
3291777	,
3291805	,
3292762	,
3293473	,
3293756	,
3293800	,
3294876	,
3294984	,
3295151	,
3295679	,
3296745	,
3296806	,
3297024	,
3297662	,
3297855	,
3297966	,
3298046	,
3298084	,
3298233	,
3298452	,
3298454	,
3298490	,
3298593	,
3298726	,
3298823	,
3298875	,
3299103	,
3301028	,
3312632	,
3314589	,
3316795	,
3318530	,
3319058	,
3319076	,
3319397	,
3319834	,
3320048	,
3320056	,
3320068	,
3320354	,
3320502	,
3321576	,
3321646	,
3322048	,
3326360	,
3326699	,
3326751	,
3327827	,
3328529	,
3333344	,
3334553	,
3798015	,
3798120	,
3798188	,
3798339	,
3799428	,
3799993	,
3800034	,
3801761	,
3802094	,
3804018	,
3804024	,
3804874	,
3804992	,
3805995	,
3806537	,
3807695	,
3807796	,
3812463	,
3812780	,
3813512	,
3817320	,
3819374	,
3840244	,
3841700	,
3842220	,
3842646	,
3842750	,
3844127	,
3844217	,
3846003	,
3846313	,
3846318	,
3846343	,
3846528	,
3846619	,
3846651	,
3846691	,
3846754	,
3846835	,
3846850	,
3848939	,
3850679	,
3857825	,
3862786	,
3868460	,
3869079	,
3869144	,
3869588	,
3871553	,
3872237	,
6783640	,
6783792	,
6785294	,
6786183	,
6786618	,
6797380	
	)
and s.rowid > any(select s1.rowid from letters_stg s1 where s.letter_id = s1.letter_id);

commit;
