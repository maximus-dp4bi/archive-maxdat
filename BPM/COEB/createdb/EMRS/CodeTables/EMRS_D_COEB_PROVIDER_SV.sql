CREATE OR REPLACE VIEW MAXDAT_SUPPORT.EMRS_D_COEB_PROVIDER_SV AS
SELECT PX.RAE_ID PLAN_ID_ext
, 'MEDICAID' MANAGED_CARE_PROGRAM
, CASE WHEN PROVIDER_ID_EXT IN ('07020368','23876239') THEN 'MCO' ELSE 'PCMP' END PROVIDER_ORG_TYPE
, CASE WHEN PROVIDER_ID_EXT IN ('07020368','23876239') THEN PROVIDER_ID_EXT ELSE 'PCMP' END PROVIDER_ORG_CD
, CASE WHEN PROVIDER_ID_EXT IN ('07020368','23876239') THEN PCMP_NAME ELSE 'Individual PCMP' END PROVIDER_ORG_LABEL
, PROVIDER_ID_EXT PROVIDER_CODE
, PX.NPI_ID_EXT PROVIDER_NUMBER
, PX.PROV_TYP_CD PROVIDER_TYPE_CODE
, PX.PROV_TYP_DESC
, PX.DTE_EFFECTIVE EFFECTIVE_DATE
, PX.DTE_END END_DATE
, PX.PCMP_NAME
, PX.PCMP_SVC_NAME
, PX.svc_phn_nbr
FROM 
&schema_name..PROVIDER_ID_XWALK PX
WHERE (PX.DTE_END IS NULL OR PX.DTE_EFFECTIVE < PX.DTE_END)
;
            
  GRANT SELECT ON MAXDAT_SUPPORT.EMRS_D_COEB_PROVIDER_SV TO MAXDAT_REPORTS; 
