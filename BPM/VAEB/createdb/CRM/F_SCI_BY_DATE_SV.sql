CREATE OR REPLACE VIEW F_SCI_BY_DATE_SV
AS
  select cr.CALL_RECORD_ID AS CONTACT_RECORD_ID,
    d.d_date, 
    cr.CREATE_TS AS CREATE_DT,
    cr.CALL_END_TS AS COMPLETE_DT,
    cr.CALL_START_TS AS CONTACT_START_DT ,
    cr.CALL_END_TS AS CONTACT_END_DT ,
    cr.CALL_TYPE_CD AS SUPP_CONTACT_TYPE_CD,
    clt.REPORT_LABEL AS CONTACT_TYPE,
    cr.LANGUAGE_CD AS LANGUAGE_CD, 
    l.DESCRIPTION as LANGUAGE, 
    ROUND((cr.CALL_END_TS-cr.CALL_START_TS)*24*60*60) AS HANDLE_TIME  
  FROM MAXDAT_SUPPORT.D_DATES D
  JOIN eb.call_record cr ON (D.D_DATE BETWEEN TRUNC(cr.CREATE_TS) AND COALESCE(TRUNC(cr.CALL_END_TS),TRUNC(sysdate)))
  LEFT JOIN eb.enum_call_type clt ON (clt.value = cr.call_type_cd)
  LEFT JOIN eb.enum_language l ON (l.value = cr.language_cd);
  
  GRANT SELECT ON MAXDAT_SUPPORT.F_SCI_BY_DATE_SV TO MAXDAT_REPORTS ;
  