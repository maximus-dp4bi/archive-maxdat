CREATE OR REPLACE VIEW MAXDAT.HCO_F_VOICEMAILS_BY_HOUR_TYPE_BY_DAY_SV AS 
SELECT
  COALESCE(v.VM_ID, cv.D_DATE_ID) AS VM_ID
, COALESCE(v.D_DATE, cv.D_DATE) AS D_DATE
, 1 AS HOUR_TYPE_ID
, 'Business Hours 8AM-4PM' AS HOUR_TYPE_DESC
, COALESCE(v.CREATED_BY, 'UNKNOWN') AS CREATED_BY
, COALESCE(v.DATE_CREATED, cv.D_DATE) AS DATE_CREATED
, COALESCE(v.DATE_UPDATED, cv.D_DATE) AS DATE_UPDATED
, COALESCE(v.UPDATED_BY, 'UNKNOWN') AS UPDATED_BY
, COALESCE(v.VOICEMAILS_SAME_DAY_RECEIVED, 0) AS VOICEMAILS_RECEIVED
, COALESCE(v.VOICEMAILS_SAME_DAY_RETURNED_WITHIN_SLA, 0) AS VOICEMAILS_RETURNED_WITHIN_SLA
, COALESCE(v.VOICEMAILS_SAME_DAY_RETURNED_BEYOND_SLA, 0) AS VOICEMAILS_RETURNED_BEYOND_SLA
, COALESCE(cv.VOICEMAILS_REFERRED, 0) AS VOICEMAILS_REFERRED
FROM   MAXDAT.HCO_F_VOICEMAILS_BY_DAY_SV v
FULL OUTER JOIN MAXDAT.HCO_F_VM_BY_HR_TYPE_BY_DAY_SV cv ON (v.D_DATE = cv.D_DATE AND cv.HOUR_TYPE_ID = 1)
UNION ALL
SELECT
  COALESCE(v.VM_ID, cv.D_DATE_ID) AS VM_ID
, COALESCE(v.D_DATE, cv.D_DATE) AS D_DATE
, 2 AS HOUR_TYPE_ID
, 'Business Hours 4PM-6PM' AS HOUR_TYPE_DESC
, COALESCE(v.CREATED_BY, 'UNKNOWN') AS CREATED_BY
, COALESCE(v.DATE_CREATED, cv.D_DATE) AS DATE_CREATED
, COALESCE(v.DATE_UPDATED, cv.D_DATE) AS DATE_UPDATED
, COALESCE(v.UPDATED_BY, 'UNKNOWN') AS UPDATED_BY
, COALESCE(v.VOICEMAILS_NEXT_DAY_RECEIVED, 0) AS VOICEMAILS_RECEIVED
, COALESCE(v.VOICEMAILS_NEXT_DAY_RETURNED_WITHIN_SLA, 0) AS VOICEMAILS_RETURNED_WITHIN_SLA
, COALESCE(v.VOICEMAILS_NEXT_DAY_RETURNED_BEYOND_SLA, 0) AS VOICEMAILS_RETURNED_BEYOND_SLA
, COALESCE(cv.VOICEMAILS_REFERRED, 0) AS VOICEMAILS_REFERRED
FROM MAXDAT.HCO_F_VOICEMAILS_BY_DAY_SV v
FULL OUTER JOIN MAXDAT.HCO_F_VM_BY_HR_TYPE_BY_DAY_SV cv ON (v.D_DATE = cv.D_DATE AND cv.HOUR_TYPE_ID = 2)
UNION ALL    --
SELECT
  COALESCE(v.VM_ID, cv.D_DATE_ID) AS VM_ID
, COALESCE(v.D_DATE, cv.D_DATE) AS D_DATE
, 3 AS HOUR_TYPE_ID
, 'Non-Business Hours' AS HOUR_TYPE_DESC
, COALESCE(v.CREATED_BY, 'UNKNOWN') AS CREATED_BY
, COALESCE(v.DATE_CREATED, cv.D_DATE) AS DATE_CREATED
, COALESCE(v.DATE_UPDATED, cv.D_DATE) AS DATE_UPDATED
, COALESCE(v.UPDATED_BY, 'UNKNOWN') AS UPDATED_BY
, COALESCE(v.VOICEMAILS_NON_BUS_RECEIVED, 0) AS VOICEMAILS_RECEIVED
, COALESCE(v.VOICEMAILS_NON_BUS_RETURNED_WITHIN_SLA, 0) AS VOICEMAILS_RETURNED_WITHIN_SLA
, COALESCE(v.VOICEMAILS_NON_BUS_RETURNED_BEYOND_SLA, 0) AS VOICEMAILS_RETURNED_BEYOND_SLA
, COALESCE(cv.VOICEMAILS_REFERRED, 0) AS VOICEMAILS_REFERRED
FROM MAXDAT.HCO_F_VOICEMAILS_BY_DAY_SV v
FULL OUTER JOIN MAXDAT.HCO_F_VM_BY_HR_TYPE_BY_DAY_SV cv ON (v.D_DATE = cv.D_DATE AND cv.HOUR_TYPE_ID = 3)
order by 2
