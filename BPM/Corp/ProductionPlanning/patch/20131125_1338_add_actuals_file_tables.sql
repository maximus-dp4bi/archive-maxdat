---- ACTUALS CONTROL FILE  
CREATE TABLE PP_CFG_ACTUALS_FILE_CONTROL
(
  CFG_ACTUALS_FILE_CONTROL_ID  NUMBER NOT NULL,
  PROJECT_ID                   NUMBER NOT NULL,
  PROGRAM_ID                   NUMBER NOT NULL,
  GEOGRAPHY_MASTER_ID          NUMBER NOT NULL,
  FILE_LOCATION                VARCHAR2(250),
  ACTUALS_FILENAME             VARCHAR2(250),
  ENABLED                      VARCHAR2(1) NOT NULL,
  CREATE_DATE                  DATE NOT NULL,
  LAST_UPDATE_DATE             DATE
);

ALTER TABLE PP_CFG_ACTUALS_FILE_CONTROL
  ADD CONSTRAINT PP_CFG_ACTUALS_FILE_CTRL_PK PRIMARY KEY (CFG_ACTUALS_FILE_CONTROL_ID);
  
ALTER TABLE PP_CFG_ACTUALS_FILE_CONTROL
  ADD CONSTRAINT PP_CFG_ACTUALS_FILE_CTRL_UN UNIQUE (PROJECT_ID,PROGRAM_ID,GEOGRAPHY_MASTER_ID);
  
-- ACTUALS FROM FILE  
CREATE TABLE MAXDAT.PP_STG_ACTUALS_IMPORT
(
  ACTUALS_DATE           DATE NOT NULL,
  ACTUALS_HOUR           NUMBER NOT NULL,
  UNIT_OF_WORK_NAME      VARCHAR2(50) NOT NULL,
  STAFF_HOURS            NUMBER,
  HANDLE_TIME_AVG        NUMBER,
  HANDLE_TIME_MIN        NUMBER,
  HANDLE_TIME_MAX        NUMBER,
  HANDLE_TIME_MEAN       NUMBER,
  HANDLE_TIME_MEDIAN     NUMBER,
  HANDLE_TIME_SD         NUMBER,
  CREATION_DATE          DATE DEFAULT SYSDATE,
  PROJECT_ID             NUMBER,
  PROGRAM_ID             NUMBER,
  GEOGRAPHY_MASTER_ID    NUMBER,
  PROCESS_DATE           DATE
);

-- ACTUALS STAGING  
CREATE TABLE PP_STG_ACTUALS
(
  SA_ID                NUMBER NOT NULL,
  ACTUALS_DATE         DATE NOT NULL,
  ACTUALS_HOUR         NUMBER NOT NULL,
  CFG_UOW_ID           NUMBER NOT NULL,
  PROJECT_ID           NUMBER NOT NULL,
  PROGRAM_ID           NUMBER NOT NULL,
  GEOGRAPHY_MASTER_ID  NUMBER NOT NULL,
  HANDLE_TIME_AVG      NUMBER,
  HANDLE_TIME_MIN      NUMBER,
  HANDLE_TIME_MAX      NUMBER,
  HANDLE_TIME_MEAN     NUMBER,
  HANDLE_TIME_MEDIAN   NUMBER,
  HANDLE_TIME_SD       NUMBER,
  STAFF_HOURS          NUMBER,
  PROCESS_DATE         DATE
);
ALTER TABLE PP_STG_ACTUALS
  ADD CONSTRAINT PP_STG_ACTUALS_PK PRIMARY KEY (SA_ID);
  
ALTER TABLE PP_STG_ACTUALS
  ADD CONSTRAINT PP_STG_ACTUALS_UN UNIQUE (ACTUALS_DATE, ACTUALS_HOUR, CFG_UOW_ID, PROJECT_ID, PROGRAM_ID, GEOGRAPHY_MASTER_ID, PROCESS_DATE); 
  
ALTER TABLE PP_STG_ACTUALS
  ADD CONSTRAINT PP_STG_ACTUALS_PP_CFG_UOW_FK FOREIGN KEY (CFG_UOW_ID)
  REFERENCES PP_CFG_UNIT_OF_WORK (CFG_UOW_ID);
  
ALTER TABLE PP_STG_ACTUALS
  ADD CHECK ( ACTUALS_HOUR BETWEEN 0 AND 23);
  
  
create sequence MAXDAT.SEQ_PP_STG_ACTUALS_ID
minvalue 1
maxvalue 999999999999999999999999999
start with 1
increment by 1
cache 20;  
  
commit;

/
  
