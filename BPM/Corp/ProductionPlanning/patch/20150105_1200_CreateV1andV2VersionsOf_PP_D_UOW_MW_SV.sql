
---MW v1 version 
CREATE OR REPLACE VIEW PP_D_UOW_MW_SV AS
SELECT USR.UOW_ID, USR.SOURCE_REF_VALUE AS TASK_TYPE
   FROM PP_D_SOURCE_REF_TYPE SRT
   INNER JOIN PP_D_SOURCE S ON SRT.SOURCE_ID = S.SOURCE_ID
   INNER JOIN PP_D_UOW_SOURCE_REF USR ON SRT.SOURCE_REF_TYPE_ID =
   USR.SOURCE_REF_TYPE_ID
   WHERE S.SOURCE_NAME = 'MANAGE WORK STG'
   AND SRT.SOURCE_REF_TYPE_NAME = 'TASK TYPE';
   
---MW v2 version
CREATE OR REPLACE VIEW PP_D_UOW_MW_V2_SV AS
SELECT USR.UOW_ID, USR.SOURCE_REF_VALUE AS TASK_TYPE, TT.TASK_TYPE_ID
   FROM PP_D_SOURCE_REF_TYPE SRT
   INNER JOIN PP_D_SOURCE S ON SRT.SOURCE_ID = S.SOURCE_ID
   INNER JOIN PP_D_UOW_SOURCE_REF USR ON SRT.SOURCE_REF_TYPE_ID = USR.SOURCE_REF_TYPE_ID
   INNER JOIN D_TASK_TYPES TT ON USR.SOURCE_REF_ID=TT.TASK_TYPE_ID
   WHERE S.SOURCE_NAME = 'MANAGE WORK STG'
   AND SRT.SOURCE_REF_TYPE_NAME = 'TASK TYPE';

create or replace public synonym PP_D_UOW_MW_V2_SV
  for MAXDAT.PP_D_UOW_MW_V2_SV;
   
GRANT SELECT ON PP_D_UOW_MW_V2_SV TO MAXDAT_READ_ONLY;

commit;

/
