CREATE TABLE PRESERVE_TBL_DATA_RLD
(
    TABLE_OWNER                         VARCHAR2(50) NOT NULL,
    TABLE_NAME                          VARCHAR2(200) NOT NULL,
    CONSTRAINT      PK_TABLE_NAME 
    PRIMARY KEY     (TABLE_OWNER, TABLE_NAME) 
    ENABLE
) 
TABLESPACE MAXDAT_DATA;

GRANT SELECT ON PRESERVE_TBL_DATA_RLD TO MAXDAT_READ_ONLY;
GRANT SELECT, INSERT, UPDATE, DELETE ON PRESERVE_TBL_DATA_RLD TO MAXDAT_OLTP_SIUD;
GRANT SELECT, INSERT, UPDATE, DELETE ON PRESERVE_TBL_DATA_RLD TO PA_IEB_OLTP_SIUD;

CREATE OR REPLACE TRIGGER TRG_BIU_PRESERVE_TBL_DATA_RLD
BEFORE INSERT OR UPDATE ON PRESERVE_TBL_DATA_RLD
FOR EACH ROW
BEGIN

    :NEW.TABLE_OWNER    :=  UPPER(TRIM(:NEW.TABLE_OWNER));
    :NEW.TABLE_NAME     :=  UPPER(TRIM(:NEW.TABLE_NAME));
    
END;
/

INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER, 'PP_D_STATE');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER, 'PP_D_UNIT_OF_WORK');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER, 'PP_D_UOW_SOURCE_REF');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER, 'PP_D_PROJECT');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER, 'BPM_PROCESS_LKUP');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER, 'BPM_PROGRAM_LKUP');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER, 'BPM_PROJECT_LKUP');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER, 'BPM_REGION_LKUP');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER, 'BPM_SOURCE_LKUP');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER, 'BPM_SOURCE_TYPE_LKUP');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER, 'BPM_UPDATE_TYPE_LKUP');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER, 'BPM_D_DATES');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER, 'PP_D_PROGRAM');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER, 'PP_D_PROVINCE');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER, 'PP_D_REGION');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER, 'PP_D_SEGMENT');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER, 'PP_D_SITE');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER, 'PP_D_SOURCE');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER, 'PP_D_SOURCE_REF_TYPE');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER, 'PBQJ_ADJUST_REASON_LKUP');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER, 'PROCESS_BPM_QUEUE_JOB_CTRL_CFG');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'PROCESS_BPM_QUEUE_JOB_CONFIG');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'PROCESS_BPM_CALC_JOB_CONFIG');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'MAXDAT_ADMIN_AUDIT_LOGGING');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'PP_D_COUNTRY');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'PP_D_DATES');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'PP_D_DISTRICT');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'PP_D_GEOGRAPHY_MASTER');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'PP_D_HOURS');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'PP_D_PRODUCTION_PLAN');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'BPM_DATATYPE_LKUP');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'BPM_D_HOURS');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'BPM_D_OPS_GROUP_TASK');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'BPM_EVENT_MASTER');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'BPM_IDENTIFIER_TYPE_LKUP');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'D_TASK_TYPES');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'D_TEAMS');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'D_BPM_PROCESS');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'D_BPM_PROCESS_SEGMENT');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'D_BPM_TASK_TYPE_ENTITY');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'D_BPM_FLOW');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'PP_CFG_FORECAST_FILE_CONTROL');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'PP_CFG_GEOGRAPHY_CONFIG');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'PP_CFG_PRODUCTION_PLAN');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'PP_CFG_PROJECT_CONFIG');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'PP_CFG_PROGRAM_CONFIG');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'PP_CFG_SOURCE_CONFIG');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'PP_CFG_UNIT_OF_WORK');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'PP_CFG_ACTUALS_FILE_CONTROL');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'CORP_ETL_CONTROL');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'CORP_ETL_LIST_LKUP');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'CORP_ETL_LIST_LKUP_HIST');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'HOLIDAYS');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'BPM_ACTIVITY_EVENT_TYPE_LKUP');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'BPM_ACTIVITY_TYPE_LKUP');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'BPM_DATA_MODEL');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'D_MW_TASK_TYPE');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'D_BPM_ENTITY');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'D_BPM_ENTITY_TYPE');
INSERT INTO PRESERVE_TBL_DATA_RLD (TABLE_OWNER, TABLE_NAME) VALUES (USER,  'PRESERVE_TBL_DATA_RLD');

