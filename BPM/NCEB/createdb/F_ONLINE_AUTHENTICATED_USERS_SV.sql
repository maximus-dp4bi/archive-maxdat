CREATE OR REPLACE VIEW F_ONLINE_AUTHENTICATED_USERS_SV
AS
select
D.D_DATE RECORD_DATE
,TRUNC(D.D_DATE,'MM') RECORD_MONTH
,CASE_ID
,upper(SUBSTR(REGEXP_SUBSTR(COMMENTS,'[:^][^]]+'),3)) AS USER_FULL_NAME
,count(DISTINCT e.event_id) TOTAL_DAILY_COUNT
, 1 UNIQUE_DAILY_COUNT
FROM EB.EVENT E
RIGHT OUTER JOIN MAXDAT_SUPPORT.BPM_D_DATES D ON (E.EFFECTIVE_DATE=D.D_DATE)
WHERE EVENT_TYPE_CD = 'LOGGED_IN_PORTAL'
and e.effective_date >= GREATEST(TO_DATE('&schemadatelimit','MM/DD/YYYY'), ADD_MONTHS(TRUNC(SYSDATE), -13)) 
--and e.case_id in (2492745, 4356270)
GROUP BY
D.D_DATE
,TRUNC(D.D_DATE,'MM')
,CASE_ID
,upper(SUBSTR(REGEXP_SUBSTR(COMMENTS,'[:^][^]]+'),3))
;

GRANT SELECT ON MAXDAT_SUPPORT.F_ONLINE_AUTHENTICATED_USERS_SV TO MAXDAT_REPORTS ;
GRANT SELECT ON MAXDAT_SUPPORT.F_ONLINE_AUTHENTICATED_USERS_SV TO MAXDATSUPPORT_READ_ONLY;