CREATE OR REPLACE TRIGGER BIU_S_CRS_IMR
    BEFORE INSERT OR UPDATE ON S_CRS_IMR 
    FOR EACH ROW 
    ENABLE 
BEGIN
IF INSERTING AND :NEW.SCI_ID IS NULL THEN 
          SELECT SEQ_SCI_ID.NEXTVAL INTO :NEW.SCI_ID FROM DUAL;
END IF;
IF INSERTING THEN 
          :NEW.CREATE_DT := SYSDATE;
          :NEW.CREATED_BY:= USER;
END IF;
:NEW.LAST_UPDATE_DT := SYSDATE;
:NEW.LAST_UPDATED_BY := USER;
END; 
/

--Create triggers for dimension tables

CREATE OR REPLACE TRIGGER BI_D_CRS_CLOSED_REASONS
    BEFORE INSERT ON D_CRS_CLOSED_REASONS
    FOR EACH ROW 
    ENABLE 
BEGIN
IF INSERTING AND :NEW.DCCR_ID IS NULL THEN 
          SELECT SEQ_DCCR_ID.NEXTVAL INTO :NEW.DCCR_ID FROM DUAL;      
END IF;
IF INSERTING THEN
  :NEW.CREATE_DT := SYSDATE;
END IF;
:NEW.UPDATE_DT := SYSDATE;
END;  
/

CREATE OR REPLACE TRIGGER BI_D_CRS_CLAIM_PRIORITIES
    BEFORE INSERT ON D_CRS_CLAIM_PRIORITIES
    FOR EACH ROW 
    ENABLE 
BEGIN
IF INSERTING AND :NEW.DCCP_ID IS NULL THEN 
          SELECT SEQ_DCCP_ID.NEXTVAL INTO :NEW.DCCP_ID FROM DUAL;      
END IF;
IF INSERTING THEN
  :NEW.CREATE_DT := SYSDATE;
END IF;
:NEW.UPDATE_DT := SYSDATE;
END;  
/

CREATE OR REPLACE TRIGGER BI_D_CRS_STATES
    BEFORE INSERT ON D_CRS_STATES
    FOR EACH ROW 
    ENABLE 
BEGIN
IF INSERTING AND :NEW.DCS_ID IS NULL THEN 
          SELECT SEQ_DCS_ID.NEXTVAL INTO :NEW.DCS_ID FROM DUAL;      
END IF;
IF INSERTING THEN
  :NEW.CREATE_DT := SYSDATE;
END IF;
:NEW.UPDATE_DT := SYSDATE;
END;  
/

CREATE OR REPLACE TRIGGER BI_D_CRS_EDI_CONTRIBUTORS
    BEFORE INSERT ON D_CRS_EDI_CONTRIBUTORS
    FOR EACH ROW 
    ENABLE 
BEGIN
IF INSERTING AND :NEW.DCEC_ID IS NULL THEN 
          SELECT SEQ_DCEC_ID.NEXTVAL INTO :NEW.DCEC_ID FROM DUAL;      
END IF;
IF INSERTING THEN
  :NEW.CREATE_DT := SYSDATE;
END IF;
:NEW.UPDATE_DT := SYSDATE;
END;  
/

CREATE OR REPLACE TRIGGER BI_D_CRS_TERMINATION_REASONS
    BEFORE INSERT ON D_CRS_TERMINATION_REASONS
    FOR EACH ROW 
    ENABLE 
BEGIN
IF INSERTING AND :NEW.DCTR_ID IS NULL THEN 
          SELECT SEQ_DCTR_ID.NEXTVAL INTO :NEW.DCTR_ID FROM DUAL;      
END IF;
IF INSERTING THEN
  :NEW.CREATE_DT := SYSDATE;
END IF;
:NEW.UPDATE_DT := SYSDATE;
END;  
/
