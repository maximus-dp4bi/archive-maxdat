alter session set plsql_code_type = native;

CREATE OR REPLACE PACKAGE fedqic_etl_appeal_pkg IS
/*
|| CA DIR Project
||    This source code is the intellectual property of MAXIMUS.
||    Copyright(c) 2007 MAXIMUS, Inc. All rights reserved.
|| Scope   : This package contains procedures to populate the new appeal instance table
||             It will build a tmp table to do bulk updates/inserts to the appeal instancetable.
|| Written : Eric Burke
|| Date    : July 5, 2019
|| Revisions ---------------------------------------------------------------------

*/

-- Do not edit these four SVN_* variable values.  They are populated when you commit code
--    to SVN and used later to identify deployed code.
   SVN_FILE_URL varchar2(200) := '$URL: svn://svn-staging.maximus.com/dev1d/maxdat/BPM/FEDQIC/createdb/fedqic_etl_appeal_pkg.sql $';
  	SVN_REVISION varchar2(20) := '$Revision: 23262 $';
   SVN_REVISION_DATE varchar2(60) := '$Date: 2018-05-10 17:55:01 -0400 (Thu, 10 May 2018) $';
  	SVN_REVISION_AUTHOR varchar2(20) := '$Author: fm18957 $';

/*
||  Procedures
*/
   PROCEDURE InitProcess;   --<< Resets from last run

   PROCEDURE Insert_New_Appeals;         --<< Inserts new records into corp_etl_appeal_wip

   PROCEDURE Update_Appeals;         --<< updates records in corp_etl_appeal_wip

   PROCEDURE APPEAL_UPDATE_MAIN_TABLE;   --<< updates corp_etl_appeal from corp_etl_appeal_wip records	

/*
|| Functions
*/

   FUNCTION Get_Person_ID
            (p_user_id in number)
     RETURN number parallel_enable;


END fedqic_etl_appeal_pkg;
/

CREATE OR REPLACE PACKAGE BODY fedqic_etl_appeal_pkg IS
   g_Error   VARCHAR2(4000);
   g_Limit   NUMBER;
   gPKG VARCHAR2(30) := 'fedqic_ETL_APPEAL_PKG';


FUNCTION Get_Person_ID
         (p_user_id in number)
RETURN Number parallel_enable
AS
     v_parameter_value number := null;
BEGIN

    IF p_user_id IS NULL OR p_user_id = 0 THEN
       v_parameter_value := 0;
    ELSE

         Select P.Person_ID
           Into v_parameter_value
           From fedqic_user_stg U
           Left Outer Join fedqic_person_stg P ON U.person_id = P.person_id
          Where U.user_id = p_user_id ;

    END IF;

    if v_parameter_value is null then
	v_parameter_value := -1;
    END IF;
    

    RETURN v_parameter_value;

EXCEPTION
  WHEN OTHERS THEN
     RETURN -1;
END;



PROCEDURE InitProcess
IS
v_role_id number;
BEGIN
   -- Remove any old records from tmp table
   DELETE FROM corp_etl_appeal_wip;
   COMMIT;

   --populate tmp table with records from corp_etl_appeal

      INSERT INTO corp_etl_appeal_wip 
      SELECT 
  CEAP_ID
, APPEAL_ID
, CREATE_DATE
, COMPLETE_DATE
, CANCELLED_DATE
, ADJUDICATOR  
, DEADLINE_DATE 
, APPEAL_ISSUE
, APPEAL_ITEM  
, APPEAL_NUMBER 
, APPEAL_PRIORITY_ID
, REQUEST_RECEIVED  
, APPEAL_STAGE  
, APPEAL_STATUS 
, APPEAL_TYPE
, APPEAL_DISMISSAL
, APPEAL_DISMISSAL_REASON
, AUTO_FORWARD
, CASE_FILE_REQUEST_DATE 
, ACKNOWLEDGEMENT_LETTER_DATE 
, DECISION_MAILED_DATE 
, DECISION_SENT_PLAN_DATE 
, MEDICAL_REVIEW_CHECK 
, APPEAL_PART_ID 
, APPEAL_REASON 
, APPEAL_TOLLING_DATE
, APPEAL_NOTICE_DATE
, CASE_FILE_RECEIVED_DATE  
, CLAIMED_DATE
, DECISION
, DECISION_NOTIFICATION_METHOD
, HPMS
, HPMS_REQUESTED_DATE
, IS_REQUEST_FOR_INFORMATION_P
, MAC
, MEDICARE_TYPE
, MSP
, NEW_DOCUMENTATION_REVIEWED
, PHYSICIAN_SPECIALTY
, PRECHECK_COMPLETED
, WITHDRAWAL
, WITHDRAWAL_REQUEST_SUBMITTED
, NON_ENGLISH
, NON_ENGLISH_OTHER
, DISPOSITION
, DISPOSITION_EXPLANATION
, PROCEDURAL_DECISION_REASON
, SUBSTANTIVE_REASON
, FIRST_REVIEW_CASE_ATTESTATIO
, FIRST_MEDICAL_REVIEW_DECISIO
, FIRST_REVIEWER
, THIRD_MEDICAL_REVIEW_DECISIO
, THIRD_REVIEW_CASE_ATTESTATIO
, THIRD_REVIEWER
, EXPERT_REVIEW_CASE_ATTESTATI
, EXPERT_REVIEWER_MD_ID
, STG_EXTRACT_DATE
, STG_LAST_UPDATE_DATE
, 'N' as change_flag
, REASON_FOR_APPEAL
, EXPERT_REVIEW_CITATION
, CLOSED_DATE
, WITHDRAWN_DATE

, DEMO_REOPENING_TYPE
, OTHER_REOPENING_TYPE
, CASE_CURRENTLY_WITH_ALJ
, DATE_OF_REQUEST_TO_ALJ
, DEMO_REOPENING_DUE_DATE
, DEMO_REO_SENT_TO_OMHA_DATE
, OMHA_RESPONSE_RECEIVED
, RESPONSE_FROM_OMHA
, ADDITIONAL_INFO_REQUESTED
, REQUESTED_INFORMATION_DUE
, DEMO_REOPEN_FOLLOW_UP
, ADDITIONAL_INFO_RECEIVED
, REOPENING_DECISION_RESULTS
, NOT_REOPENED_REASON

, OMHA_REMAND_REQUEST
, REMAND_ELIGIBILITY_RESPONSE
, REMAND_RECEIVED_DATE	
, OMHA_REMAND_REQUEST_RESPONSE
, OMHA_WITHDRAW_FORM_SENT
, OMHA_WITHDRAW_FORM_RETURNED
, OMHA_NOTIFIED_OF_WITHDRAWL
, ALJ_WITHDRAWAL		
, DEMO_REOPENING_APPEAL_NUMBER
, REOPENING_ANALYSIS_COMPLETED
, REOPENING_ANALYSIS_OUTCOME
, NOT_PURSUED_BY_CONTR_REASON
, ACK_LETTER_MAILED
, REO_DECISION_LETTER_MAILED
, REOPENING_OUTCOME
, DECLINE_TO_REOPEN_DECISION
, APPEAL_ATTESTATION_DATE
, APPEAL_ATTESTATION
, DEMO_SCHEDULED
, DEMO_NOTIFICATION_LETTER_SENT
, RESPONSE_DUE	
, RESPONSE_RECEIVED
, DEMO_ACCEPTANCE_STATUS
, TELE_DEMO_FOLLOW_UP
, DEMO_NOTIFICATION_LTR_RESENT
, RESCHEDULED_RESPONSE_DUE
, RESCHEDULE_RESPONSE_RECEIVED
, VERBAL_CONFIRMATION
, RESCHEDULED_DEMO_STATUS
, PROVIDER_OR_SUPPLIER_NAME	
, DEMO_CONFERENCE_STATUS
, REVIEW_TYPE		
, EXPERT_REVIEW_DECISION		
, REVIEW_NUMBER	

      FROM corp_etl_appeal
      WHERE closed_date is null;
      
      commit;

EXCEPTION
   WHEN OTHERS THEN
      ROLLBACK;
      g_Error := SQLERRM ;
      INSERT INTO corp_etl_error_log (process_name, job_name, error_desc) VALUES ('INIT', 'fedqic Appeal', g_Error);
      COMMIT;
      RAISE;
END InitProcess;

/*
|| Procedure to insert into/update corp_etl_appeal
||   
*/

PROCEDURE Insert_New_Appeals
IS

BEGIN

--insert new record into appeal_wip

INSERT INTO corp_etl_appeal_wip (
APPEAL_ID
, CREATE_DATE
, COMPLETE_DATE
, CANCELLED_DATE
, ADJUDICATOR  
, DEADLINE_DATE 
, APPEAL_ISSUE
, APPEAL_ITEM  
, APPEAL_NUMBER 
, APPEAL_PRIORITY_ID
, REQUEST_RECEIVED  
, APPEAL_STAGE  
, APPEAL_STATUS 
, APPEAL_TYPE
, APPEAL_DISMISSAL
, APPEAL_DISMISSAL_REASON
, AUTO_FORWARD
, CASE_FILE_REQUEST_DATE 
, ACKNOWLEDGEMENT_LETTER_DATE 
, DECISION_MAILED_DATE 
, DECISION_SENT_PLAN_DATE 
, MEDICAL_REVIEW_CHECK 
, APPEAL_PART_ID 
, APPEAL_REASON 
, APPEAL_TOLLING_DATE
, APPEAL_NOTICE_DATE
, CASE_FILE_RECEIVED_DATE  
, CLAIMED_DATE
, DECISION
, DECISION_NOTIFICATION_METHOD
, HPMS
, HPMS_REQUESTED_DATE
, IS_REQUEST_FOR_INFORMATION_P
, MAC
, MEDICARE_TYPE
, MSP
, NEW_DOCUMENTATION_REVIEWED
, PHYSICIAN_SPECIALTY
, PRECHECK_COMPLETED
, REASON_FOR_APPEAL
, WITHDRAWAL
, WITHDRAWAL_REQUEST_SUBMITTED
, NON_ENGLISH
, NON_ENGLISH_OTHER
, DISPOSITION
, DISPOSITION_EXPLANATION
, PROCEDURAL_DECISION_REASON
, SUBSTANTIVE_REASON
, FIRST_REVIEW_CASE_ATTESTATIO
, FIRST_MEDICAL_REVIEW_DECISIO
, FIRST_REVIEWER
, THIRD_MEDICAL_REVIEW_DECISIO
, THIRD_REVIEW_CASE_ATTESTATIO
, THIRD_REVIEWER
, EXPERT_REVIEW_CASE_ATTESTATI
, EXPERT_REVIEW_CITATION
, EXPERT_REVIEWER_MD_ID
, STG_EXTRACT_DATE
, STG_LAST_UPDATE_DATE
, change_flag
, CLOSED_DATE
, WITHDRAWN_DATE

, DEMO_REOPENING_TYPE
, OTHER_REOPENING_TYPE
, CASE_CURRENTLY_WITH_ALJ
, DATE_OF_REQUEST_TO_ALJ
, DEMO_REOPENING_DUE_DATE
, DEMO_REO_SENT_TO_OMHA_DATE
, OMHA_RESPONSE_RECEIVED
, RESPONSE_FROM_OMHA
, ADDITIONAL_INFO_REQUESTED
, REQUESTED_INFORMATION_DUE
, DEMO_REOPEN_FOLLOW_UP
, ADDITIONAL_INFO_RECEIVED
, REOPENING_DECISION_RESULTS
, NOT_REOPENED_REASON

, OMHA_REMAND_REQUEST
, REMAND_ELIGIBILITY_RESPONSE
, REMAND_RECEIVED_DATE	
, OMHA_REMAND_REQUEST_RESPONSE
, OMHA_WITHDRAW_FORM_SENT
, OMHA_WITHDRAW_FORM_RETURNED
, OMHA_NOTIFIED_OF_WITHDRAWL
, ALJ_WITHDRAWAL		
, DEMO_REOPENING_APPEAL_NUMBER
, REOPENING_ANALYSIS_COMPLETED
, REOPENING_ANALYSIS_OUTCOME
, NOT_PURSUED_BY_CONTR_REASON
, ACK_LETTER_MAILED
, REO_DECISION_LETTER_MAILED
, REOPENING_OUTCOME
, DECLINE_TO_REOPEN_DECISION
, APPEAL_ATTESTATION_DATE
, APPEAL_ATTESTATION
, DEMO_SCHEDULED
, DEMO_NOTIFICATION_LETTER_SENT
, RESPONSE_DUE	
, RESPONSE_RECEIVED
, DEMO_ACCEPTANCE_STATUS
, TELE_DEMO_FOLLOW_UP
, DEMO_NOTIFICATION_LTR_RESENT
, RESCHEDULED_RESPONSE_DUE
, RESCHEDULE_RESPONSE_RECEIVED
, VERBAL_CONFIRMATION
, RESCHEDULED_DEMO_STATUS
, PROVIDER_OR_SUPPLIER_NAME	
, DEMO_CONFERENCE_STATUS
, REVIEW_TYPE		
, EXPERT_REVIEW_DECISION		
, REVIEW_NUMBER	


     )
      SELECT 
  fas.ID
, fas.CREATE_DATE
, fas.COMPLETE_DATE
, null CANCELLED_DATE 
, Get_Person_ID(fas.C_ADJUDICATOR)  
, fas.C_APPEAL_DEADLINE_DATE 
, fas.C_APPEAL_ISSUE
, fas.C_ITEM_SERVICE  
, fas.C_APPEAL_NUMBER 
, fas.C_APPEAL_PRIORITY
, fas.C_APPEAL_REQUEST_RECEIVED_DATE  
, fas.C_APPEAL_STAGE
, fas.C_APPEAL_STATUS 
, fas.C_APPEAL_TYPE
, fas.C_APPELLANT_DISMISSAL 
, fas.C_APPELLANT_DISMISSAL_REASON
, fas.C_AUTO_FORWARD
, fas.C_CASE_FILE_REQUEST_DATE 
, fas.C_DATE_ACKNOWLEDGEMENT_LETTER_ 
, fas.C_DECISION_LETTER_MAILED_DATE 
, fas.C_DECISION_SENT_TO_PLAN_DATE 
, fas.C_MEDICAL_REVIEW_CHECK 
, fas.C_PART
, fas.C_APPEAL_REASON 
, fas.C_TOLLING_DATE
, fas.C_VERBAL_NOTICE 
, fas.C_CASE_FILE_RECEIVED_DATE 
, fas.C_CLAIMED_DATE
, fas.C_DECISION
, fas.C_DECISION_NOTIFICATION_METHOD
, fas.C_HPMS
, fas.C_HPMS_REQUESTED_DATE
, fas.C_IS_REQUEST_FOR_INFORMATION_P
, fas.C_MAC
, fas.C_MEDICARE_TYPE
, fas.C_MSP
, fas.C_NEW_DOCUMENTATION_REVIEWED
, fas.C_PHYSICIAN_SPECIALTY
, fas.C_PRECHECK_COMPLETED
, fas.C_REASON_FOR_APPEAL
, fas.C_WITHDRAWAL
, fas.C_WITHDRAWAL_REQUEST_SUBMITTED
, fas.C_NON_ENGLISH
, fas.C_NON_ENGLISH_OTHER
, fas.C_DISPOSITION
, fas.C_DISPOSITION_EXPLANATION
, fas.C_PROCEDURAL_DECISION_REASON
, fas.C_SUBSTANTIVE_REASON
, fas.C_FIRST_REVIEW_CASE_ATTESTATIO
, fas.C_FIRST_MEDICAL_REVIEW_DECISIO
, Get_Person_ID (fas.C_FIRST_REVIEWER)
, fas.C_THIRD_MEDICAL_REVIEW_DECISIO
, fas.C_THIRD_REVIEW_CASE_ATTESTATIO
, Get_Person_ID (fas.C_THIRD_REVIEWER)
, fas.C_EXPERT_REVIEW_CASE_ATTESTATI
, fas.C_EXPERT_REVIEW_CITATION
, Get_Person_ID (fas.C_EXPERT_REVIEWER_MD_ID)
, sysdate --STG_EXTRACT_DATE
, sysdate --STG_LAST_UPDATE_DATE
, 'I' --change_flag
, case when (fas.c_withdrawal is null or fas.c_withdrawal = 0) then fas.t_maxdat_closed_date else null end CLOSED_DATE
, case when (fas.c_withdrawal is not null and fas.c_withdrawal = 1) then fas.t_maxdat_closed_date else null end WITHDRAWN_DATE

, fas.C_DEMO_REOPENING_TYPE
, fas.C_OTHER_REOPENING_TYPE
, fas.C_CASE_CURRENTLY_WITH_ALJ
, fas.C_DATE_OF_REQUEST_TO_ALJ
, fas.C_DEMO_REOPENING_DUE_DATE	
, fas.C_DEMO_REO_SENT_TO_OMHA_DATE
, fas.C_OMHA_RESPONSE_RECEIVED	
, fas.C_RESPONSE_FROM_OMHA
, fas.C_ADDITIONAL_INFO_REQUESTED
, fas.C_REQUESTED_INFORMATION_DUE
, fas.C_DEMO_REOPEN_FOLLOW_UP
, fas.C_ADDITIONAL_INFO_RECEIVED
, fas.C_REOPENING_DECISION_RESULTS
, fas.C_NOT_REOPENED_REASON

, fas.C_OMHA_REMAND_REQUEST
, fas.C_REMAND_ELIGIBILITY_RESPONSE
, fas.C_REMAND_RECEIVED_DATE
, fas.C_OMHA_REMAND_REQUEST_RESPONSE
, fas.C_OMHA_WITHDRAW_FORM_SENT	
, fas.C_OMHA_WITHDRAW_FORM_RETURNED
, fas.C_OMHA_NOTIFIED_OF_WITHDRAWL
, fas.C_ALJ_WITHDRAWAL		
, fas.C_DEMO_REOPENING_APPEAL_NUMBER
, fas.C_REOPENING_ANALYSIS_COMPLETED
, fas.C_REOPENING_ANALYSIS_OUTCOME
, fas.C_NOT_PURSUED_BY_CONTR_REASON
, fas.C_ACK_LETTER_MAILED		
, fas.C_REO_DECISION_LETTER_MAILED
, fas.C_REOPENING_OUTCOME	
, fas.C_DECLINE_TO_REOPEN_DECISION	
, fas.C_APPEAL_ATTESTATION_DATE		
, fas.C_APPEAL_ATTESTATION	
, fas.C_DEMO_SCHEDULED		
, fas.C_DEMO_NOTIFICATION_LETTER_SENT	
, fas.C_RESPONSE_DUE	
, fas.C_RESPONSE_RECEIVED
, fas.C_DEMO_ACCEPTANCE_STATUS
, fas.C_TELE_DEMO_FOLLOW_UP
, fas.C_DEMO_NOTIFICATION_LTR_RESENT
, fas.C_RESCHEDULED_RESPONSE_DUE
, fas.C_RESCHEDULE_RESPONSE_RECEIVED
, fas.C_VERBAL_CONFIRMATION	
, fas.C_RESCHEDULED_DEMO_STATUS	
, fas.C_PROVIDER_OR_SUPPLIER_NAME	
, fas.C_DEMO_CONFERENCE_STATUS	
, fas.C_REVIEW_TYPE	
, fas.C_EXPERT_REVIEW_DECISION			
, fas.C_REVIEW_NUMBER	

      from fedqic_appeal_stg fas      
      where not exists (select 1 from corp_etl_appeal cap where cap.appeal_id = fas.id);


--insert record from wip into etl_appeal table	
INSERT INTO corp_etl_appeal
SELECT
CEAP_ID 
, APPEAL_ID
, CREATE_DATE
, COMPLETE_DATE
, CANCELLED_DATE
, ADJUDICATOR  
, DEADLINE_DATE 
, APPEAL_ISSUE
, APPEAL_ITEM  
, APPEAL_NUMBER 
, APPEAL_PRIORITY_ID
, REQUEST_RECEIVED  
, APPEAL_STAGE  
, APPEAL_STATUS 
, APPEAL_TYPE
, APPEAL_DISMISSAL
, APPEAL_DISMISSAL_REASON
, AUTO_FORWARD
, CASE_FILE_REQUEST_DATE 
, ACKNOWLEDGEMENT_LETTER_DATE 
, DECISION_MAILED_DATE 
, DECISION_SENT_PLAN_DATE 
, MEDICAL_REVIEW_CHECK 
, APPEAL_PART_ID 
, APPEAL_REASON 
, APPEAL_TOLLING_DATE
, APPEAL_NOTICE_DATE
, CASE_FILE_RECEIVED_DATE  
, CLAIMED_DATE
, DECISION
, DECISION_NOTIFICATION_METHOD
, HPMS
, HPMS_REQUESTED_DATE
, IS_REQUEST_FOR_INFORMATION_P
, MAC
, MEDICARE_TYPE
, MSP
, NEW_DOCUMENTATION_REVIEWED
, PHYSICIAN_SPECIALTY
, PRECHECK_COMPLETED
, WITHDRAWAL
, WITHDRAWAL_REQUEST_SUBMITTED
, NON_ENGLISH
, NON_ENGLISH_OTHER
, DISPOSITION
, DISPOSITION_EXPLANATION
, PROCEDURAL_DECISION_REASON
, SUBSTANTIVE_REASON
, FIRST_REVIEW_CASE_ATTESTATIO
, FIRST_MEDICAL_REVIEW_DECISIO
, FIRST_REVIEWER
, THIRD_MEDICAL_REVIEW_DECISIO
, THIRD_REVIEW_CASE_ATTESTATIO
, THIRD_REVIEWER
, EXPERT_REVIEW_CASE_ATTESTATI
, EXPERT_REVIEWER_MD_ID
, STG_EXTRACT_DATE
, STG_LAST_UPDATE_DATE
, REASON_FOR_APPEAL
, EXPERT_REVIEW_CITATION
, CLOSED_DATE
, WITHDRAWN_DATE

, DEMO_REOPENING_TYPE
, OTHER_REOPENING_TYPE
, CASE_CURRENTLY_WITH_ALJ
, DATE_OF_REQUEST_TO_ALJ
, DEMO_REOPENING_DUE_DATE
, DEMO_REO_SENT_TO_OMHA_DATE
, OMHA_RESPONSE_RECEIVED
, RESPONSE_FROM_OMHA
, ADDITIONAL_INFO_REQUESTED
, REQUESTED_INFORMATION_DUE
, DEMO_REOPEN_FOLLOW_UP
, ADDITIONAL_INFO_RECEIVED
, REOPENING_DECISION_RESULTS
, NOT_REOPENED_REASON

, OMHA_REMAND_REQUEST
, REMAND_ELIGIBILITY_RESPONSE
, REMAND_RECEIVED_DATE	
, OMHA_REMAND_REQUEST_RESPONSE
, OMHA_WITHDRAW_FORM_SENT
, OMHA_WITHDRAW_FORM_RETURNED
, OMHA_NOTIFIED_OF_WITHDRAWL
, ALJ_WITHDRAWAL		
, DEMO_REOPENING_APPEAL_NUMBER
, REOPENING_ANALYSIS_COMPLETED
, REOPENING_ANALYSIS_OUTCOME
, NOT_PURSUED_BY_CONTR_REASON
, ACK_LETTER_MAILED
, REO_DECISION_LETTER_MAILED
, REOPENING_OUTCOME
, DECLINE_TO_REOPEN_DECISION
, APPEAL_ATTESTATION_DATE
, APPEAL_ATTESTATION
, DEMO_SCHEDULED
, DEMO_NOTIFICATION_LETTER_SENT
, RESPONSE_DUE	
, RESPONSE_RECEIVED
, DEMO_ACCEPTANCE_STATUS
, TELE_DEMO_FOLLOW_UP
, DEMO_NOTIFICATION_LTR_RESENT
, RESCHEDULED_RESPONSE_DUE
, RESCHEDULE_RESPONSE_RECEIVED
, VERBAL_CONFIRMATION
, RESCHEDULED_DEMO_STATUS
, PROVIDER_OR_SUPPLIER_NAME	
, DEMO_CONFERENCE_STATUS
, REVIEW_TYPE		
, EXPERT_REVIEW_DECISION		
, REVIEW_NUMBER	
        FROM corp_etl_appeal_wip awip WHERE awip.change_flag = 'I';

     COMMIT;      

EXCEPTION
  WHEN OTHERS THEN
    ROLLBACK;
      g_Error := SQLERRM ;
      INSERT INTO corp_etl_error_log (process_name, job_name, error_desc) VALUES ('Insert_New_Task', 'ETL APPEAL', g_Error);
      COMMIT;
      RAISE;

END Insert_New_Appeals;

PROCEDURE Update_Appeals
IS

BEGIN
       

UPDATE 
(SELECT 
fas.CREATE_DATE AS FAS_CREATE_DATE
,fas.COMPLETE_DATE AS FAS_COMPLETE_DATE
--,fas.CANCELLED_DATE AS FAS_CANCELLED_DATE
,Get_Person_ID (fas.C_ADJUDICATOR) AS FAS_ADJUDICATOR
,fas.C_APPEAL_DEADLINE_DATE AS FAS_DEADLINE_DATE
,fas.C_APPEAL_ISSUE AS FAS_APPEAL_ISSUE
,fas.C_ITEM_SERVICE AS FAS_APPEAL_ITEM
,fas.C_APPEAL_NUMBER AS FAS_APPEAL_NUMBER
,fas.C_APPEAL_PRIORITY AS FAS_APPEAL_PRIORITY_ID
,fas.C_APPEAL_REQUEST_RECEIVED_DATE AS FAS_REQUEST_RECEIVED
,fas.C_APPEAL_STAGE AS FAS_APPEAL_STAGE
,fas.C_APPEAL_STATUS AS FAS_APPEAL_STATUS
,fas.C_APPEAL_TYPE AS FAS_APPEAL_TYPE
,fas.C_APPELLANT_DISMISSAL AS FAS_APPEAL_DISMISSAL
,fas.C_APPELLANT_DISMISSAL_REASON AS FAS_APPEAL_DISMISSAL_REASON
,fas.C_AUTO_FORWARD AS FAS_AUTO_FORWARD
,fas.C_CASE_FILE_REQUEST_DATE AS FAS_CASE_FILE_REQUEST_DATE
,fas.C_DATE_ACKNOWLEDGEMENT_LETTER_ AS FAS_ACKNOWLEDGEMENT_LETTER_DATE
,fas.C_DECISION_LETTER_MAILED_DATE AS FAS_DECISION_MAILED_DATE
,fas.C_DECISION_SENT_TO_PLAN_DATE AS FAS_DECISION_SENT_PLAN_DATE
,fas.C_MEDICAL_REVIEW_CHECK AS FAS_MEDICAL_REVIEW_CHECK
,fas.C_PART AS FAS_APPEAL_PART_ID
,fas.C_APPEAL_REASON AS FAS_APPEAL_REASON
,fas.C_TOLLING_DATE AS FAS_APPEAL_TOLLING_DATE
,fas.C_VERBAL_NOTICE AS FAS_APPEAL_NOTICE_DATE
,fas.C_CASE_FILE_RECEIVED_DATE AS FAS_CASE_FILE_RECEIVED_DATE
,fas.C_CLAIMED_DATE AS FAS_CLAIMED_DATE
,fas.C_DECISION AS FAS_DECISION
,fas.C_DECISION_NOTIFICATION_METHOD AS FAS_DECISION_NOTIFICATION_METHOD
,fas.C_HPMS AS FAS_HPMS
,fas.C_HPMS_REQUESTED_DATE AS FAS_HPMS_REQUESTED_DATE
,fas.C_IS_REQUEST_FOR_INFORMATION_P AS FAS_IS_REQUEST_FOR_INFORMATION_P
,fas.C_MAC AS FAS_MAC
,fas.C_MEDICARE_TYPE AS FAS_MEDICARE_TYPE
,fas.C_MSP AS FAS_MSP
,fas.C_NEW_DOCUMENTATION_REVIEWED AS FAS_NEW_DOCUMENTATION_REVIEWED
,fas.C_PHYSICIAN_SPECIALTY AS FAS_PHYSICIAN_SPECIALTY
,fas.C_PRECHECK_COMPLETED AS FAS_PRECHECK_COMPLETED
,fas.C_REASON_FOR_APPEAL AS FAS_REASON_FOR_APPEAL
,fas.C_WITHDRAWAL AS FAS_WITHDRAWAL
,fas.C_WITHDRAWAL_REQUEST_SUBMITTED AS FAS_WITHDRAWAL_REQUEST_SUBMITTED
,fas.C_NON_ENGLISH AS FAS_NON_ENGLISH
,fas.C_NON_ENGLISH_OTHER AS FAS_NON_ENGLISH_OTHER
,fas.C_DISPOSITION AS FAS_DISPOSITION
,fas.C_DISPOSITION_EXPLANATION AS FAS_DISPOSITION_EXPLANATION
,fas.C_PROCEDURAL_DECISION_REASON AS FAS_PROCEDURAL_DECISION_REASON
,fas.C_SUBSTANTIVE_REASON AS FAS_SUBSTANTIVE_REASON
,fas.C_FIRST_REVIEW_CASE_ATTESTATIO AS FAS_FIRST_REVIEW_CASE_ATTESTATIO
,fas.C_FIRST_MEDICAL_REVIEW_DECISIO AS FAS_FIRST_MEDICAL_REVIEW_DECISIO
,Get_Person_ID (fas.C_FIRST_REVIEWER) AS FAS_FIRST_REVIEWER
,fas.C_THIRD_MEDICAL_REVIEW_DECISIO AS FAS_THIRD_MEDICAL_REVIEW_DECISIO
,fas.C_THIRD_REVIEW_CASE_ATTESTATIO AS FAS_THIRD_REVIEW_CASE_ATTESTATIO
,Get_Person_ID (fas.C_THIRD_REVIEWER) AS FAS_THIRD_REVIEWER
,fas.C_EXPERT_REVIEW_CASE_ATTESTATI AS FAS_EXPERT_REVIEW_CASE_ATTESTATI
,fas.C_EXPERT_REVIEW_CITATION AS FAS_EXPERT_REVIEW_CITATION
,Get_Person_ID (fas.C_EXPERT_REVIEWER_MD_ID) AS FAS_EXPERT_REVIEWER_MD_ID
,fas.T_MAXDAT_CLOSED_DATE as FAS_T_MAXDAT_CLOSED_DATE
,fas.CLOSED_DATE as FAS_CLOSED_DATE
,fas.WITHDRAWN_DATE as FAS_WITHDRAWN_DATE

, fas.C_DEMO_REOPENING_TYPE as FAS_DEMO_REOPENING_TYPE
, fas.C_OTHER_REOPENING_TYPE as FAS_OTHER_REOPENING_TYPE
, fas.C_CASE_CURRENTLY_WITH_ALJ as FAS_CASE_CURRENTLY_WITH_ALJ
, fas.C_DATE_OF_REQUEST_TO_ALJ as FAS_DATE_OF_REQUEST_TO_ALJ
, fas.C_DEMO_REOPENING_DUE_DATE as FAS_DEMO_REOPENING_DUE_DATE
, fas.C_DEMO_REO_SENT_TO_OMHA_DATE as FAS_DEMO_REO_SENT_TO_OMHA_DATE
, fas.C_OMHA_RESPONSE_RECEIVED as FAS_OMHA_RESPONSE_RECEIVED
, fas.C_RESPONSE_FROM_OMHA as FAS_RESPONSE_FROM_OMHA
, fas.C_ADDITIONAL_INFO_REQUESTED as FAS_ADDITIONAL_INFO_REQUESTED 
, fas.C_REQUESTED_INFORMATION_DUE as FAS_REQUESTED_INFORMATION_DUE
, fas.C_DEMO_REOPEN_FOLLOW_UP as FAS_DEMO_REOPEN_FOLLOW_UP
, fas.C_ADDITIONAL_INFO_RECEIVED as FAS_ADDITIONAL_INFO_RECEIVED
, fas.C_REOPENING_DECISION_RESULTS as FAS_REOPENING_DECISION_RESULTS
, fas.C_NOT_REOPENED_REASON as FAS_NOT_REOPENED_REASON

, fas.C_OMHA_REMAND_REQUEST as FAS_OMHA_REMAND_REQUEST
, fas.C_REMAND_ELIGIBILITY_RESPONSE as FAS_REMAND_ELIGIBILITY_RESPONSE
, fas.C_REMAND_RECEIVED_DATE as FAS_REMAND_RECEIVED_DATE
, fas.C_OMHA_REMAND_REQUEST_RESPONSE as FAS_OMHA_REMAND_REQUEST_RESPONSE 
, fas.C_OMHA_WITHDRAW_FORM_SENT as FAS_OMHA_WITHDRAW_FORM_SENT
, fas.C_OMHA_WITHDRAW_FORM_RETURNED as FAS_OMHA_WITHDRAW_FORM_RETURNED
, fas.C_OMHA_NOTIFIED_OF_WITHDRAWL as FAS_OMHA_NOTIFIED_OF_WITHDRAWL
, fas.C_ALJ_WITHDRAWAL as FAS_ALJ_WITHDRAWAL
, fas.C_DEMO_REOPENING_APPEAL_NUMBER as FAS_DEMO_REOPENING_APPEAL_NUMBER
, fas.C_REOPENING_ANALYSIS_COMPLETED as FAS_REOPENING_ANALYSIS_COMPLETED
, fas.C_REOPENING_ANALYSIS_OUTCOME as FAS_REOPENING_ANALYSIS_OUTCOME
, fas.C_NOT_PURSUED_BY_CONTR_REASON as FAS_NOT_PURSUED_BY_CONTR_REASON
, fas.C_ACK_LETTER_MAILED as FAS_ACK_LETTER_MAILED
, fas.C_REO_DECISION_LETTER_MAILED as FAS_REO_DECISION_LETTER_MAILED
, fas.C_REOPENING_OUTCOME as FAS_REOPENING_OUTCOME
, fas.C_DECLINE_TO_REOPEN_DECISION as FAS_DECLINE_TO_REOPEN_DECISION
, fas.C_APPEAL_ATTESTATION_DATE as FAS_APPEAL_ATTESTATION_DATE
, fas.C_APPEAL_ATTESTATION as FAS_APPEAL_ATTESTATION
, fas.C_DEMO_SCHEDULED as FAS_DEMO_SCHEDULED	
, fas.C_DEMO_NOTIFICATION_LETTER_SENT as FAS_DEMO_NOTIFICATION_LETTER_SENT 
, fas.C_RESPONSE_DUE as FAS_RESPONSE_DUE	
, fas.C_RESPONSE_RECEIVED as FAS_RESPONSE_RECEIVED 	
, fas.C_DEMO_ACCEPTANCE_STATUS as FAS_DEMO_ACCEPTANCE_STATUS 	
, fas.C_TELE_DEMO_FOLLOW_UP as FAS_TELE_DEMO_FOLLOW_UP	
, fas.C_DEMO_NOTIFICATION_LTR_RESENT as FAS_DEMO_NOTIFICATION_LTR_RESENT 
, fas.C_RESCHEDULED_RESPONSE_DUE as FAS_RESCHEDULED_RESPONSE_DUE
, fas.C_RESCHEDULE_RESPONSE_RECEIVED as FAS_RESCHEDULE_RESPONSE_RECEIVED
, fas.C_VERBAL_CONFIRMATION as FAS_VERBAL_CONFIRMATION
, fas.C_RESCHEDULED_DEMO_STATUS as FAS_RESCHEDULED_DEMO_STATUS	
, fas.C_PROVIDER_OR_SUPPLIER_NAME as FAS_PROVIDER_OR_SUPPLIER_NAME
, fas.C_DEMO_CONFERENCE_STATUS as FAS_DEMO_CONFERENCE_STATUS	
, fas.C_REVIEW_TYPE as FAS_REVIEW_TYPE
, fas.C_EXPERT_REVIEW_DECISION as FAS_EXPERT_REVIEW_DECISION			
, fas.C_REVIEW_NUMBER as FAS_REVIEW_NUMBER

,awip.CREATE_DATE AS AWIP_CREATE_DATE
,awip.COMPLETE_DATE AS AWIP_COMPLETE_DATE
--,awip.CANCELLED_DATE AS AWIP_CANCELLED_DATE
,awip.ADJUDICATOR AS AWIP_ADJUDICATOR
,awip.DEADLINE_DATE AS AWIP_DEADLINE_DATE
,awip.APPEAL_ISSUE AS AWIP_APPEAL_ISSUE
,awip.APPEAL_ITEM AS AWIP_APPEAL_ITEM
,awip.APPEAL_NUMBER AS AWIP_APPEAL_NUMBER
,awip.APPEAL_PRIORITY_ID AS AWIP_APPEAL_PRIORITY_ID
,awip.REQUEST_RECEIVED AS AWIP_REQUEST_RECEIVED
,awip.APPEAL_STAGE AS AWIP_APPEAL_STAGE
,awip.APPEAL_STATUS AS AWIP_APPEAL_STATUS
,awip.APPEAL_TYPE AS AWIP_APPEAL_TYPE
,awip.APPEAL_DISMISSAL AS AWIP_APPEAL_DISMISSAL
,awip.APPEAL_DISMISSAL_REASON AS AWIP_APPEAL_DISMISSAL_REASON
,awip.AUTO_FORWARD AS AWIP_AUTO_FORWARD
,awip.CASE_FILE_REQUEST_DATE AS AWIP_CASE_FILE_REQUEST_DATE
,awip.ACKNOWLEDGEMENT_LETTER_DATE AS AWIP_ACKNOWLEDGEMENT_LETTER_DATE
,awip.DECISION_MAILED_DATE AS AWIP_DECISION_MAILED_DATE
,awip.DECISION_SENT_PLAN_DATE AS AWIP_DECISION_SENT_PLAN_DATE
,awip.MEDICAL_REVIEW_CHECK AS AWIP_MEDICAL_REVIEW_CHECK
,awip.APPEAL_PART_ID AS AWIP_APPEAL_PART_ID
,awip.APPEAL_REASON AS AWIP_APPEAL_REASON
,awip.APPEAL_TOLLING_DATE AS AWIP_APPEAL_TOLLING_DATE
,awip.APPEAL_NOTICE_DATE AS AWIP_APPEAL_NOTICE_DATE
,awip.CASE_FILE_RECEIVED_DATE AS AWIP_CASE_FILE_RECEIVED_DATE
,awip.CLAIMED_DATE AS AWIP_CLAIMED_DATE
,awip.DECISION AS AWIP_DECISION
,awip.DECISION_NOTIFICATION_METHOD AS AWIP_DECISION_NOTIFICATION_METHOD
,awip.HPMS AS AWIP_HPMS
,awip.HPMS_REQUESTED_DATE AS AWIP_HPMS_REQUESTED_DATE
,awip.IS_REQUEST_FOR_INFORMATION_P AS AWIP_IS_REQUEST_FOR_INFORMATION_P
,awip.MAC AS AWIP_MAC
,awip.MEDICARE_TYPE AS AWIP_MEDICARE_TYPE
,awip.MSP AS AWIP_MSP
,awip.NEW_DOCUMENTATION_REVIEWED AS AWIP_NEW_DOCUMENTATION_REVIEWED
,awip.PHYSICIAN_SPECIALTY AS AWIP_PHYSICIAN_SPECIALTY
,awip.PRECHECK_COMPLETED AS AWIP_PRECHECK_COMPLETED
,awip.REASON_FOR_APPEAL AS AWIP_REASON_FOR_APPEAL
,awip.WITHDRAWAL AS AWIP_WITHDRAWAL
,awip.WITHDRAWAL_REQUEST_SUBMITTED AS AWIP_WITHDRAWAL_REQUEST_SUBMITTED
,awip.NON_ENGLISH AS AWIP_NON_ENGLISH
,awip.NON_ENGLISH_OTHER AS AWIP_NON_ENGLISH_OTHER
,awip.DISPOSITION AS AWIP_DISPOSITION
,awip.DISPOSITION_EXPLANATION AS AWIP_DISPOSITION_EXPLANATION
,awip.PROCEDURAL_DECISION_REASON AS AWIP_PROCEDURAL_DECISION_REASON
,awip.SUBSTANTIVE_REASON AS AWIP_SUBSTANTIVE_REASON
,awip.FIRST_REVIEW_CASE_ATTESTATIO AS AWIP_FIRST_REVIEW_CASE_ATTESTATIO
,awip.FIRST_MEDICAL_REVIEW_DECISIO AS AWIP_FIRST_MEDICAL_REVIEW_DECISIO
,awip.FIRST_REVIEWER AS AWIP_FIRST_REVIEWER
,awip.THIRD_MEDICAL_REVIEW_DECISIO AS AWIP_THIRD_MEDICAL_REVIEW_DECISIO
,awip.THIRD_REVIEW_CASE_ATTESTATIO AS AWIP_THIRD_REVIEW_CASE_ATTESTATIO
,awip.THIRD_REVIEWER AS AWIP_THIRD_REVIEWER
,awip.EXPERT_REVIEW_CASE_ATTESTATI AS AWIP_EXPERT_REVIEW_CASE_ATTESTATI
,awip.EXPERT_REVIEW_CITATION AS AWIP_EXPERT_REVIEW_CITATION
,awip.EXPERT_REVIEWER_MD_ID AS AWIP_EXPERT_REVIEWER_MD_ID
,awip.STG_LAST_UPDATE_DATE as AWIP_STG_LAST_UPDATE_DATE
,awip.change_flag as awip_change_flag
,awip.CLOSED_DATE as AWIP_CLOSED_DATE
,awip.WITHDRAWN_DATE as AWIP_WITHDRAWN_DATE

, awip.DEMO_REOPENING_TYPE as AWIP_DEMO_REOPENING_TYPE
, awip.OTHER_REOPENING_TYPE as AWIP_OTHER_REOPENING_TYPE
, awip.CASE_CURRENTLY_WITH_ALJ as AWIP_CASE_CURRENTLY_WITH_ALJ
, awip.DATE_OF_REQUEST_TO_ALJ as AWIP_DATE_OF_REQUEST_TO_ALJ
, awip.DEMO_REOPENING_DUE_DATE as AWIP_DEMO_REOPENING_DUE_DATE
, awip.DEMO_REO_SENT_TO_OMHA_DATE as AWIP_DEMO_REO_SENT_TO_OMHA_DATE
, awip.OMHA_RESPONSE_RECEIVED as AWIP_OMHA_RESPONSE_RECEIVED
, awip.RESPONSE_FROM_OMHA as AWIP_RESPONSE_FROM_OMHA
, awip.ADDITIONAL_INFO_REQUESTED as AWIP_ADDITIONAL_INFO_REQUESTED
, awip.REQUESTED_INFORMATION_DUE as AWIP_REQUESTED_INFORMATION_DUE
, awip.DEMO_REOPEN_FOLLOW_UP as AWIP_DEMO_REOPEN_FOLLOW_UP
, awip.ADDITIONAL_INFO_RECEIVED as AWIP_ADDITIONAL_INFO_RECEIVED
, awip.REOPENING_DECISION_RESULTS as AWIP_REOPENING_DECISION_RESULTS
, awip.NOT_REOPENED_REASON as AWIP_NOT_REOPENED_REASON

, awip.OMHA_REMAND_REQUEST as AWIP_OMHA_REMAND_REQUEST
, awip.REMAND_ELIGIBILITY_RESPONSE as AWIP_REMAND_ELIGIBILITY_RESPONSE
, awip.REMAND_RECEIVED_DATE as AWIP_REMAND_RECEIVED_DATE
, awip.OMHA_REMAND_REQUEST_RESPONSE as AWIP_OMHA_REMAND_REQUEST_RESPONSE
, awip.OMHA_WITHDRAW_FORM_SENT as AWIP_OMHA_WITHDRAW_FORM_SENT
, awip.OMHA_WITHDRAW_FORM_RETURNED as AWIP_OMHA_WITHDRAW_FORM_RETURNED
, awip.OMHA_NOTIFIED_OF_WITHDRAWL as AWIP_OMHA_NOTIFIED_OF_WITHDRAWL
, awip.ALJ_WITHDRAWAL as AWIP_ALJ_WITHDRAWAL
, awip.DEMO_REOPENING_APPEAL_NUMBER as AWIP_DEMO_REOPENING_APPEAL_NUMBER
, awip.REOPENING_ANALYSIS_COMPLETED as AWIP_REOPENING_ANALYSIS_COMPLETED
, awip.REOPENING_ANALYSIS_OUTCOME as AWIP_REOPENING_ANALYSIS_OUTCOME
, awip.NOT_PURSUED_BY_CONTR_REASON as AWIP_NOT_PURSUED_BY_CONTR_REASON
, awip.ACK_LETTER_MAILED as AWIP_ACK_LETTER_MAILED
, awip.REO_DECISION_LETTER_MAILED as AWIP_REO_DECISION_LETTER_MAILED
, awip.REOPENING_OUTCOME as AWIP_REOPENING_OUTCOME
, awip.DECLINE_TO_REOPEN_DECISION as AWIP_DECLINE_TO_REOPEN_DECISION
, awip.APPEAL_ATTESTATION_DATE as AWIP_APPEAL_ATTESTATION_DATE
, awip.APPEAL_ATTESTATION as AWIP_APPEAL_ATTESTATION
, awip.DEMO_SCHEDULED as AWIP_DEMO_SCHEDULED
, awip.DEMO_NOTIFICATION_LETTER_SENT as AWIP_DEMO_NOTIFICATION_LETTER_SENT
, awip.RESPONSE_DUE as AWIP_RESPONSE_DUE
, awip.RESPONSE_RECEIVED as AWIP_RESPONSE_RECEIVED
, awip.DEMO_ACCEPTANCE_STATUS as AWIP_DEMO_ACCEPTANCE_STATUS
, awip.TELE_DEMO_FOLLOW_UP as AWIP_TELE_DEMO_FOLLOW_UP
, awip.DEMO_NOTIFICATION_LTR_RESENT as AWIP_DEMO_NOTIFICATION_LTR_RESENT
, awip.RESCHEDULED_RESPONSE_DUE as AWIP_RESCHEDULED_RESPONSE_DUE
, awip.RESCHEDULE_RESPONSE_RECEIVED as AWIP_RESCHEDULE_RESPONSE_RECEIVED
, awip.VERBAL_CONFIRMATION as AWIP_VERBAL_CONFIRMATION
, awip.RESCHEDULED_DEMO_STATUS as AWIP_RESCHEDULED_DEMO_STATUS
, awip.PROVIDER_OR_SUPPLIER_NAME as AWIP_PROVIDER_OR_SUPPLIER_NAME	
, awip.DEMO_CONFERENCE_STATUS as AWIP_DEMO_CONFERENCE_STATUS
, awip.REVIEW_TYPE as AWIP_REVIEW_TYPE
, awip.EXPERT_REVIEW_DECISION as AWIP_EXPERT_REVIEW_DECISION		
, awip.REVIEW_NUMBER as AWIP_REVIEW_NUMBER


FROM fedqic_appeal_stg fas
,corp_etl_appeal_wip awip
WHERE  fas.id = awip.appeal_id )

SET AWIP_CREATE_DATE = FAS_CREATE_DATE
,AWIP_COMPLETE_DATE =  FAS_COMPLETE_DATE
--,AWIP_CANCELLED_DATE = case when fas_withdrawal = 1 then fas_t_maxdat_closed_date else null end
,AWIP_ADJUDICATOR = FAS_ADJUDICATOR
,AWIP_DEADLINE_DATE = FAS_DEADLINE_DATE
,AWIP_APPEAL_ISSUE = FAS_APPEAL_ISSUE
,AWIP_APPEAL_ITEM = FAS_APPEAL_ITEM
,AWIP_APPEAL_NUMBER = FAS_APPEAL_NUMBER
,AWIP_APPEAL_PRIORITY_ID = FAS_APPEAL_PRIORITY_ID
,AWIP_REQUEST_RECEIVED = FAS_REQUEST_RECEIVED
,AWIP_APPEAL_STAGE = FAS_APPEAL_STAGE
,AWIP_APPEAL_STATUS = FAS_APPEAL_STATUS
,AWIP_APPEAL_TYPE = FAS_APPEAL_TYPE
,AWIP_APPEAL_DISMISSAL = FAS_APPEAL_DISMISSAL
,AWIP_APPEAL_DISMISSAL_REASON = FAS_APPEAL_DISMISSAL_REASON
,AWIP_AUTO_FORWARD = FAS_AUTO_FORWARD
,AWIP_CASE_FILE_REQUEST_DATE = FAS_CASE_FILE_REQUEST_DATE
,AWIP_ACKNOWLEDGEMENT_LETTER_DATE = FAS_ACKNOWLEDGEMENT_LETTER_DATE
,AWIP_DECISION_MAILED_DATE = FAS_DECISION_MAILED_DATE
,AWIP_DECISION_SENT_PLAN_DATE = FAS_DECISION_SENT_PLAN_DATE
,AWIP_MEDICAL_REVIEW_CHECK = FAS_MEDICAL_REVIEW_CHECK
,AWIP_APPEAL_PART_ID = FAS_APPEAL_PART_ID
,AWIP_APPEAL_REASON = FAS_APPEAL_REASON
,AWIP_APPEAL_TOLLING_DATE = FAS_APPEAL_TOLLING_DATE
,AWIP_APPEAL_NOTICE_DATE = FAS_APPEAL_NOTICE_DATE
,AWIP_CASE_FILE_RECEIVED_DATE = FAS_CASE_FILE_RECEIVED_DATE
,AWIP_CLAIMED_DATE = FAS_CLAIMED_DATE
,AWIP_DECISION = FAS_DECISION
,AWIP_DECISION_NOTIFICATION_METHOD = FAS_DECISION_NOTIFICATION_METHOD
,AWIP_HPMS = FAS_HPMS
,AWIP_HPMS_REQUESTED_DATE = FAS_HPMS_REQUESTED_DATE
,AWIP_IS_REQUEST_FOR_INFORMATION_P = FAS_IS_REQUEST_FOR_INFORMATION_P
,AWIP_MAC = FAS_MAC
,AWIP_MEDICARE_TYPE = FAS_MEDICARE_TYPE
,AWIP_MSP = FAS_MSP
,AWIP_NEW_DOCUMENTATION_REVIEWED = FAS_NEW_DOCUMENTATION_REVIEWED
,AWIP_PHYSICIAN_SPECIALTY = FAS_PHYSICIAN_SPECIALTY
,AWIP_PRECHECK_COMPLETED = FAS_PRECHECK_COMPLETED
,AWIP_REASON_FOR_APPEAL = FAS_REASON_FOR_APPEAL
,AWIP_WITHDRAWAL = FAS_WITHDRAWAL
,AWIP_WITHDRAWAL_REQUEST_SUBMITTED = FAS_WITHDRAWAL_REQUEST_SUBMITTED
,AWIP_NON_ENGLISH = FAS_NON_ENGLISH
,AWIP_NON_ENGLISH_OTHER = FAS_NON_ENGLISH_OTHER
,AWIP_DISPOSITION = FAS_DISPOSITION
,AWIP_DISPOSITION_EXPLANATION = FAS_DISPOSITION_EXPLANATION
,AWIP_PROCEDURAL_DECISION_REASON = FAS_PROCEDURAL_DECISION_REASON
,AWIP_SUBSTANTIVE_REASON = FAS_SUBSTANTIVE_REASON
,AWIP_FIRST_REVIEW_CASE_ATTESTATIO = FAS_FIRST_REVIEW_CASE_ATTESTATIO
,AWIP_FIRST_MEDICAL_REVIEW_DECISIO = FAS_FIRST_MEDICAL_REVIEW_DECISIO
,AWIP_FIRST_REVIEWER = FAS_FIRST_REVIEWER
,AWIP_THIRD_MEDICAL_REVIEW_DECISIO = FAS_THIRD_MEDICAL_REVIEW_DECISIO
,AWIP_THIRD_REVIEW_CASE_ATTESTATIO = FAS_THIRD_REVIEW_CASE_ATTESTATIO
,AWIP_THIRD_REVIEWER = FAS_THIRD_REVIEWER
,AWIP_EXPERT_REVIEW_CASE_ATTESTATI = FAS_EXPERT_REVIEW_CASE_ATTESTATI
,AWIP_EXPERT_REVIEW_CITATION = FAS_EXPERT_REVIEW_CITATION
,AWIP_EXPERT_REVIEWER_MD_ID = FAS_EXPERT_REVIEWER_MD_ID
,AWIP_STG_LAST_UPDATE_DATE = sysdate
,AWIP_CLOSED_DATE =  case when (fas_withdrawal is null or fas_withdrawal = 0) then fas_t_maxdat_closed_date else null end
,AWIP_WITHDRAWN_DATE =  case when (fas_withdrawal is not null and fas_withdrawal = 1) then fas_t_maxdat_closed_date else null end

, AWIP_DEMO_REOPENING_TYPE = FAS_DEMO_REOPENING_TYPE
, AWIP_OTHER_REOPENING_TYPE = FAS_OTHER_REOPENING_TYPE
, AWIP_CASE_CURRENTLY_WITH_ALJ = FAS_CASE_CURRENTLY_WITH_ALJ
, AWIP_DATE_OF_REQUEST_TO_ALJ = FAS_DATE_OF_REQUEST_TO_ALJ
, AWIP_DEMO_REOPENING_DUE_DATE = FAS_DEMO_REOPENING_DUE_DATE
, AWIP_DEMO_REO_SENT_TO_OMHA_DATE = FAS_DEMO_REO_SENT_TO_OMHA_DATE
, AWIP_OMHA_RESPONSE_RECEIVED = FAS_OMHA_RESPONSE_RECEIVED
, AWIP_RESPONSE_FROM_OMHA = FAS_RESPONSE_FROM_OMHA
, AWIP_ADDITIONAL_INFO_REQUESTED = FAS_ADDITIONAL_INFO_REQUESTED
, AWIP_REQUESTED_INFORMATION_DUE = FAS_REQUESTED_INFORMATION_DUE
, AWIP_DEMO_REOPEN_FOLLOW_UP = FAS_DEMO_REOPEN_FOLLOW_UP
, AWIP_ADDITIONAL_INFO_RECEIVED = FAS_ADDITIONAL_INFO_RECEIVED
, AWIP_REOPENING_DECISION_RESULTS = FAS_REOPENING_DECISION_RESULTS
, AWIP_NOT_REOPENED_REASON = FAS_NOT_REOPENED_REASON

, AWIP_OMHA_REMAND_REQUEST = FAS_OMHA_REMAND_REQUEST
, AWIP_REMAND_ELIGIBILITY_RESPONSE = FAS_REMAND_ELIGIBILITY_RESPONSE
, AWIP_REMAND_RECEIVED_DATE = FAS_REMAND_RECEIVED_DATE
, AWIP_OMHA_REMAND_REQUEST_RESPONSE = FAS_OMHA_REMAND_REQUEST_RESPONSE
, AWIP_OMHA_WITHDRAW_FORM_SENT = FAS_OMHA_WITHDRAW_FORM_SENT
, AWIP_OMHA_WITHDRAW_FORM_RETURNED = FAS_OMHA_WITHDRAW_FORM_RETURNED
, AWIP_OMHA_NOTIFIED_OF_WITHDRAWL = FAS_OMHA_NOTIFIED_OF_WITHDRAWL
, AWIP_ALJ_WITHDRAWAL = FAS_ALJ_WITHDRAWAL
, AWIP_DEMO_REOPENING_APPEAL_NUMBER = FAS_DEMO_REOPENING_APPEAL_NUMBER
, AWIP_REOPENING_ANALYSIS_COMPLETED = FAS_REOPENING_ANALYSIS_COMPLETED
, AWIP_REOPENING_ANALYSIS_OUTCOME = FAS_REOPENING_ANALYSIS_OUTCOME
, AWIP_NOT_PURSUED_BY_CONTR_REASON = FAS_NOT_PURSUED_BY_CONTR_REASON
, AWIP_ACK_LETTER_MAILED = FAS_ACK_LETTER_MAILED
, AWIP_REO_DECISION_LETTER_MAILED = FAS_REO_DECISION_LETTER_MAILED
, AWIP_REOPENING_OUTCOME = FAS_REOPENING_OUTCOME
, AWIP_DECLINE_TO_REOPEN_DECISION = FAS_DECLINE_TO_REOPEN_DECISION
, AWIP_APPEAL_ATTESTATION_DATE = FAS_APPEAL_ATTESTATION_DATE
, AWIP_APPEAL_ATTESTATION = FAS_APPEAL_ATTESTATION
, AWIP_DEMO_SCHEDULED = FAS_DEMO_SCHEDULED
, AWIP_DEMO_NOTIFICATION_LETTER_SENT = FAS_DEMO_NOTIFICATION_LETTER_SENT
, AWIP_RESPONSE_DUE = FAS_RESPONSE_DUE
, AWIP_RESPONSE_RECEIVED = FAS_RESPONSE_RECEIVED
, AWIP_DEMO_ACCEPTANCE_STATUS = FAS_DEMO_ACCEPTANCE_STATUS
, AWIP_TELE_DEMO_FOLLOW_UP = FAS_TELE_DEMO_FOLLOW_UP
, AWIP_DEMO_NOTIFICATION_LTR_RESENT = FAS_DEMO_NOTIFICATION_LTR_RESENT
, AWIP_RESCHEDULED_RESPONSE_DUE = FAS_RESCHEDULED_RESPONSE_DUE
, AWIP_RESCHEDULE_RESPONSE_RECEIVED = FAS_RESCHEDULE_RESPONSE_RECEIVED
, AWIP_VERBAL_CONFIRMATION = FAS_VERBAL_CONFIRMATION
, AWIP_RESCHEDULED_DEMO_STATUS = FAS_RESCHEDULED_DEMO_STATUS
, AWIP_PROVIDER_OR_SUPPLIER_NAME = FAS_PROVIDER_OR_SUPPLIER_NAME
, AWIP_DEMO_CONFERENCE_STATUS = FAS_DEMO_CONFERENCE_STATUS
, AWIP_REVIEW_TYPE = FAS_REVIEW_TYPE
, AWIP_EXPERT_REVIEW_DECISION = FAS_EXPERT_REVIEW_DECISION		
, AWIP_REVIEW_NUMBER = FAS_REVIEW_NUMBER

,awip_change_flag = 'Y'

where awip_change_flag = 'N'
AND (decode(AWIP_CREATE_DATE,FAS_CREATE_DATE,1,0) = 0
OR decode(AWIP_COMPLETE_DATE,FAS_COMPLETE_DATE,1,0) = 0
--OR (AWIP_CANCELLED_DATE is null and FAS_WITHDRAWAL = 1 and FAS_T_MAXDAT_CLOSED_DATE is not null) 
OR decode(AWIP_ADJUDICATOR,FAS_ADJUDICATOR,1,0) = 0
OR decode(AWIP_DEADLINE_DATE,FAS_DEADLINE_DATE,1,0) = 0
OR decode(AWIP_APPEAL_ISSUE,FAS_APPEAL_ISSUE,1,0) = 0
OR decode(AWIP_APPEAL_ITEM,FAS_APPEAL_ITEM,1,0) = 0
OR decode(AWIP_APPEAL_NUMBER,FAS_APPEAL_NUMBER,1,0) = 0
OR decode(AWIP_APPEAL_PRIORITY_ID,FAS_APPEAL_PRIORITY_ID,1,0) = 0
OR decode(AWIP_REQUEST_RECEIVED,FAS_REQUEST_RECEIVED,1,0) = 0
OR decode(AWIP_APPEAL_STAGE,FAS_APPEAL_STAGE,1,0) = 0
OR decode(AWIP_APPEAL_STATUS,FAS_APPEAL_STATUS,1,0) = 0
OR decode(AWIP_APPEAL_TYPE,FAS_APPEAL_TYPE,1,0) = 0
OR decode(AWIP_APPEAL_DISMISSAL,FAS_APPEAL_DISMISSAL,1,0) = 0
OR decode(AWIP_APPEAL_DISMISSAL_REASON,FAS_APPEAL_DISMISSAL_REASON,1,0) = 0
OR decode(AWIP_AUTO_FORWARD,FAS_AUTO_FORWARD,1,0) = 0
OR decode(AWIP_CASE_FILE_REQUEST_DATE,FAS_CASE_FILE_REQUEST_DATE,1,0) = 0
OR decode(AWIP_ACKNOWLEDGEMENT_LETTER_DATE,FAS_ACKNOWLEDGEMENT_LETTER_DATE,1,0) = 0
OR decode(AWIP_DECISION_MAILED_DATE,FAS_DECISION_MAILED_DATE,1,0) = 0
OR decode(AWIP_DECISION_SENT_PLAN_DATE,FAS_DECISION_SENT_PLAN_DATE,1,0) = 0
OR decode(AWIP_MEDICAL_REVIEW_CHECK,FAS_MEDICAL_REVIEW_CHECK,1,0) = 0
OR decode(AWIP_APPEAL_PART_ID,FAS_APPEAL_PART_ID,1,0) = 0
OR decode(AWIP_APPEAL_REASON,FAS_APPEAL_REASON,1,0) = 0
OR decode(AWIP_APPEAL_TOLLING_DATE,FAS_APPEAL_TOLLING_DATE,1,0) = 0
OR decode(AWIP_APPEAL_NOTICE_DATE,FAS_APPEAL_NOTICE_DATE,1,0) = 0
OR decode(AWIP_CASE_FILE_RECEIVED_DATE,FAS_CASE_FILE_RECEIVED_DATE,1,0) = 0
OR decode(AWIP_CLAIMED_DATE,FAS_CLAIMED_DATE,1,0) = 0
OR decode(AWIP_DECISION,FAS_DECISION,1,0) = 0
OR decode(AWIP_DECISION_NOTIFICATION_METHOD,FAS_DECISION_NOTIFICATION_METHOD,1,0) = 0
OR decode(AWIP_HPMS,FAS_HPMS,1,0) = 0
OR decode(AWIP_HPMS_REQUESTED_DATE,FAS_HPMS_REQUESTED_DATE,1,0) = 0
OR decode(AWIP_IS_REQUEST_FOR_INFORMATION_P,FAS_IS_REQUEST_FOR_INFORMATION_P,1,0) = 0
OR decode(AWIP_MAC,FAS_MAC,1,0) = 0
OR decode(AWIP_MEDICARE_TYPE,FAS_MEDICARE_TYPE,1,0) = 0
OR decode(AWIP_MSP,FAS_MSP,1,0) = 0
OR decode(AWIP_NEW_DOCUMENTATION_REVIEWED,FAS_NEW_DOCUMENTATION_REVIEWED,1,0) = 0
OR decode(AWIP_PHYSICIAN_SPECIALTY,FAS_PHYSICIAN_SPECIALTY,1,0) = 0
OR decode(AWIP_PRECHECK_COMPLETED,FAS_PRECHECK_COMPLETED,1,0) = 0
OR decode(AWIP_REASON_FOR_APPEAL, FAS_REASON_FOR_APPEAL,1,0) = 0
OR decode(AWIP_WITHDRAWAL,FAS_WITHDRAWAL,1,0) = 0
OR decode(AWIP_WITHDRAWAL_REQUEST_SUBMITTED,FAS_WITHDRAWAL_REQUEST_SUBMITTED,1,0) = 0
OR decode(AWIP_NON_ENGLISH,FAS_NON_ENGLISH,1,0) = 0
OR decode(AWIP_NON_ENGLISH_OTHER,FAS_NON_ENGLISH_OTHER,1,0) = 0
OR decode(AWIP_DISPOSITION,FAS_DISPOSITION,1,0) = 0
OR decode(AWIP_DISPOSITION_EXPLANATION,FAS_DISPOSITION_EXPLANATION,1,0) = 0
OR decode(AWIP_PROCEDURAL_DECISION_REASON,FAS_PROCEDURAL_DECISION_REASON,1,0) = 0
OR decode(AWIP_SUBSTANTIVE_REASON,FAS_SUBSTANTIVE_REASON,1,0) = 0
OR decode(AWIP_FIRST_REVIEW_CASE_ATTESTATIO,FAS_FIRST_REVIEW_CASE_ATTESTATIO,1,0) = 0
OR decode(AWIP_FIRST_MEDICAL_REVIEW_DECISIO,FAS_FIRST_MEDICAL_REVIEW_DECISIO,1,0) = 0
OR decode(AWIP_FIRST_REVIEWER,FAS_FIRST_REVIEWER,1,0) = 0
OR decode(AWIP_THIRD_MEDICAL_REVIEW_DECISIO,FAS_THIRD_MEDICAL_REVIEW_DECISIO,1,0) = 0
OR decode(AWIP_THIRD_REVIEW_CASE_ATTESTATIO,FAS_THIRD_REVIEW_CASE_ATTESTATIO,1,0) = 0
OR decode(AWIP_THIRD_REVIEWER,FAS_THIRD_REVIEWER,1,0) = 0
OR decode(AWIP_EXPERT_REVIEW_CASE_ATTESTATI,FAS_EXPERT_REVIEW_CASE_ATTESTATI,1,0) = 0
OR decode(AWIP_EXPERT_REVIEW_CITATION,FAS_EXPERT_REVIEW_CITATION,1,0) = 0
OR decode(AWIP_EXPERT_REVIEWER_MD_ID,FAS_EXPERT_REVIEWER_MD_ID,1,0) = 0
OR (AWIP_CLOSED_DATE is null and (FAS_WITHDRAWAL IS NULL OR FAS_WITHDRAWAL = 0) and FAS_T_MAXDAT_CLOSED_DATE is not null)
OR (AWIP_WITHDRAWN_DATE is null and (FAS_WITHDRAWAL IS NOT NULL AND FAS_WITHDRAWAL = 1) and FAS_T_MAXDAT_CLOSED_DATE is not null) 

OR decode(AWIP_DEMO_REOPENING_TYPE,FAS_DEMO_REOPENING_TYPE,1,0) = 0
OR decode(AWIP_OTHER_REOPENING_TYPE,FAS_OTHER_REOPENING_TYPE,1,0) = 0
OR decode(AWIP_CASE_CURRENTLY_WITH_ALJ,FAS_CASE_CURRENTLY_WITH_ALJ,1,0) = 0
OR decode(AWIP_DATE_OF_REQUEST_TO_ALJ,FAS_DATE_OF_REQUEST_TO_ALJ,1,0) = 0
OR decode(AWIP_DEMO_REOPENING_DUE_DATE,FAS_DEMO_REOPENING_DUE_DATE,1,0) = 0
OR decode(AWIP_DEMO_REO_SENT_TO_OMHA_DATE,FAS_DEMO_REO_SENT_TO_OMHA_DATE,1,0) = 0
OR decode(AWIP_OMHA_RESPONSE_RECEIVED,FAS_OMHA_RESPONSE_RECEIVED,1,0) = 0
OR decode(AWIP_RESPONSE_FROM_OMHA,FAS_RESPONSE_FROM_OMHA,1,0) = 0
OR decode(AWIP_ADDITIONAL_INFO_REQUESTED,FAS_ADDITIONAL_INFO_REQUESTED,1,0) = 0
OR decode(AWIP_REQUESTED_INFORMATION_DUE,FAS_REQUESTED_INFORMATION_DUE,1,0) = 0
OR decode(AWIP_DEMO_REOPEN_FOLLOW_UP,FAS_DEMO_REOPEN_FOLLOW_UP,1,0) = 0
OR decode(AWIP_ADDITIONAL_INFO_RECEIVED,FAS_ADDITIONAL_INFO_RECEIVED,1,0) = 0
OR decode(AWIP_REOPENING_DECISION_RESULTS,FAS_REOPENING_DECISION_RESULTS,1,0) = 0
OR decode(AWIP_NOT_REOPENED_REASON,FAS_NOT_REOPENED_REASON,1,0) = 0

OR decode(AWIP_OMHA_REMAND_REQUEST,FAS_OMHA_REMAND_REQUEST,1,0) = 0
OR decode(AWIP_REMAND_ELIGIBILITY_RESPONSE,FAS_REMAND_ELIGIBILITY_RESPONSE,1,0) = 0
OR decode(AWIP_REMAND_RECEIVED_DATE,FAS_REMAND_RECEIVED_DATE,1,0) = 0
OR decode(AWIP_OMHA_REMAND_REQUEST_RESPONSE,FAS_OMHA_REMAND_REQUEST_RESPONSE,1,0) = 0
OR decode(AWIP_OMHA_WITHDRAW_FORM_SENT,FAS_OMHA_WITHDRAW_FORM_SENT,1,0) = 0
OR decode(AWIP_OMHA_WITHDRAW_FORM_RETURNED,FAS_OMHA_WITHDRAW_FORM_RETURNED,1,0) = 0
OR decode(AWIP_OMHA_NOTIFIED_OF_WITHDRAWL,FAS_OMHA_NOTIFIED_OF_WITHDRAWL,1,0) = 0
OR decode(AWIP_ALJ_WITHDRAWAL,FAS_ALJ_WITHDRAWAL,1,0) = 0
OR decode(AWIP_DEMO_REOPENING_APPEAL_NUMBER,FAS_DEMO_REOPENING_APPEAL_NUMBER,1,0) = 0
OR decode(AWIP_REOPENING_ANALYSIS_COMPLETED,FAS_REOPENING_ANALYSIS_COMPLETED,1,0) = 0
OR decode(AWIP_REOPENING_ANALYSIS_OUTCOME,FAS_REOPENING_ANALYSIS_OUTCOME,1,0) = 0
OR decode(AWIP_NOT_PURSUED_BY_CONTR_REASON,FAS_NOT_PURSUED_BY_CONTR_REASON,1,0) = 0
OR decode(AWIP_ACK_LETTER_MAILED,FAS_ACK_LETTER_MAILED,1,0) = 0
OR decode(AWIP_REO_DECISION_LETTER_MAILED,FAS_REO_DECISION_LETTER_MAILED,1,0) = 0
OR decode(AWIP_REOPENING_OUTCOME,FAS_REOPENING_OUTCOME,1,0) = 0
OR decode(AWIP_DECLINE_TO_REOPEN_DECISION,FAS_DECLINE_TO_REOPEN_DECISION,1,0) = 0
OR decode(AWIP_APPEAL_ATTESTATION_DATE,FAS_APPEAL_ATTESTATION_DATE,1,0) = 0
OR decode(AWIP_APPEAL_ATTESTATION,FAS_APPEAL_ATTESTATION,1,0) = 0
OR decode(AWIP_DEMO_SCHEDULED,FAS_DEMO_SCHEDULED,1,0) = 0
OR decode(AWIP_DEMO_NOTIFICATION_LETTER_SENT,FAS_DEMO_NOTIFICATION_LETTER_SENT,1,0) = 0
OR decode(AWIP_RESPONSE_DUE,FAS_RESPONSE_DUE,1,0) = 0
OR decode(AWIP_RESPONSE_RECEIVED,FAS_RESPONSE_RECEIVED,1,0) = 0
OR decode(AWIP_DEMO_ACCEPTANCE_STATUS,FAS_DEMO_ACCEPTANCE_STATUS,1,0) = 0
OR decode(AWIP_TELE_DEMO_FOLLOW_UP,FAS_TELE_DEMO_FOLLOW_UP,1,0) = 0
OR decode(AWIP_DEMO_NOTIFICATION_LTR_RESENT,FAS_DEMO_NOTIFICATION_LTR_RESENT,1,0) = 0
OR decode(AWIP_RESCHEDULED_RESPONSE_DUE,FAS_RESCHEDULED_RESPONSE_DUE,1,0) = 0
OR decode(AWIP_RESCHEDULE_RESPONSE_RECEIVED,FAS_RESCHEDULE_RESPONSE_RECEIVED,1,0) = 0
OR decode(AWIP_VERBAL_CONFIRMATION,FAS_VERBAL_CONFIRMATION,1,0) = 0
OR decode(AWIP_RESCHEDULED_DEMO_STATUS,FAS_RESCHEDULED_DEMO_STATUS,1,0) = 0
OR decode(AWIP_PROVIDER_OR_SUPPLIER_NAME,FAS_PROVIDER_OR_SUPPLIER_NAME,1,0) = 0
OR decode(AWIP_DEMO_CONFERENCE_STATUS,FAS_DEMO_CONFERENCE_STATUS,1,0) = 0
OR decode(AWIP_REVIEW_TYPE,FAS_REVIEW_TYPE,1,0) = 0
OR decode(AWIP_EXPERT_REVIEW_DECISION,FAS_EXPERT_REVIEW_DECISION,1,0) = 0		
OR decode(AWIP_REVIEW_NUMBER,FAS_REVIEW_NUMBER,1,0) = 0

);

   COMMIT;


EXCEPTION
  WHEN OTHERS THEN
    ROLLBACK;
      g_Error := SQLERRM ;
      INSERT INTO corp_etl_error_log (process_name, job_name, error_desc) VALUES ('Insert_Update_Task', 'fedqic MW', g_Error);
      COMMIT;
      RAISE;

END Update_Appeals;

PROCEDURE APPEAL_UPDATE_MAIN_TABLE AS

 CURSOR wip_cur IS
   SELECT * FROM corp_etl_appeal_wip
   WHERE CHANGE_FLAG = 'Y';

   TYPE t_wip_tab IS TABLE OF wip_cur%ROWTYPE INDEX BY PLS_INTEGER;
    wip_tab t_wip_tab;
    v_bulk_limit NUMBER := 1000;
    v_step VARCHAR2(100);
    v_err_code VARCHAR2(30);
    --v_err_msg VARCHAR2(240);
    v_err_index NUMBER;
    vPROC VARCHAR2(30) := 'APPEAL_UPDATE_MAIN_TABLE';
BEGIN
   v_step :=  gPKG||'.'||vPROC||' - Updateing Main table';
   OPEN wip_cur;
   LOOP
     FETCH wip_cur BULK COLLECT INTO wip_tab LIMIT v_bulk_limit;
     EXIT WHEN wip_tab.COUNT = 0; -- Exit when missing rows

     BEGIN
       FORALL indx IN 1 .. wip_tab.COUNT SAVE EXCEPTIONS
         UPDATE corp_etl_appeal
                       SET 
  CREATE_DATE = wip_tab(indx).CREATE_DATE     
, COMPLETE_DATE = wip_tab(indx).COMPLETE_DATE
, CANCELLED_DATE = wip_tab(indx).CANCELLED_DATE
, ADJUDICATOR = wip_tab(indx).ADJUDICATOR 
, DEADLINE_DATE = wip_tab(indx).DEADLINE_DATE
, APPEAL_ISSUE = wip_tab(indx).APPEAL_ISSUE
, APPEAL_ITEM = wip_tab(indx).APPEAL_ITEM  
, APPEAL_NUMBER = wip_tab(indx).APPEAL_NUMBER 
, APPEAL_PRIORITY_ID = wip_tab(indx).APPEAL_PRIORITY_ID 
, REQUEST_RECEIVED = wip_tab(indx).REQUEST_RECEIVED 
, APPEAL_STAGE = wip_tab(indx).APPEAL_STAGE  
, APPEAL_STATUS = wip_tab(indx).APPEAL_STATUS 
, APPEAL_TYPE = wip_tab(indx).APPEAL_TYPE
, APPEAL_DISMISSAL = wip_tab(indx).APPEAL_DISMISSAL
, APPEAL_DISMISSAL_REASON = wip_tab(indx).APPEAL_DISMISSAL_REASON
, AUTO_FORWARD = wip_tab(indx).AUTO_FORWARD
, CASE_FILE_REQUEST_DATE = wip_tab(indx).CASE_FILE_REQUEST_DATE 
, ACKNOWLEDGEMENT_LETTER_DATE = wip_tab(indx).ACKNOWLEDGEMENT_LETTER_DATE 
, DECISION_MAILED_DATE = wip_tab(indx).DECISION_MAILED_DATE 
, DECISION_SENT_PLAN_DATE = wip_tab(indx).DECISION_SENT_PLAN_DATE 
, MEDICAL_REVIEW_CHECK = wip_tab(indx).MEDICAL_REVIEW_CHECK 
, APPEAL_PART_ID = wip_tab(indx).APPEAL_PART_ID 
, APPEAL_REASON = wip_tab(indx).APPEAL_REASON 
, APPEAL_TOLLING_DATE = wip_tab(indx).APPEAL_TOLLING_DATE
, APPEAL_NOTICE_DATE = wip_tab(indx).APPEAL_NOTICE_DATE
, CASE_FILE_RECEIVED_DATE = wip_tab(indx).CASE_FILE_RECEIVED_DATE  

, CLAIMED_DATE = wip_tab(indx).CLAIMED_DATE
, DECISION = wip_tab(indx).DECISION
, DECISION_NOTIFICATION_METHOD = wip_tab(indx).DECISION_NOTIFICATION_METHOD
, HPMS = wip_tab(indx).HPMS
, HPMS_REQUESTED_DATE = wip_tab(indx).HPMS_REQUESTED_DATE
, IS_REQUEST_FOR_INFORMATION_P = wip_tab(indx).IS_REQUEST_FOR_INFORMATION_P
, MAC = wip_tab(indx).MAC
, MEDICARE_TYPE = wip_tab(indx).MEDICARE_TYPE
, MSP = wip_tab(indx).MSP
, NEW_DOCUMENTATION_REVIEWED = wip_tab(indx).NEW_DOCUMENTATION_REVIEWED
, PHYSICIAN_SPECIALTY = wip_tab(indx).PHYSICIAN_SPECIALTY
, PRECHECK_COMPLETED = wip_tab(indx).PRECHECK_COMPLETED
, REASON_FOR_APPEAL = wip_tab(indx).REASON_FOR_APPEAL
, WITHDRAWAL = wip_tab(indx).WITHDRAWAL
, WITHDRAWAL_REQUEST_SUBMITTED = wip_tab(indx).WITHDRAWAL_REQUEST_SUBMITTED
, NON_ENGLISH = wip_tab(indx).NON_ENGLISH
, NON_ENGLISH_OTHER = wip_tab(indx).NON_ENGLISH_OTHER
, DISPOSITION = wip_tab(indx).DISPOSITION
, DISPOSITION_EXPLANATION = wip_tab(indx).DISPOSITION_EXPLANATION
, PROCEDURAL_DECISION_REASON = wip_tab(indx).PROCEDURAL_DECISION_REASON
, SUBSTANTIVE_REASON = wip_tab(indx).SUBSTANTIVE_REASON
, FIRST_REVIEW_CASE_ATTESTATIO = wip_tab(indx).FIRST_REVIEW_CASE_ATTESTATIO
, FIRST_MEDICAL_REVIEW_DECISIO = wip_tab(indx).FIRST_MEDICAL_REVIEW_DECISIO
, FIRST_REVIEWER = wip_tab(indx).FIRST_REVIEWER
, THIRD_MEDICAL_REVIEW_DECISIO = wip_tab(indx).THIRD_MEDICAL_REVIEW_DECISIO
, THIRD_REVIEW_CASE_ATTESTATIO = wip_tab(indx).THIRD_REVIEW_CASE_ATTESTATIO
, THIRD_REVIEWER = wip_tab(indx).THIRD_REVIEWER
, EXPERT_REVIEW_CASE_ATTESTATI = wip_tab(indx).EXPERT_REVIEW_CASE_ATTESTATI
, EXPERT_REVIEW_CITATION = wip_tab(indx).EXPERT_REVIEW_CITATION
, EXPERT_REVIEWER_MD_ID = wip_tab(indx).EXPERT_REVIEWER_MD_ID
, STG_EXTRACT_DATE = wip_tab(indx).STG_EXTRACT_DATE
, STG_LAST_UPDATE_DATE = wip_tab(indx).STG_LAST_UPDATE_DATE
, CLOSED_DATE = wip_tab(indx).CLOSED_DATE
, WITHDRAWN_DATE = wip_tab(indx).WITHDRAWN_DATE

, DEMO_REOPENING_TYPE = wip_tab(indx).DEMO_REOPENING_TYPE
, OTHER_REOPENING_TYPE = wip_tab(indx).OTHER_REOPENING_TYPE
, CASE_CURRENTLY_WITH_ALJ = wip_tab(indx).CASE_CURRENTLY_WITH_ALJ
, DATE_OF_REQUEST_TO_ALJ = wip_tab(indx).DATE_OF_REQUEST_TO_ALJ
, DEMO_REOPENING_DUE_DATE = wip_tab(indx).DEMO_REOPENING_DUE_DATE
, DEMO_REO_SENT_TO_OMHA_DATE = wip_tab(indx).DEMO_REO_SENT_TO_OMHA_DATE
, OMHA_RESPONSE_RECEIVED = wip_tab(indx).OMHA_RESPONSE_RECEIVED
, RESPONSE_FROM_OMHA = wip_tab(indx).RESPONSE_FROM_OMHA
, ADDITIONAL_INFO_REQUESTED = wip_tab(indx).ADDITIONAL_INFO_REQUESTED
, REQUESTED_INFORMATION_DUE = wip_tab(indx).REQUESTED_INFORMATION_DUE
, DEMO_REOPEN_FOLLOW_UP = wip_tab(indx).DEMO_REOPEN_FOLLOW_UP
, ADDITIONAL_INFO_RECEIVED = wip_tab(indx).ADDITIONAL_INFO_RECEIVED
, REOPENING_DECISION_RESULTS = wip_tab(indx).REOPENING_DECISION_RESULTS
, NOT_REOPENED_REASON = wip_tab(indx).NOT_REOPENED_REASON

, OMHA_REMAND_REQUEST = wip_tab(indx).OMHA_REMAND_REQUEST
, REMAND_ELIGIBILITY_RESPONSE = wip_tab(indx).REMAND_ELIGIBILITY_RESPONSE
, REMAND_RECEIVED_DATE	 = wip_tab(indx).REMAND_RECEIVED_DATE
, OMHA_REMAND_REQUEST_RESPONSE = wip_tab(indx).OMHA_REMAND_REQUEST_RESPONSE
, OMHA_WITHDRAW_FORM_SENT = wip_tab(indx).OMHA_WITHDRAW_FORM_SENT
, OMHA_WITHDRAW_FORM_RETURNED = wip_tab(indx).OMHA_WITHDRAW_FORM_RETURNED
, OMHA_NOTIFIED_OF_WITHDRAWL = wip_tab(indx).OMHA_NOTIFIED_OF_WITHDRAWL
, ALJ_WITHDRAWAL = wip_tab(indx).ALJ_WITHDRAWAL		
, DEMO_REOPENING_APPEAL_NUMBER = wip_tab(indx).DEMO_REOPENING_APPEAL_NUMBER
, REOPENING_ANALYSIS_COMPLETED = wip_tab(indx).REOPENING_ANALYSIS_COMPLETED
, REOPENING_ANALYSIS_OUTCOME = wip_tab(indx).REOPENING_ANALYSIS_OUTCOME
, NOT_PURSUED_BY_CONTR_REASON = wip_tab(indx).NOT_PURSUED_BY_CONTR_REASON
, ACK_LETTER_MAILED = wip_tab(indx).ACK_LETTER_MAILED
, REO_DECISION_LETTER_MAILED = wip_tab(indx).REO_DECISION_LETTER_MAILED
, REOPENING_OUTCOME = wip_tab(indx).REOPENING_OUTCOME
, DECLINE_TO_REOPEN_DECISION = wip_tab(indx).DECLINE_TO_REOPEN_DECISION
, APPEAL_ATTESTATION_DATE = wip_tab(indx).APPEAL_ATTESTATION_DATE
, APPEAL_ATTESTATION = wip_tab(indx).APPEAL_ATTESTATION
, DEMO_SCHEDULED = wip_tab(indx).DEMO_SCHEDULED
, DEMO_NOTIFICATION_LETTER_SENT = wip_tab(indx).DEMO_NOTIFICATION_LETTER_SENT
, RESPONSE_DUE	 = wip_tab(indx).RESPONSE_DUE
, RESPONSE_RECEIVED = wip_tab(indx).RESPONSE_RECEIVED
, DEMO_ACCEPTANCE_STATUS = wip_tab(indx).DEMO_ACCEPTANCE_STATUS
, TELE_DEMO_FOLLOW_UP = wip_tab(indx).TELE_DEMO_FOLLOW_UP
, DEMO_NOTIFICATION_LTR_RESENT = wip_tab(indx).DEMO_NOTIFICATION_LTR_RESENT
, RESCHEDULED_RESPONSE_DUE = wip_tab(indx).RESCHEDULED_RESPONSE_DUE
, RESCHEDULE_RESPONSE_RECEIVED = wip_tab(indx).RESCHEDULE_RESPONSE_RECEIVED
, VERBAL_CONFIRMATION = wip_tab(indx).VERBAL_CONFIRMATION
, RESCHEDULED_DEMO_STATUS = wip_tab(indx).RESCHEDULED_DEMO_STATUS
, PROVIDER_OR_SUPPLIER_NAME = wip_tab(indx).PROVIDER_OR_SUPPLIER_NAME	
, DEMO_CONFERENCE_STATUS = wip_tab(indx).DEMO_CONFERENCE_STATUS
, REVIEW_TYPE = wip_tab(indx).REVIEW_TYPE		
, EXPERT_REVIEW_DECISION = wip_tab(indx).EXPERT_REVIEW_DECISION		
, REVIEW_NUMBER	 = wip_tab(indx).REVIEW_NUMBER
          WHERE CEAP_ID  =  wip_tab(indx).CEAP_ID;


     EXCEPTION
        WHEN OTHERS THEN
          IF SQLCODE = -24381 THEN
            FOR i IN 1 .. SQL%BULK_EXCEPTIONS.COUNT LOOP
              v_err_code := SQL%BULK_EXCEPTIONS(i).ERROR_CODE; --SQLCODE;
              v_err_index := SQL%BULK_EXCEPTIONS(i).ERROR_INDEX;
              --v_err_msg := SUBSTR(SQLERRM, 1, 200);
              INSERT INTO corp_etl_error_log
              VALUES(SEQ_CEEL_ID.nextval,--CEEL_ID
                     sysdate,--ERR_DATE
                     'CRITICAL',--ERR_LEVEL
                     'ETL APPEAL',--PROCESS_NAME
                     'APPEAL_UPDATE_MAIN_TABLE',--JOB_NAME
                     '1',--NR_OF_ERROR
                     v_step, --||' '||v_err_msg,--ERROR_DESC
                     null,--ERROR_FIELD
                     v_err_code,--ERROR_CODES
                     sysdate,--CREATE_TS
                     sysdate,--UPDATE_TS
                     'CORP_ETL_APPEAL',--DRIVER_TABLE_NAME
                     v_err_index);--DRIVER_KEY_NUMBER
            END LOOP;
          END IF;
     END;
     COMMIT;
  END LOOP;
  COMMIT;
  CLOSE wip_cur;
END APPEAL_UPDATE_MAIN_TABLE;

END fedqic_etl_appeal_pkg;

/

alter session set plsql_code_type = interpreted;