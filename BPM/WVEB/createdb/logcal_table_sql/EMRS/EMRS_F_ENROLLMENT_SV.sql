select COALESCE(ss.network_id,(SELECT MAX(network_id) FROM network n, provider p WHERE n.provider_id = p.provider_id and p.provider_id_ext = ss.provider_id_ext),0) provider_number,
NULL as MEDICAID_BUY_IN_FEE, 
NULL as MEDICAID_BUY_IN_FEE_DATE, 
NULL as MEDICAID_RECERTIFICATION_DATE, 
1 as NUMBER_COUNT, 
ss.create_ts as DATE_CREATED, 
ss.created_by AS CREATED_BY, 
ss.updated_by AS UPDATED_BY,
NULL as MET_COST_SHARE_CAP_DATE, 
NULL as COST_SHARE_START_DATE,
NULL as COST_SHARE_END_DATE, 
NULL AS ENROLLMENT_FEE_FREQUENCY, 
NULL as CHIP_ANNUAL_ENROLL_DATE, 
NULL as SELECTION_SOURCE_ID, 
NULL as SELECTION_REASON_ID, 
NULL as AID_CATEGORY_ID, 
NULL as CITIZENSHIP_ID, 
ss.selection_segment_id as ENROLLMENT_GROUP_ID,
ss.selection_segment_id as SOURCE_RECORD_ID, 
NULL as PEOPLE_IN_FAMILY, 
NULL as ENROLLMENT_FEE_ASSESSED, 
NULL as ENROLLMENT_FEE_ASSESSED_DATE, 
NULL as ENROLLMENT_FEE_PAID, 
NULL as ENROLLMENT_FEE_PAID_DATE, 
NULL as CO_PAY_AMOUNT, 
'SELECTION_SEGMENT' AS SOURCE_TABLE_NAME, 
(SELECT LEAST(start_date,create_ts) eligibility_receipt_date FROM elig_segment_and_details 
 WHERE client_id = ss.client_id AND segment_type_cd = 'ME' AND ss.end_nd BETWEEN start_nd AND end_nd) as ELIGIBILITY_RECEIPT_DATE, 
COALESCE((SELECT case_id FROM client_supplementary_info cs WHERE cs.client_id = ss.client_id and cs.program_cd = ss.program_type_cd),0)  as CASE_NUMBER, 
ss.client_id as CLIENT_NUMBER, 
ss.selection_segment_id as ENROLLMENT_ID, 
NULL as CHANGE_REASON_ID, 
NULL as COMMUNICATION_TYPE_ID, 
NULL as COUNTY_ID, 
NULL as COVERAGE_CATEGORY_ID, 
NULL as CSDA_ID, 
NULL as DATE_PERIOD_ID, 
NULL as ENROLLMENT_ACTION_STATUS_ID, 
NULL as FPL_ID, 
NULL as LANGUAGE_CODE_ID, 
NULL as PLAN_ID, 
NULL as PROGRAM_ID, 
NULL as PROVIDER_TYPE_ID, 
NULL as RACE_ID, 
NULL as REJECTION_ERROR_REASON_ID, 
NULL as RISK_GROUP_ID, 
NULL as STAT_IN_GRP_ID, 
NULL as SUB_PROGRAM_ID, 
NULL as TERM_REASON_CODE_ID, 
NULL as TIME_PERIOD_ID, 
NULL as CERTIFICATION_DATE, 
NULL as CSDA_CHANGE_DATE, 
ss.status_date as ENROLLMENT_STATUS_CHANGE_DATE, 
NULL as JYEAR_OF_LAST_ENROLLMENT_FORM, 
ss.end_date as MANAGED_CARE_END_DATE, 
ss.start_date as MANAGED_CARE_START_DATE,
NULL as PLAN_TYPE_ID,
COALESCE((SELECT clnt_citizen FROM client cl WHERE cl.clnt_client_id = ss.client_id),'0') citizenship_code,
COALESCE((SELECT client_language FROM client cl WHERE cl.clnt_client_id = ss.client_id),'0') language_code,
COALESCE((SELECT clnt_race FROM client cl WHERE cl.clnt_client_id = ss.client_id),'0') race_code,
COALESCE((SELECT addr_county FROM client_supplementary_info cs WHERE cs.client_id = ss.client_id and cs.program_cd = ss.program_type_cd),'0') county_code,
'0' csda_code,
ss.program_type_cd program_code,
ss.plan_type_cd plan_type,
COALESCE((SELECT p.plan_code FROM plans p WHERE p.plan_id = ss.plan_id),'0') plan_code,
COALESCE(ss.disenroll_reason_cd_1,'0') change_reason_code,
ss.selection_source_cd selection_source_code,
ss.choice_reason_cd selection_reason_code,
CASE WHEN ss.selection_source_cd = 'ST' THEN 'DefaultEnroll' 
  ELSE '0' END enrollment_action_status_code,             
(SELECT plan_service_type_cd FROM contract ct WHERE ct.contract_id = ss.contract_id) sub_program_code,
--,COALESCE(tmp_provider.provider_type_code,'0') provider_code
COALESCE((SELECT type_cd FROM provider p WHERE p.provider_id_ext = ss.provider_id_ext),'0') provider_code,
'0' status_in_group_code,
'0' risk_group_code,
'0' coverage_category_code,
'0' aid_category_code,
'0' reason_code, --term reason code
'0' rejection_code
FROM selection_segment ss 
WHERE ss.create_ts >= add_months(trunc(sysdate,'mm'),-2)