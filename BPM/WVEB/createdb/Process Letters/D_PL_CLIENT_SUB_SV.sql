CREATE OR REPLACE FORCE VIEW D_PL_CLIENT_SUB_SV
AS
  SELECT DISTINCT
    --D_PL_CLIENT_SUB_SV
    LR.LMREQ_ID LETTER_REQUEST_ID,
    LR.CREATE_TS CREATE_DT,
    LL.CLIENT_ID CLIENT_ID,
    CS.ELIG_STATUS_CD,
    (SELECT report_label
    FROM eb.enum_subprogram_type
    WHERE value = CS.SUBPROGRAM_TYPE
    ) SUB_PROGRAM
  FROM eb.LETTER_REQUEST LR
  INNER JOIN eb.enum_lm_status st           ON lr.status_cd = st.value
  LEFT OUTER JOIN eb.LETTER_REQUEST_LINK LL ON LL.LMREQ_ID= LR.LMREQ_ID
  LEFT OUTER JOIN eb.CLIENT_ELIG_STATUS CS  ON CS.CLIENT_ID = LL.CLIENT_ID
  WHERE (LR.CREATE_TS >= (ADD_MONTHS(TRUNC(sysdate,'mm'),-2)) OR ST.DESCRIPTION NOT IN('Mailed','Combined similar Requests','Rejected','Voided','Errored','Canceled','Overcome by Events') ) AND cs.END_DATE IS NULL ;
 
  GRANT SELECT ON D_PL_CLIENT_SUB_SV TO EB_MAXDAT_REPORTS;
