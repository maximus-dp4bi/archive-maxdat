CREATE OR REPLACE VIEW EMRS_D_ADDRESS_SV
AS
  SELECT addr.addr_begin_date AS SOURCE_ADDR_BEGIN_DATE ,
    TO_CHAR(addr.last_update_date,'HH24MI') AS MODIFIED_TIME ,
    addr.creation_date AS DATE_CREATED ,
    addr.created_by AS CREATED_BY ,
    addr_id AS ADDRESS_ID ,
    addr_id AS SOURCE_RECORD_ID ,
    addr_street_1 AS ADDR_STREET_1 ,
    addr_street_2 AS ADDR_STREET_2 ,
    addr_city AS ADDR_CITY ,
    addr_state_cd AS ADDR_STATE_CD ,
    addr_zip AS ADDR_ZIP ,
    addr_zip_four AS ADDR_ZIP_FOUR ,
    addr_type_cd AS ADDR_TYPE_CD ,
    eat.description AS ADDR_TYPE ,
    addr.addr_country AS ADDR_COUNTRY ,
    addr.clnt_client_id AS CLIENT_NUMBER ,
    addr.addr_attn AS ADDR_ATTN ,
    addr.addr_house_code AS ADDR_HOUSE_CODE ,
    addr.addr_bar_code AS ADDR_BAR_CODE ,
    addr.addr_origin_cd AS ADDR_ORIGIN_CD ,
    addr.addr_staff_id AS ADDR_STAFF_ID ,
    addr.addr_ctlk_id AS ADDR_CTLK_ID ,
    addr.addr_dolk_id AS ADDR_DOLK_ID ,
    addr.addr_prov_id AS ADDR_PROV_ID ,
    addr.addr_payc_id AS ADDR_PAYC_ID ,
    addr.addr_verified AS ADDR_VERIFIED ,
    addr.addr_verified_date AS ADDR_VERIFIED_DATE ,
    addr.advy_id AS ADVY_ID ,
    addr.addr_bad_date AS ADDR_BAD_DATE ,
    addr.addr_bad_date_satisfied AS ADDR_BAD_DATE_SATISFIED ,
    addr.addr_case_id AS CASE_NUMBER ,
    addr.start_ndt AS START_NDT ,
    addr.end_ndt AS END_NDT ,
    addr.comparable_key AS COMPARABLE_KEY ,
    addr.creation_date AS RECORD_DATE ,
    TO_CHAR(addr.creation_date,'HH24MI') AS RECORD_TIME ,
    addr.created_by AS RECORD_NAME ,
    addr.last_update_date AS MODIFIED_DATE ,
    addr.last_updated_by AS MODIFIED_NAME ,
    addr_end_date AS SOURCE_ADDR_END_DATE
  FROM EB.ADDRESS addr
  JOIN EB.ENUM_ADDRESS_TYPE eat ON addr.addr_type_cd = eat.value ; 
  
  GRANT SELECT ON MAXDAT_LOOKUP.EMRS_D_ADDRESS_SV TO EB_MAXDAT_REPORTS;