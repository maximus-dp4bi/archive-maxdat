CREATE OR REPLACE VIEW D_STAFF_SV AS
select CAST(STAFF_ID AS VARCHAR2(80 BYTE)) STAFF_ID,
  EXT_STAFF_NUMBER,
  FIRST_NAME,
  MIDDLE_NAME,
  LAST_NAME,
  CASE WHEN LENGTH(TRIM(LAST_NAME)) < 1 THEN TRIM(FIRST_NAME) 
        WHEN LENGTH(TRIM(FIRST_NAME)) < 1 THEN TRIM(LAST_NAME)
        ELSE TRIM(FIRST_NAME) || ' ' || TRIM(LAST_NAME)  
  END AS FULL_NAME,
  START_DATE,
  END_DATE,
  CREATE_TS,
  UPDATE_TS,
  STAFF_TYPE_CD
from staff;

GRANT SELECT ON MAXDAT_SUPPORT.D_STAFF_SV TO MAXDAT_REPORTS; 