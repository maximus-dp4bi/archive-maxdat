-- paxtech-488 DETAIL QUERY
SELECT * FROM (
select * 
from D_SUBPROGRAM_SV
JOIN D_LETTER_DEFINITION_SV ON D_LETTER_DEFINITION_SV.LETTER_INVOICE_GROUP_CODE = 'HC' 
                            AND D_LETTER_DEFINITION_SV.PROJECT_CODE = 'MIEB'
                            and D_LETTER_DEFINITION_SV.PROGRAM_CODE = 'MEDICAID'
                            and D_LETTER_DEFINITION_SV.EFFECTIVE_FROM_DATE <= SYSDATE
                            and D_LETTER_DEFINITION_SV.EFFECTIVE_THRU_DATE >= SYSDATE
join D_SUBPROGRAM_CON_XWALK_SV ON D_SUBPROGRAM_CON_XWALK_SV.SUBPROGRAM_CODE = D_SUBPROGRAM_SV.SUBPROGRAM_CODE
JOIN F_LETTER_COUNTS_BY_DAY_SV ON F_LETTER_COUNTS_BY_DAY_SV.program_con_xwalk_code = D_SUBPROGRAM_CON_XWALK_SV.PROGRAM_CON_XWALK_CODE 
                                  AND F_LETTER_COUNTS_BY_DAY_SV.LETTER_DEFINITION_ID = D_LETTER_DEFINITION_SV.letter_definition_id 
WHERE F_LETTER_COUNTS_BY_DAY_SV.REPORT_DATE between to_date('10/1/2020','mm/dd/yyyy') and to_date('10/30/2020','mm/dd/yyyy')
and SYSDATE   between D_SUBPROGRAM_SV.START_DATE and D_SUBPROGRAM_SV.END_DATE and D_SUBPROGRAM_SV.PROGRAM_CODE = 'MEDICAID'
) WHERE LETTER_COUNT_BY_TOTAL <> 0


-- summary query
select D_SUBPROGRAM_SV.REPORT_LABEL, SUM( F_LETTER_COUNTS_BY_DAY_SV.LETTER_COUNT_BY_TOTAL) VOLUME, SUM(F_LETTER_COUNTS_BY_DAY_SV.NOF_FORM_ADJUSTMENTS) TOTAL_ADJS
from D_SUBPROGRAM_SV
JOIN D_LETTER_DEFINITION_SV ON D_LETTER_DEFINITION_SV.LETTER_INVOICE_GROUP_CODE = 'HC' 
                            AND D_LETTER_DEFINITION_SV.PROJECT_CODE = 'MIEB'
                            and D_LETTER_DEFINITION_SV.PROGRAM_CODE = 'MEDICAID'
                            and D_LETTER_DEFINITION_SV.EFFECTIVE_FROM_DATE <= SYSDATE
                            and D_LETTER_DEFINITION_SV.EFFECTIVE_THRU_DATE >= SYSDATE
join D_SUBPROGRAM_CON_XWALK_SV ON D_SUBPROGRAM_CON_XWALK_SV.SUBPROGRAM_CODE = D_SUBPROGRAM_SV.SUBPROGRAM_CODE
JOIN F_LETTER_COUNTS_BY_DAY_SV ON F_LETTER_COUNTS_BY_DAY_SV.program_con_xwalk_code = D_SUBPROGRAM_CON_XWALK_SV.PROGRAM_CON_XWALK_CODE 
                                  AND F_LETTER_COUNTS_BY_DAY_SV.LETTER_DEFINITION_ID = D_LETTER_DEFINITION_SV.letter_definition_id 
WHERE F_LETTER_COUNTS_BY_DAY_SV.REPORT_DATE between to_date('10/1/2020','mm/dd/yyyy') and to_date('10/30/2020','mm/dd/yyyy')
and SYSDATE   between D_SUBPROGRAM_SV.START_DATE and D_SUBPROGRAM_SV.END_DATE and D_SUBPROGRAM_SV.PROGRAM_CODE = 'MEDICAID'
GROUP BY D_SUBPROGRAM_SV.REPORT_LABEL
