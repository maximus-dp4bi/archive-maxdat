CREATE OR REPLACE TRIGGER TRG_R_corp_etl_PROC_LETTER 
BEFORE INSERT OR UPDATE ON CORP_ETL_PROC_LETTERS FOR EACH ROW
BEGIN
  IF Inserting THEN
    IF :NEW.CEPN_ID IS NULL THEN
      SELECT SEQ_CEPN_ID.Nextval INTO :NEW.CEPN_ID FROM Dual;
    END IF;
    IF :NEW.stg_extract_date IS NULL THEN
      :NEW.stg_extract_date  := SYSDATE;
    END IF;
  END IF;
  :NEW.STG_LAST_UPDATE_DATE := SYSDATE;
END;
/

CREATE OR REPLACE TRIGGER TRG_R_corp_etl_PROC_LTR_OLTP BEFORE
INSERT OR UPDATE ON CORP_ETL_PROC_LETTERS_OLTP FOR EACH ROW
BEGIN
  IF Inserting THEN
    IF :NEW.stg_extract_date IS NULL THEN
      :NEW.stg_extract_date  := SYSDATE;
    END IF;
  END IF;
  :NEW.STG_LAST_UPDATE_DATE := SYSDATE;
END;
/

CREATE OR REPLACE TRIGGER TRG_R_corp_etl_PROC_LTR_WIP 
BEFORE INSERT OR UPDATE ON CORP_ETL_PROC_LETTERS_WIP_BPM FOR EACH ROW
BEGIN
  IF Inserting THEN
    IF :NEW.stg_extract_date IS NULL THEN
      :NEW.stg_extract_date  := SYSDATE;
    END IF;
  END IF;
  :NEW.STG_LAST_UPDATE_DATE := SYSDATE;
END;
/
