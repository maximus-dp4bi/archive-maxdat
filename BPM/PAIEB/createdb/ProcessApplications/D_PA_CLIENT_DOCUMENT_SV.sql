CREATE OR REPLACE VIEW MAXDAT_SUPPORT.D_PA_CLIENT_DOCUMENT_SV
AS 
SELECT
A.APPLICATION_ID AS APPLICATION_ID,
A.STATUS_CD AS STATUS_CD,
A.CREATE_TS AS CREATE_TS,
AE.PHY_CERT_STATUS AS PHY_CERT_STATUS,
AE.LCD_LEVEL_CARE AS LCD_LEVEL_CARE,
ae.LCD_SUPERVISOR_SIGN_DATE AS LCD_SUPERVISOR_SIGN_DATE,
D.DOC_TYPE_CD AS DOC_TYPE_CD,
D.DOC_FORM_TYPE AS DOC_FORM_TYPE,
D.CREATE_TS AS D_CREATE_TS,
dl.client_id AS CLIENT_ID,
dl.document_id AS DOCUMENT_ID,
d.dcn AS DCN,
cl.clnt_generic_field5_txt AS HARMONY_CASE_ID, 
CASE WHEN LENGTH(TRIM(cl.clnt_lname)) < 1 THEN TRIM(cl.clnt_fname) 
        WHEN LENGTH(TRIM(cl.clnt_fname)) < 1 THEN TRIM(cl.clnt_lname)
        ELSE TRIM(cl.clnt_lname) || ', ' || TRIM(cl.clnt_fname) 
        END AS FULL_NAME
FROM APP_STATUS_HISTORY A
LEFT JOIN APP_HEADER_EXT AE ON AE.APPLICATION_ID = A.APPLICATION_ID
LEFT JOIN APP_INDIVIDUAL AL ON AL.APPLICATION_ID = A.APPLICATION_ID
LEFT JOIN DOC_LINK DL ON DL.CLIENT_ID = AL.CLIENT_ID
LEFT JOIN CLIENT CL ON CL.CLNT_CLIENT_ID = AL.CLIENT_ID
LEFT JOIN DOCUMENT D ON D.DOCUMENT_ID = DL.DOCUMENT_ID
WHERE 
A.CREATE_TS > '20-MAY-17';
              
GRANT SELECT ON MAXDAT_SUPPORT.D_PA_CLIENT_DOCUMENT_SV TO MAXDATSUPPORT_READ_ONLY;

GRANT SELECT ON MAXDAT_SUPPORT.D_PA_CLIENT_DOCUMENT_SV TO MAXDAT_REPORTS;
