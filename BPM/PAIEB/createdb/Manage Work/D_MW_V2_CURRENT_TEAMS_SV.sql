CREATE OR REPLACE VIEW D_MW_V2_CURRENT_TEAMS_SV
AS
  SELECT g.GROUP_ID AS TEAM_ID ,
    g.GROUP_NAME AS TEAM_NAME ,
    g.DESCRIPTION AS TEAM_DESCRIPTION,
    COALESCE(s.staff_id, s2.staff_id, 0) as TEAM_SUPERVISOR_STAFF_ID,
    g.PARENT_GROUP_ID AS PARENT_TEAM_ID 
  FROM ATS.GROUPS g
  LEFT JOIN staff s ON (s.ext_staff_number = TO_CHAR(g.SUPERVISOR_STAFF_ID))
  LEFT JOIN staff s2 ON (s2.staff_id = g.SUPERVISOR_STAFF_ID)
  WHERE type_cd = 'TEAM';

GRANT SELECT on MAXDAT_SUPPORT.D_MW_V2_CURRENT_TEAMS_SV to MAXDAT_REPORTS ;