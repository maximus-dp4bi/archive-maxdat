CREATE OR REPLACE VIEW D_PI_CASE_SV
AS
  SELECT CS.CASE_ID ,
    CS.CASE_CIN ,
    CS.CASE_HEAD_FNAME ,
    CS.CASE_HEAD_LNAME,
    CASE WHEN LENGTH(TRIM(CS.CASE_HEAD_LNAME)) < 1 THEN TRIM(CS.CASE_HEAD_FNAME) 
          WHEN LENGTH(TRIM(CS.CASE_HEAD_FNAME)) < 1 THEN TRIM(CS.CASE_HEAD_LNAME)
          ELSE TRIM(CS.CASE_HEAD_LNAME) || ', ' || TRIM(CS.CASE_HEAD_FNAME) 
          END AS CASE_FULL_NAME
  FROM ats.cases cs
  UNION ALL
  SELECT 0,
    NULL AS CASE_CIN,
    NULL AS CASE_HEAD_FNAME,
    NULL AS CASE_HEAD_LNAME,
    NULL AS FULL_NAME
   FROM DUAL;
  
  GRANT SELECT ON MAXDAT_SUPPORT.D_PI_CASE_SV TO MAXDAT_REPORTS ;
  