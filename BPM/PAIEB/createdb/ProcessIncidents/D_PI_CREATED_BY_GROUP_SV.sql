CREATE OR REPLACE VIEW D_PI_CREATED_BY_GROUP_SV
AS
  SELECT g.GROUP_ID AS TEAM_ID ,
    g.type_cd,
    g.GROUP_NAME AS TEAM_NAME ,
    g.DESCRIPTION AS TEAM_DESCRIPTION,
    COALESCE(TO_CHAR(g.SUPERVISOR_STAFF_ID), '0') AS TEAM_SUPERVISOR_STAFF_ID ,
    g.PARENT_GROUP_ID AS PARENT_TEAM_ID 
  FROM ATS.GROUPS g
  UNION ALL
  SELECT 0 AS TEAM_ID ,
    'TEAM' AS type_cd,
    NULL AS TEAM_NAME ,
    NULL AS TEAM_DESCRIPTION,
    '0' AS TEAM_SUPERVISOR_STAFF_ID ,
    0 AS PARENT_TEAM_ID 
    FROM DUAL;

GRANT SELECT on MAXDAT_SUPPORT.D_PI_CREATED_BY_GROUP_SV to MAXDAT_REPORTS ;