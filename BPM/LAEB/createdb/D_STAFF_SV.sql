DROP VIEW MAXDAT_SUPPORT.D_STAFF_SV;

CREATE OR REPLACE VIEW MAXDAT_SUPPORT.D_STAFF_SV
AS
SELECT UPDATE_TS ,
      CREATE_TS ,
      END_DATE ,
      START_DATE ,
      ext_staff_number AS staff_id ,
      MIDDLE_NAME ,
      FIRST_NAME ,
      EXT_STAFF_NUMBER ,
      LAST_NAME,
      CASE WHEN LENGTH(TRIM(LAST_NAME)) IS NULL THEN TRIM(FIRST_NAME) 
            WHEN LENGTH(TRIM(FIRST_NAME)) IS NULL THEN TRIM(LAST_NAME)
            ELSE TRIM(LAST_NAME) || ', ' || TRIM(FIRST_NAME) 
            END AS FULL_NAME
  FROM staff 
  UNION
  SELECT UPDATE_TS ,
      CREATE_TS ,
      END_DATE ,
      START_DATE ,
      TO_CHAR(staff_id) AS staff_id ,
      MIDDLE_NAME ,
      FIRST_NAME ,
      EXT_STAFF_NUMBER ,
      LAST_NAME,
      CASE WHEN LENGTH(TRIM(LAST_NAME)) < 1 THEN TRIM(FIRST_NAME) 
            WHEN LENGTH(TRIM(FIRST_NAME)) < 1 THEN TRIM(LAST_NAME) 
            ELSE TRIM(LAST_NAME) || ', ' || TRIM(FIRST_NAME) 
            END AS FULL_NAME
  FROM staff 
UNION  
  SELECT to_date('01/01/1985', 'mm/dd/yyyy') AS UPDATE_TS ,
    to_date('01/01/1985', 'mm/dd/yyyy') AS CREATE_TS ,
    to_date('01/01/1985', 'mm/dd/yyyy') AS END_DATE ,
    to_date('01/01/1985', 'mm/dd/yyyy') AS START_DATE ,
    '0' AS STAFF_ID ,
    NULL AS MIDDLE_NAME ,
    NULL AS FIRST_NAME ,
    NULL AS EXT_STAFF_NUMBER ,
    NULL AS LAST_NAME,
    NULL AS FULL_NAME
  FROM DUAL;

GRANT SELECT ON MAXDAT_SUPPORT.D_STAFF_SV TO DP4BI_READ_ONLY;
GRANT SELECT ON MAXDAT_SUPPORT.D_STAFF_SV TO GT83345;
GRANT SELECT ON MAXDAT_SUPPORT.D_STAFF_SV TO MAXDATSUPPORT_READ_ONLY;
GRANT SELECT ON MAXDAT_SUPPORT.D_STAFF_SV TO MAXDAT_SUPPORT_READ_ONLY;
