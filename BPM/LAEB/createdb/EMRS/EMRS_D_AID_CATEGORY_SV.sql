DROP VIEW MAXDAT_SUPPORT.EMRS_D_AID_CATEGORY_SV;

CREATE OR REPLACE VIEW MAXDAT_SUPPORT.EMRS_D_AID_CATEGORY_SV
AS
SELECT
    value AS AID_CATEGORY_CODE ,
    description AS AID_CATEGORY_NAME,
    CASE
      WHEN effective_end_date IS NULL
      THEN 'A'
      ELSE 'I'
    END AS ACTIVE_INACTIVE ,
    COALESCE(effective_start_date, TO_DATE('01/01/1900','MM/DD/YYYY'))AS START_DATE ,
    COALESCE(effective_end_date,TO_DATE('12/31/2050','MM/DD/YYYY')) AS END_DATE,
    COALESCE(scope,'MEDICAID') AS MANAGED_CARE_PROGRAM,
    COALESCE(subprogram_codes, 'UD') AS SUBPROGRAM_CODE
  FROM eb.enum_aid_category;

GRANT SELECT ON MAXDAT_SUPPORT.EMRS_D_AID_CATEGORY_SV TO DP4BI_READ_ONLY;
GRANT SELECT ON MAXDAT_SUPPORT.EMRS_D_AID_CATEGORY_SV TO MAXDATSUPPORT_READ_ONLY;
GRANT SELECT ON MAXDAT_SUPPORT.EMRS_D_AID_CATEGORY_SV TO MAXDAT_SUPPORT_READ_ONLY;
