DROP VIEW MAXDAT_SUPPORT.EMRS_D_ZIPCODE_SV;

CREATE OR REPLACE VIEW MAXDAT_SUPPORT.EMRS_D_ZIPCODE_SV
AS
SELECT z.value AS ZIP_CODE,
    z.attrib_city AS ZIP_CITY,
    z.attrib_county AS ZIP_COUNTY,
    z.attrib_state AS ZIP_STATE,
    DECODE(z.covers_multiple_county_ind,1,'Y','N') AS COVERS_MULTIPLE_COUNTY,
    l.latitude AS LATITUDE,
    l.longitude AS LONGITUDE   
  FROM eb.enum_zipcode z
  LEFT JOIN maxdat_support.emrs_d_zip_locations l ON (z.value = l.zip_code)
  UNION
  SELECT '0' AS ZIP_CODE,
    'Unknown' AS ZIP_CITY,
    '0' AS ZIP_COUNTY,
    'NA' AS ZIP_STATE,
    'N' AS COVERS_MULTIPLE_COUNTY,
    NULL AS LATITUDE,
    NULL AS LONGITUDE
  FROM DUAL;

GRANT SELECT ON MAXDAT_SUPPORT.EMRS_D_ZIPCODE_SV TO DP4BI_READ_ONLY;
GRANT SELECT ON MAXDAT_SUPPORT.EMRS_D_ZIPCODE_SV TO MAXDATSUPPORT_READ_ONLY;
GRANT SELECT ON MAXDAT_SUPPORT.EMRS_D_ZIPCODE_SV TO MAXDAT_SUPPORT_READ_ONLY;
