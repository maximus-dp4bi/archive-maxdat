DROP VIEW MAXDAT_SUPPORT.EMRS_D_CARE_SERV_DELIV_AREA_SV;

CREATE OR REPLACE VIEW MAXDAT_SUPPORT.EMRS_D_CARE_SERV_DELIV_AREA_SV
AS
SELECT 
    VALUE AS CSDA_CODE ,
    DESCRIPTION AS CSDA_NAME ,
    CASE WHEN VALUE IN(2,9) THEN 1
          WHEN VALUE IN(1,3) THEN 2
          WHEN VALUE IN(7,8) THEN 3
          WHEN VALUE IN(4,5,6) THEN 4
          ELSE -1
    END AS REGION_ID,
    CASE
      WHEN effective_end_date IS NULL
      THEN 'A'
      ELSE 'I'
    END AS STATUS ,
    effective_start_date AS EFFECTIVE_START_DATE,
    effective_end_date AS EFFECTIVE_END_DATE
  FROM eb.enum_district
  UNION ALL
  SELECT 
    '-1' AS CSDA_CODE ,
    'Not Defined' AS CSDA_NAME ,
    -1 AS REGION_ID,
    'A' AS STATUS ,
    to_date('01/01/1900', 'mm/dd/yyyy')AS EFFECTIVE_START_DATE,
    NULL AS EFFECTIVE_END_DATE
    FROM DUAL;

GRANT SELECT ON MAXDAT_SUPPORT.EMRS_D_CARE_SERV_DELIV_AREA_SV TO DP4BI_READ_ONLY;
GRANT SELECT ON MAXDAT_SUPPORT.EMRS_D_CARE_SERV_DELIV_AREA_SV TO MAXDATSUPPORT_READ_ONLY;
GRANT SELECT ON MAXDAT_SUPPORT.EMRS_D_CARE_SERV_DELIV_AREA_SV TO MAXDAT_SUPPORT_READ_ONLY;
