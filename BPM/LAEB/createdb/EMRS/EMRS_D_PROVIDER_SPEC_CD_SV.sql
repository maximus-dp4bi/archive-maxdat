DROP VIEW MAXDAT_SUPPORT.EMRS_D_PROVIDER_SPEC_CD_SV;

CREATE OR REPLACE VIEW MAXDAT_SUPPORT.EMRS_D_PROVIDER_SPEC_CD_SV
AS
SELECT 
      ps.value PROVIDER_SPECIALTY_CODE ,
      ps.description PROVIDER_SPECIALTY ,
      ps.effective_start_date AS EFFECTIVE_START_DATE,
      ps.effective_end_date AS EFFECTIVE_END_DATE
    FROM eb.enum_provider_specialty ps
  UNION
  SELECT '0' PROVIDER_SPECIALTY_CODE ,
      'Not Defined' PROVIDER_SPECIALTY ,
      TO_DATE('01/01/1900', 'mm\dd\yyyy') AS EFFECTIVE_START_DATE,
      NULL AS EFFECTIVE_END_DATE
  FROM DUAL;

GRANT SELECT ON MAXDAT_SUPPORT.EMRS_D_PROVIDER_SPEC_CD_SV TO DP4BI_READ_ONLY;
GRANT SELECT ON MAXDAT_SUPPORT.EMRS_D_PROVIDER_SPEC_CD_SV TO MAXDATSUPPORT_READ_ONLY;
GRANT SELECT ON MAXDAT_SUPPORT.EMRS_D_PROVIDER_SPEC_CD_SV TO MAXDAT_SUPPORT_READ_ONLY;
