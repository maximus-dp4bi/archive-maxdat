DELETE FROM MAXDAT.CORP_ETL_CONTROL 
WHERE NAME = 'MAX_MAXHIX_RESCAN_DATA_INFO_UPDATED_TS';


INSERT INTO MAXDAT.CORP_ETL_CONTROL (
--   CREATED_TS, UPDATED_TS, 
   VALUE_TYPE, 
   NAME, VALUE, DESCRIPTION) 
VALUES ( 
'D' 							/* VALUE_TYPE */,
'MAX_MAXHIX_RESCAN_DATA_INFO_UPDATED_TS' /* NAME */,
'2000/01/01 00:00:00' /* VALUE */,
'LAST UPDATED_TS IN MAXHIX_RESCAN_DATA_INFO_STG'  /* DESCRIPTION */ );

COMMIT;

select * from MAXDAT.CORP_ETL_CONTROL
where name = 'MAX_MAXHIX_RESCAN_DATA_INFO_UPDATED_TS';


DROP TABLE MAXDAT.MAXHIX_RESCAN_DATA_INFO_OLTP;

CREATE TABLE MAXDAT.MAXHIX_RESCAN_DATA_INFO_OLTP
(
  RESCAN_DATA_INFO_ID  NUMBER(18)               NOT NULL,
  DOCUMENT_SET_ID      NUMBER(18)               NOT NULL,
  ECN                  VARCHAR2(256 BYTE),
  RESCAN_REQ_DATE      DATE,
  RESCAN_IND           NUMBER(1),
  CREATED_BY           VARCHAR2(50 BYTE),
  CREATED_TS           DATE,
  UPDATED_BY           VARCHAR2(50 BYTE),
  UPDATED_TS           DATE
)
TABLESPACE MAXDAT_DATA;

GRANT SELECT ON MAXDAT.MAXHIX_RESCAN_DATA_INFO_OLTP TO MAXDAT_READ_ONLY;


DROP TABLE MAXDAT.MAXHIX_RESCAN_DATA_INFO_STG CASCADE CONSTRAINTS;

CREATE TABLE MAXDAT.MAXHIX_RESCAN_DATA_INFO_STG
(
  RESCAN_DATA_INFO_ID  NUMBER(18)               NOT NULL,
  DOCUMENT_SET_ID      NUMBER(18)               NOT NULL,
  ECN                  VARCHAR2(256 BYTE),
  RESCAN_REQ_DATE      DATE,
  RESCAN_IND           NUMBER(1),
  CREATED_BY           VARCHAR2(50 BYTE),
  CREATED_TS           DATE,
  UPDATED_BY           VARCHAR2(50 BYTE),
  UPDATED_TS           DATE
)
TABLESPACE MAXDAT_DATA;


CREATE UNIQUE INDEX MAXDAT.MAXHIX_RESCAN_DATA_INFO_IDX ON MAXDAT.MAXHIX_RESCAN_DATA_INFO_STG
(RESCAN_DATA_INFO_ID)
TABLESPACE MAXDAT_INDX;

ALTER TABLE MAXDAT.MAXHIX_RESCAN_DATA_INFO_STG ADD (
  CONSTRAINT MAXHIX_RESCAN_DATA_INFO_PK
  PRIMARY KEY
  (RESCAN_DATA_INFO_ID)
  USING INDEX MAXDAT.MAXHIX_RESCAN_DATA_INFO_IDX
  ENABLE VALIDATE);


CREATE INDEX MAXDAT.RESCAN_DATA_INFO_CREATED_TS_IDX ON MAXDAT.MAXHIX_RESCAN_DATA_INFO_STG
(CREATED_TS)
TABLESPACE MAXDAT_INDX;

CREATE INDEX MAXDAT.RESCAN_DATA_INFO_DOC_SET_IDX ON MAXDAT.MAXHIX_RESCAN_DATA_INFO_STG
(DOCUMENT_SET_ID)
TABLESPACE MAXDAT_INDX;

CREATE INDEX MAXDAT.RESCAN_DATA_INFO_ECN_IDX ON MAXDAT.MAXHIX_RESCAN_DATA_INFO_STG
(ECN)
TABLESPACE MAXDAT_INDX;

CREATE INDEX MAXDAT.RESCAN_DATA_INFO_UPDATED_TS_IDX ON MAXDAT.MAXHIX_RESCAN_DATA_INFO_STG
(UPDATED_TS)
TABLESPACE MAXDAT_INDX;

GRANT INSERT, SELECT, UPDATE ON MAXDAT.MAXHIX_RESCAN_DATA_INFO_STG TO MAXDAT_OLTP_SIU;

GRANT DELETE, INSERT, SELECT, UPDATE ON MAXDAT.MAXHIX_RESCAN_DATA_INFO_STG TO MAXDAT_OLTP_SIUD;

GRANT SELECT ON MAXDAT.MAXHIX_RESCAN_DATA_INFO_STG TO MAXDAT_READ_ONLY;
