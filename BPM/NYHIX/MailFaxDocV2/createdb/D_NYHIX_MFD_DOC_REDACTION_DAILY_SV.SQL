CREATE OR REPLACE VIEW MAXDAT.D_NYHIX_MFD_DOC_REDACTION_DAILY_SV
( CREATE_DT, REDACTION_REASON, REASON, CNT)
AS
SELECT TRUNC(DOC.CREATE_TS) CREATE_DT, 
	REDACTION_REASON, 
	REPORT_LABEL AS REASON, 
	COUNT(DISTINCT APP_DOC_REDACTION_DATA_ID) AS CNT
FROM APP_DOC_REDACTION_REASON DOC
JOIN ENUM_APP_DOC_REDACTION_REASON ENUM
ON DOC.REDACTION_REASON = ENUM.VALUE
GROUP BY TRUNC(DOC.CREATE_TS), REDACTION_REASON, REPORT_LABEL  
ORDER BY TRUNC(DOC.CREATE_TS), REDACTION_REASON;

GRANT SELECT ON D_NYHIX_MFD_DOC_REDACTION_DAILY_SV TO MAXDAT_REPORTS;

GRANT SELECT ON D_NYHIX_MFD_DOC_REDACTION_DAILY_SV TO MAXDAT_READ_ONLY;