/* Formatted on 12/28/2022 2:23:38 PM (QP5 v5.374) */
CREATE OR REPLACE FORCE VIEW MAXDAT.D_MFBBATCH_EVENTS_CURMOD_SV
(
    CURRENT_BATCH_MODULE_ID,
    BATCH_GUID,
    MODULE_LAUNCH_ID,
    MODULE_UNIQUE_ID,
    MODULE_NAME,
    MODULE_CLOSE_UNIQUE_ID,
    MODULE_CLOSE_NAME,
    BATCH_STATUS,
    MODULE_START_DT,
    MODULE_END_DT,
    MODULE_LAUNCH_USER_NAME,
    STATION_ID,
    SITE_NAME,
    SITE_ID,
    BATCH_DELETED,
    PAGES_PER_DOCUMENT,
    PAGES_SCANNED,
    PAGES_DELETED,
    DOCUMENTS_CREATED,
    DOCUMENTS_DELETED,
    PAGES_REPLACED,
    SOURCE_SERVER,
    ERROR_TEXT
)
BEQUEATH DEFINER
AS
    SELECT                     -- FIELD NAMES FROM D_MFBBATCH_EVENTS_CURMOD_SV
           c.CURRENT_BATCH_MODULE_ID,               --CURRENT_BATCH_MODULE_ID,
           c.BATCH_GUID,                                         --BATCH_GUID,
           e.MODULE_LAUNCH_ID,                             --MODULE_LAUNCH_ID,
           e.MODULE_UNIQUE_ID,                             --MODULE_UNIQUE_ID,
           e.MODULE_NAME                        AS MODULE_NAME, --MODULE_NAME,
           e.MODULE_CLOSE_UNIQUE_ID             AS MODULE_CLOSE_UNIQUE_ID, --MODULE_CLOSE_UNIQUE_ID,
           e.MODULE_CLOSE_NAME,                           --MODULE_CLOSE_NAME,
           TO_NUMBER (e.BATCH_STATUS)           AS BATCH_STATUS,
           e.START_DATE_TIME                    AS MODULE_START_DT, --MODULE_START_DT,
           e.END_DATE_TIME                      AS MODULE_END_DT, --MODULE_END_DT,
           e.USER_NAME                          AS MODULE_LAUNCH_USER_NAME, --MODULE_LAUNCH_USER_NAME,
           e.STATION_ID,                                         --STATION_ID,
           e.SITE_NAME,                                           --SITE_NAME,
           e.SITE_ID,                                               --SITE_ID,
           e.DELETED                            AS BATCH_DELETED, --BATCH_DELETED,
           TO_NUMBER (e.PAGES_PER_DOCUMENT)     AS PAGES_PER_DOCUMENT, --PAGES_PER_DOCUMENT,
           TO_NUMBER (e.PAGES_SCANNED),                       --PAGES_SCANNED,
           TO_NUMBER (e.PAGES_DELETED),                       --PAGES_DELETED,
           TO_NUMBER (e.DOCUMENTS_CREATED)      AS DOCUMENTS_CREATED, --DOCUMENTS_CREATED,
           TO_NUMBER (e.DOCUMENTS_DELETED)      AS DOCUMENTS_DELETED, --DOCUMENTS_DELETED,
           TO_NUMBER (e.PAGES_REPLACED),                     --PAGES_REPLACED,
           e.SOURCE_SERVER,                                   --SOURCE_SERVER,
           e.ERROR_TEXT                                           --ERROR_TEXT
      FROM maxdat.NYHIX_MFB_V2_BATCH_EVENT    e,
           maxdat.NYHIX_MFB_V2_BATCH_SUMMARY  c
     WHERE e.BATCH_MODULE_ID = c.CURRENT_BATCH_MODULE_ID
WITH READ ONLY;


/* Formatted on 12/28/2022 2:23:38 PM (QP5 v5.374) */
CREATE OR REPLACE FORCE VIEW MAXDAT.D_MFBBATCH_EVENTS_CURRENT_SV
(
    BATCH_MODULE_ID,
    BATCH_GUID,
    MODULE_LAUNCH_ID,
    MODULE_UNIQUE_ID,
    MODULE_NAME,
    MODULE_CLOSE_UNIQUE_ID,
    MODULE_CLOSE_NAME,
    BATCH_STATUS,
    MODULE_START_DT,
    MODULE_END_DT,
    MODULE_LAUNCH_USER_NAME,
    STATION_ID,
    SITE_NAME,
    SITE_ID,
    BATCH_DELETED,
    PAGES_PER_DOCUMENT,
    PAGES_SCANNED,
    PAGES_DELETED,
    DOCUMENTS_CREATED,
    DOCUMENTS_DELETED,
    PAGES_REPLACED,
    SOURCE_SERVER,
    ERROR_TEXT
)
BEQUEATH DEFINER
AS
    SELECT BATCH_MODULE_ID                    AS BATCH_MODULE_ID,
           BATCH_GUID                         AS BATCH_GUID,
           MODULE_LAUNCH_ID                   AS MODULE_LAUNCH_ID,
           MODULE_UNIQUE_ID                   AS MODULE_UNIQUE_ID,
           MODULE_NAME                        AS MODULE_NAME,
           MODULE_CLOSE_UNIQUE_ID             AS MODULE_CLOSE_UNIQUE_ID,
           MODULE_CLOSE_NAME                  AS MODULE_CLOSE_NAME,
           TO_NUMBER (BATCH_STATUS)           AS BATCH_STATUS,
           START_DATE_TIME                    AS MODULE_START_DT,
           END_DATE_TIME                      AS MODULE_END_DT,
           USER_NAME                          AS MODULE_LAUNCH_USER_NAME,
           STATION_ID                         AS STATION_ID,
           SITE_NAME                          AS SITE_NAME,
           SITE_ID                            AS SITE_ID,
           DELETED                            AS BATCH_DELETED,
           TO_NUMBER (PAGES_PER_DOCUMENT)     AS PAGES_PER_DOCUMENT,
           TO_NUMBER (PAGES_SCANNED)          AS PAGES_SCANNED,
           TO_NUMBER (PAGES_DELETED)          AS PAGES_DELETED,
           TO_NUMBER (DOCUMENTS_CREATED)      AS DOCUMENTS_CREATED,
           TO_NUMBER (DOCUMENTS_DELETED)      AS DOCUMENTS_DELETED,
           PAGES_REPLACED                     AS PAGES_REPLACED,
           SOURCE_SERVER                      AS SOURCE_SERVER,
           ERROR_TEXT                         AS ERROR_TEXT
      FROM MAXDAT.NYHIX_MFB_V2_BATCH_EVENT;


/* Formatted on 12/28/2022 2:23:38 PM (QP5 v5.374) */
CREATE OR REPLACE FORCE VIEW MAXDAT.D_MFBDOC_CURRENT_SV
(
    ECN,
    BATCH_GUID,
    DOCUMENT_ID,
    DCN,
    DOC_ORDER_NUMBER,
    TYPE_NAME,
    DOCUMENT_CLASS,
    DOCUMENT_RECEIPT_DT,
    DOCUMENT_CREATION_DT,
    DOCUMENT_PAGE_COUNT,
    CLASSIFIED_DOCUMENT,
    DELETED,
    CONFIDENCE,
    CONFIDENT
)
BEQUEATH DEFINER
AS
    SELECT ECN                        AS ECN,
           BATCH_GUID                 AS BATCH_GUID,
           DOCUMENT_NUMBER            AS DOCUMENT_ID,
           DCN                        AS DCN,
           ORDERNUMBER                AS DOC_ORDER_NUMBER,
           FORM_TYPE                  AS TYPE_NAME,
           DOC_CLASS                  AS DOCUMENT_CLASS,
           DOC_RECEIPT_DT             AS DOCUMENT_RECEIPT_DT,
           DOC_CREATION_DT            AS DOCUMENT_CREATION_DT,
           DOC_PAGE_COUNT             AS DOCUMENT_PAGE_COUNT,
           CLASSIFIED_DOC             AS CLASSIFIED_DOCUMENT,
           DELETED                    AS DELETED,
           TO_NUMBER (CONFIDENCE)     AS CONFIDENCE,
           CONFIDENT                  AS CONFIDENT
      FROM MAXDAT.NYHIX_MFB_V2_DOCUMENT;


DROP VIEW MAXDAT.D_MFB_CURRENT_MFD_DCN_SV;

/* Formatted on 12/28/2022 2:23:38 PM (QP5 v5.374) */
CREATE OR REPLACE FORCE VIEW MAXDAT.D_MFB_CURRENT_MFD_DCN_SV
(
    NYHIX_MFD_BI_ID,
    MFB_BI_ID
)
BEQUEATH DEFINER
AS
    SELECT DD.NYHIX_MFD_BI_ID     AS NYHIX_MFD_BI_ID,
           B2.MFB_V2_BI_ID        AS MFB_BI_ID
      FROM NYHIX_MFB_V2_BATCH_SUMMARY  B2
           JOIN D_NYHIX_MFD_CURRENT_V2 DD ON (B2.BATCH_NAME = DD.BATCH_NAME)
WITH READ ONLY;


/* Formatted on 12/28/2022 2:23:38 PM (QP5 v5.374) */
CREATE OR REPLACE FORCE VIEW MAXDAT.D_MFB_CURRENT_SV
(
MFB_BI_ID,
BATCH_GUID,
BATCH_ID,
BATCH_NAME,
CREATION_STATION_ID,
BATCH_CREATED_BY,
CREATION_USER_ID,
BATCH_CLASS,
BATCH_CLASS_DESCRIPTION,
BATCH_TYPE,
CREATE_DT,
COMPLETE_DT,
INSTANCE_STATUS,
INSTANCE_STATUS_DT,
BATCH_PAGE_COUNT,
BATCH_DOC_COUNT,
BATCH_ENVELOPE_COUNT,
CANCEL_DT,
CANCEL_BY,
CANCEL_REASON,
CANCEL_METHOD,
SCAN_BATCH_FLAG,
PERFORM_SCAN_START,
PERFORM_SCAN_END,
PERFORM_SCAN_PERFORMED_BY,
PERFORM_QC_FLAG,
PERFORM_QC_START,
PERFORM_QC_END,
PERFORM_QC_PERFORMED_BY,
KOFAX_QC_REASON,
CLASSIFICATION_FLAG,
CLASSIFICATION_START,
CLASSIFICATION_END,
CLASSIFICATION_DT,
RECOGNITION_FLAG,
RECOGNITION_START,
RECOGNITION_END,
RECOGNITION_DT,
VALIDATE_DATA_FLAG,
VALIDATE_DATA_START,
VALIDATE_DATA_END,
VALIDATE_DATA_PERFORMED_BY,
VALIDATE_DATA_PERF_BY_USER_ID,
VALIDATION_DT,
CREATE_PDF_FLAG,	
CREATE_PDFS_START,
CREATE_PDFS_END,
POPULATE_REPORTS_DATA_FLAG,
POPULATE_REPORTS_DATA_START,
POPULATE_REPORTS_DATA_END,
RELEASE_TO_DMS_FLAG,
RELEASE_TO_DMS_START,
RELEASE_TO_DMS_END,
BATCH_PRIORITY,
BATCH_DELETED,
PAGES_SCANNED,
DOCUMENTS_CREATED,
DOCUMENTS_DELETED,
PAGES_REPLACED_FLAG,
PAGES_DELETED_FLAG,
AGE_IN_BUSINESS_DAYS,
AGE_IN_CALENDAR_DAYS,
TIMELINESS_STATUS,
TIMELINESS_DAYS,
TIMELINESS_DAYS_TYPE,
TIMELINESS_DT,
JEOPARDY_FLAG,
JEOPARDY_DAYS,
JEOPARDY_DAYS_TYPE,
JEOPARDY_DT,
TARGET_DAYS,
BATCH_COMPLETE_DT,
CURRENT_BATCH_MODULE_ID,
GWF_QC_REQUIRED,
CURRENT_STEP,
SOURCE_SERVER,
BATCH_DESCRIPTION,
REPROCESSED_FLAG,
    FAX_BATCH_SOURCE,
    BATCH_PROGRAM
)
BEQUEATH DEFINER
AS
SELECT MFB_V2_BI_ID,
BATCH_GUID,
EXTERNAL_BATCH_ID,
BATCH_NAME,
CREATION_STATION_ID,
CREATION_USER_NAME,
CREATION_USER_ID,
BATCH_CLASS,
BATCH_CLASS_DES,
BATCH_TYPE,
CREATE_DT,
COMPLETE_DT,
INSTANCE_STATUS,
INSTANCE_STATUS_DT,
BATCH_PAGE_COUNT,
BATCH_DOC_COUNT,
BATCH_ENVELOPE_COUNT,
CANCEL_DT,
CANCEL_BY,
CANCEL_REASON,
CANCEL_METHOD,
ASF_SCAN_BATCH,
ASSD_SCAN_BATCH,
ASED_SCAN_BATCH,
ASPB_SCAN_BATCH,
ASF_PERFORM_QC,
ASSD_PERFORM_QC,
ASED_PERFORM_QC,
ASPB_PERFORM_QC,
KOFAX_QC_REASON,
ASF_CLASSIFICATION,
ASSD_CLASSIFICATION,
ASED_CLASSIFICATION,
CLASSIFICATION_DT,
ASF_RECOGNITION,
ASSD_RECOGNITION,
ASED_RECOGNITION,
RECOGNITION_DT,
ASF_VALIDATE_DATA,
ASSD_VALIDATE_DATA,
ASED_VALIDATE_DATA,
ASPB_VALIDATE_DATA,
ASPB_VALIDATE_DATA_USER_ID,
VALIDATION_DT,
ASF_CREATE_PDF,
ASSD_CREATE_PDF,
ASED_CREATE_PDF,
ASF_POPULATE_REPORTS,
ASSD_POPULATE_REPORTS,
ASED_POPULATE_REPORTS,
ASF_RELEASE_DMS,
ASSD_RELEASE_DMS,
ASED_RELEASE_DMS,
BATCH_PRIORITY,
BATCH_DELETED,
PAGES_SCANNED_FLAG,
DOCS_CREATED_FLAG,
DOCS_DELETED_FLAG,
PAGES_REPLACED_FLAG,
PAGES_DELETED_FLAG,
AGE_IN_BUSINESS_DAYS,
AGE_IN_CALENDAR_DAYS,
TIMELINESS_STATUS,
TIMELINESS_DAYS,
TIMELINESS_DAYS_TYPE,
TIMELINESS_DT,
JEOPARDY_FLAG,
JEOPARDY_DAYS,
JEOPARDY_DAYS_TYPE,
JEOPARDY_DT,
TARGET_DAYS,
BATCH_COMPLETE_DT,
CURRENT_BATCH_MODULE_ID,
GWF_QC_REQUIRED,
CURRENT_STEP,
SOURCE_SERVER,
BATCH_DESCRIPTION,
REPROCESSED_FLAG,
-- REPROCESSED_DATE,
FAX_BATCH_SOURCE,
CASE WHEN BATCH_CLASS LIKE 'NYHO%' THEN 'NYEC' ELSE 'NYHIX' END AS BATCH_PROGRAM
FROM MAXDAT.NYHIX_MFB_V2_BATCH_SUMMARY
WITH READ ONLY;


/* Formatted on 12/28/2022 2:23:38 PM (QP5 v5.374) */
CREATE OR REPLACE FORCE VIEW MAXDAT.F_MFB_BY_BATCH_GROUP_BY_DAY_SV
(
    D_DATE,
    WEEKEND_FLAG,
    BATCH_GROUP,
    FAX_BATCH_SOURCE,
    BATCH_CLASS,
    BATCH_PROGRAM,
    CREATION_COUNT,
    COMPLETION_COUNT,
    CANCEL_COUNT,
    REPROCESSED_COUNT,
    INVENTORY_COUNT
)
BEQUEATH DEFINER
AS
      SELECT D_DATE,
             WEEKEND_FLAG,
             Batch_Group,
             FAX_BATCH_SOURCE,
             BATCH_CLASS,
             BATCH_PROGRAM,
             SUM (CREATION_COUNT)        AS CREATION_COUNT,
             SUM (COMPLETION_COUNT)      AS COMPLETION_COUNT,
             SUM (CANCELATION_COUNT)     AS CANCEL_COUNT,
             SUM (REPROCESSED_COUNT)     AS REPROCESSED_COUNT,
             SUM (INVENTORY_COUNT)       AS INVENTORY_COUNT
        FROM maxdat.F_MFB_V2_BY_DAY
    GROUP BY D_DATE,
             WEEKEND_FLAG,
             Batch_Group,
             BATCH_CLASS,
             BATCH_PROGRAM,
             FAX_BATCH_SOURCE;



/* Formatted on 12/28/2022 2:23:38 PM (QP5 v5.374) */
CREATE OR REPLACE FORCE VIEW MAXDAT.F_MFB_BY_HOUR_SV
(
    FMFBBH_ID,
    D_DATE_HOUR,
    MFB_BI_ID,
    CREATION_COUNT,
    INVENTORY_COUNT,
    COMPLETION_COUNT
)
BEQUEATH DEFINER
AS SELECT MFB_V2_BI_ID AS FMFBBH_ID,
	       -- D_DATE is a DAY (no time )
	       -- Add 1 second to the D_DATE so MS will work with no changes
		   -- because MS uses > not >= for the date test
           D_DATE+(1/(24*60*60)) AS D_DATE_HOUR,
           MFB_V2_BI_ID AS MFB_BI_ID,
           CREATION_COUNT AS CREATION_COUNT,
           CASE WHEN 
                NVL(COMPLETION_COUNT,0) > 0 
                THEN 0 
				ELSE 1 END AS INVENTORY_COUNT,
           COMPLETION_COUNT
      FROM MAXDAT.F_MFB_V2_BY_DAY WITH READ ONLY;


GRANT INSERT, SELECT, UPDATE ON MAXDAT.D_MFBBATCH_EVENTS_CURMOD_SV TO MAXDAT_OLTP_SIU;

GRANT INSERT, SELECT, UPDATE ON MAXDAT.D_MFBBATCH_EVENTS_CURRENT_SV TO MAXDAT_OLTP_SIU;

GRANT INSERT, SELECT, UPDATE ON MAXDAT.D_MFBDOC_CURRENT_SV TO MAXDAT_OLTP_SIU;

GRANT INSERT, SELECT, UPDATE ON MAXDAT.D_MFB_CURRENT_MFD_DCN_SV TO MAXDAT_OLTP_SIU;

GRANT INSERT, SELECT, UPDATE ON MAXDAT.D_MFB_CURRENT_SV TO MAXDAT_OLTP_SIU;

GRANT INSERT, SELECT, UPDATE ON MAXDAT.F_MFB_BY_BATCH_GROUP_BY_DAY_SV TO MAXDAT_OLTP_SIU;

GRANT INSERT, SELECT, UPDATE ON MAXDAT.F_MFB_BY_HOUR_SV TO MAXDAT_OLTP_SIU;

GRANT DELETE, INSERT, SELECT, UPDATE ON MAXDAT.D_MFBBATCH_EVENTS_CURMOD_SV TO MAXDAT_OLTP_SIUD;

GRANT DELETE, INSERT, SELECT, UPDATE ON MAXDAT.D_MFBBATCH_EVENTS_CURRENT_SV TO MAXDAT_OLTP_SIUD;

GRANT DELETE, INSERT, SELECT, UPDATE ON MAXDAT.D_MFBDOC_CURRENT_SV TO MAXDAT_OLTP_SIUD;

GRANT DELETE, INSERT, SELECT, UPDATE ON MAXDAT.D_MFB_CURRENT_MFD_DCN_SV TO MAXDAT_OLTP_SIUD;

GRANT DELETE, INSERT, SELECT, UPDATE ON MAXDAT.D_MFB_CURRENT_SV TO MAXDAT_OLTP_SIUD;

GRANT DELETE, INSERT, SELECT, UPDATE ON MAXDAT.F_MFB_BY_BATCH_GROUP_BY_DAY_SV TO MAXDAT_OLTP_SIUD;

GRANT DELETE, INSERT, SELECT, UPDATE ON MAXDAT.F_MFB_BY_HOUR_SV TO MAXDAT_OLTP_SIUD;

GRANT SELECT ON MAXDAT.D_MFBBATCH_EVENTS_CURMOD_SV TO MAXDAT_READ_ONLY;

GRANT SELECT ON MAXDAT.D_MFBBATCH_EVENTS_CURRENT_SV TO MAXDAT_READ_ONLY;

GRANT SELECT ON MAXDAT.D_MFBDOC_CURRENT_SV TO MAXDAT_READ_ONLY;

GRANT SELECT ON MAXDAT.D_MFB_CURRENT_MFD_DCN_SV TO MAXDAT_READ_ONLY;

GRANT SELECT ON MAXDAT.D_MFB_CURRENT_SV TO MAXDAT_READ_ONLY;

GRANT SELECT ON MAXDAT.F_MFB_BY_BATCH_GROUP_BY_DAY_SV TO MAXDAT_READ_ONLY;

GRANT SELECT ON MAXDAT.F_MFB_BY_HOUR_SV TO MAXDAT_READ_ONLY;

GRANT SELECT ON MAXDAT.D_MFBDOC_CURRENT_SV TO MAXDAT_REPORTS;

GRANT SELECT ON MAXDAT.D_MFB_CURRENT_MFD_DCN_SV TO MAXDAT_REPORTS;

GRANT SELECT ON MAXDAT.D_MFB_CURRENT_SV TO MAXDAT_REPORTS;

GRANT SELECT ON MAXDAT.F_MFB_BY_BATCH_GROUP_BY_DAY_SV TO MAXDAT_REPORTS;
