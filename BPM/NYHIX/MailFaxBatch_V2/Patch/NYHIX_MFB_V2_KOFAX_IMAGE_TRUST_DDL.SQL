--DROP TABLE MAXDAT.NYHIX_MFB_V2_IMAGE_TRUST_STATS_BATCH_OLTP;

CREATE TABLE MAXDAT.NYHIX_MFB_V2_IMAGE_TRUST_Stats_Batch_OLTP(
	STATS_BATCH_ID  			NUMBER(18,0) NOT NULL,
	BATCH_ID 					NUMBER(18,0) NULL,
	BATCH_U_UID 				VARCHAR2(36) NULL,
	NODE_ID 					NUMBER(18,0) NULL,
	NODE_U_UID 					VARCHAR2(36) NULL,
	FLD_COUNT 					NUMBER(18,0) NULL,
	DOC_COUNT 					NUMBER(18,0) NULL,
	PAGE_COUNT 					NUMBER(18,0) NULL,
	JOB_ID 						NUMBER(18,0) NULL,
	PRIVAT 						CHAR(1) NULL,
	START_DATE 					timestamp         NULL,
	END_DATE 					timestamp         NULL,
	INDEXED_BATCH_COUNT 			NUMBER(18,0) NULL,
	INDEXED_DOC_COUNT 			NUMBER(18,0) NULL,
	INDEXED_FLD_COUNT 			NUMBER(18,0) NULL,
	USER_ID 					NUMBER(18,0) NULL,
	DELETED 					CHAR(1) NULL,
	SESSION_ID 					VARCHAR2(255) NULL,
	QUEUE 						VARCHAR2(255) NULL,
	QUEUE_MODE 					VARCHAR2(255) NULL,
	VERSION 					NUMBER(18,0) NULL,
	ORIG_BATCH_ID 				NUMBER(18,0) NULL,
	LAST_SCANNER_NAME 			VARCHAR2(255) NULL,
	REASON 						VARCHAR2(255) NULL,
	COPIED_FROM_BATCH_ID 		NUMBER(18,0) NULL,
	BATCH_NAME 					VARCHAR2(255) NULL,
	BATCH_PRIORITY 				NUMBER(18,0) NULL,
	STATS_BATCH_SESSION_ID 		NUMBER(18,0) NULL,
	BATCH_RELEASE_RUN_ID 		NUMBER(18,0) NULL,
	BATCH_CLASS_NAME			VARCHAR2(255) NULL
);	

GRANT SELECT ON MAXDAT.NYHIX_MFB_V2_IMAGE_TRUST_STATS_BATCH_OLTP TO MAXDAT_READ_ONLY;

GRANT SELECT ON MAXDAT.NYHIX_MFB_V2_IMAGE_TRUST_STATS_BATCH_OLTP TO MAXDAT_REPORTS;



--DROP TABLE MAXDAT.NYHIX_MFB_V2_IMAGE_TRUST_Stats_Batch;

CREATE TABLE MAXDAT.NYHIX_MFB_V2_IMAGE_TRUST_Stats_Batch(
	STATS_BATCH_ID  			NUMBER(18,0) NOT NULL,
    MFB_V2_CREATE_DATE       DATE,
    MFB_V2_UPDATE_DATE       DATE,
	BATCH_ID 					NUMBER(18,0) NULL,
	BATCH_U_UID 				VARCHAR2(36) NULL,
	NODE_ID 					NUMBER(18,0) NULL,
	NODE_U_UID 					VARCHAR2(36) NULL,
	FLD_COUNT 					NUMBER(18,0) NULL,
	DOC_COUNT 					NUMBER(18,0) NULL,
	PAGE_COUNT 					NUMBER(18,0) NULL,
	JOB_ID 						NUMBER(18,0) NULL,
	PRIVAT 						CHAR(1) NULL,
	START_DATE 					timestamp         NULL,
	END_DATE 					timestamp         NULL,
	INDEXED_BATCH_COUNT 			NUMBER(18,0) NULL,
	INDEXED_DOC_COUNT 			NUMBER(18,0) NULL,
	INDEXED_FLD_COUNT 			NUMBER(18,0) NULL,
	USER_ID 					NUMBER(18,0) NULL,
	DELETED 					CHAR(1) NULL,
	SESSION_ID 					VARCHAR2(255) NULL,
	QUEUE 						VARCHAR2(255) NULL,
	QUEUE_MODE 					VARCHAR2(255) NULL,
	VERSION 					NUMBER(18,0) NULL,
	ORIG_BATCH_ID 				NUMBER(18,0) NULL,
	LAST_SCANNER_NAME 			VARCHAR2(255) NULL,
	REASON 						VARCHAR2(255) NULL,
	COPIED_FROM_BATCH_ID 		NUMBER(18,0) NULL,
	BATCH_NAME 					VARCHAR2(255) NULL,
	BATCH_PRIORITY 				NUMBER(18,0) NULL,
	STATS_BATCH_SESSION_ID 		NUMBER(18,0) NULL,
	BATCH_RELEASE_RUN_ID 		NUMBER(18,0) NULL,
	BATCH_CLASS_NAME			VARCHAR2(255) NULL
);	

grant select on MAXDAT.NYHIX_MFB_V2_IMAGE_TRUST_Stats_Batch to maxdat_read_only;

grant select on MAXDAT.NYHIX_MFB_V2_IMAGE_TRUST_Stats_Batch to maxdat_reports;

create or replace view MAXDAT.NYHIX_MFB_V2_IMAGE_TRUST_Stats_Batch_sv
as select * from MAXDAT.NYHIX_MFB_V2_IMAGE_TRUST_Stats_Batch;

grant select on MAXDAT.NYHIX_MFB_V2_IMAGE_TRUST_Stats_Batch_sv to maxdat_read_only;

grant select on MAXDAT.NYHIX_MFB_V2_IMAGE_TRUST_Stats_Batch_sv to maxdat_reports;


CREATE UNIQUE INDEX NYHIX_MFB_V2_IMAGE_TRUST_STATS_BATCH_PK 
ON MAXDAT.NYHIX_MFB_V2_IMAGE_TRUST_STATS_BATCH(STATS_BATCH_ID)
TABLESPACE MAXDAT_INDX;

ALTER TABLE MAXDAT.NYHIX_MFB_V2_IMAGE_TRUST_STATS_BATCH
ADD CONSTRAINT NYHIX_MFB_V2_IMAGE_TRUST_STATS_BATCH 
PRIMARY KEY (STATS_BATCH_ID)
USING INDEX NYHIX_MFB_V2_IMAGE_TRUST_STATS_BATCH_PK;

CREATE INDEX NYHIX_MFB_V2_IMAGE_TRUST_BATCH_NAME
ON MAXDAT.NYHIX_MFB_V2_IMAGE_TRUST_STATS_BATCH(BATCH_NAME)
TABLESPACE MAXDAT_INDX;

CREATE OR REPLACE TRIGGER MAXDAT.TRG_BIU_NYHIX_MFB_V2_IMAGE_TRUST_STATS_BATCH 
BEFORE INSERT OR UPDATE ON MAXDAT.NYHIX_MFB_V2_IMAGE_TRUST_STATS_BATCH
FOR EACH ROW
BEGIN
	IF INSERTING THEN
		:NEW.MFB_V2_CREATE_DATE := SYSDATE;
		:NEW.MFB_V2_UPDATE_DATE := NULL;
	END IF;

	IF UPDATING THEN
		:NEW.MFB_V2_CREATE_DATE := :OLD.MFB_V2_CREATE_DATE;
		:NEW.MFB_V2_UPDATE_DATE := SYSDATE;
	END IF;	

END;
/


