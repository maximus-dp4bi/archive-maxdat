CREATE OR REPLACE FORCE VIEW MAXDAT.F_MFB_V2_BY_HOUR_SV
(
    FMFBBH_ID,
    D_DATE_HOUR,
    MFB_BI_ID,
    CREATION_COUNT,
    INVENTORY_COUNT,
    COMPLETION_COUNT
)
BEQUEATH DEFINER
AS
    SELECT MFB_V2_BI_ID     AS FMFBBH_ID,
           D_DATE           AS date_hour,
           MFB_V2_BI_ID,
           CREATION_COUNT,
           case when nvl(completion_count,0) > 0 then 0 
				else 1 end as INVENTORY_COUNT,
           COMPLETION_COUNT
      FROM F_MFB_V2_BY_DAY
WITH READ ONLY;


GRANT INSERT, SELECT, UPDATE ON MAXDAT.F_MFB_V2_BY_HOUR_SV TO MAXDAT_OLTP_SIU;

GRANT DELETE, INSERT, SELECT, UPDATE ON MAXDAT.F_MFB_V2_BY_HOUR_SV TO MAXDAT_OLTP_SIUD;

GRANT SELECT ON MAXDAT.F_MFB_V2_BY_HOUR_SV TO MAXDAT_READ_ONLY;

