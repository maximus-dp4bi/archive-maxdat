CREATE OR REPLACE FORCE 
EDITIONABLE VIEW MAXDAT.QARESEARCH_SAMPLE_SV (COMPLETE_DATE, TASK_TYPE, TASK_ID, ECN) 
AS 
SELECT DISTINCT 
COMPLETE_DATE, TASK_TYPE, TASK_ID,ECN  
FROM (SELECT 
        A11.COMPLETE_DATE COMPLETE_DATE,
        A12.TASK_NAME TASK_TYPE,
        A11.TASK_ID TASK_ID,
        A13.ECN ECN
    FROM MAXDAT.D_MW_V2_CURRENT_SV A11
    LEFT OUTER JOIN MAXDAT.D_TASK_TYPES_SV A12 ON A11.TASK_TYPE_ID = A12.TASK_TYPE_ID
    LEFT OUTER JOIN MAXDAT.D_NYHIX_MFD_CURRENT_V2 A13 ON A11.SOURCE_REFERENCE_ID = A13.APP_DOC_TRACKER_ID
           and a11.SOURCE_REFERENCE_TYPE='App Doc Tracker ID'
    WHERE A11.CURR_TASK_STATUS IN ('COMPLETED')
    AND A11.TASK_TYPE_ID IN (2013010, 2013012, 2013028, 2013029, 2013037, 2013053, 2013054, 2013058, 2013400, 2013421, 2013450, 2016155, 2016156, 2016234) 
    AND COMPLETE_DATE 
        BETWEEN TRUNC(ADD_MONTHS(SYSDATE,-1),'MM')  
            AND TRUNC(SYSDATE,'MM')-(1/(60*60*24)) 
    ORDER BY DBMS_RANDOM.VALUE
    )
WHERE ROWNUM <=50
ORDER BY COMPLETE_DATE,TASK_TYPE,TASK_ID,ECN;


GRANT SELECT ON	MAXDAT.QARESEARCH_SAMPLE_SV TO MAXDAT_READ_ONLY;	

