
CREATE or REPLACE VIEW D_PL_CURRENT_SV
AS SELECT
 PL.PL_BI_ID
,PL.LETTER_REQUEST_ID
,PL.CREATE_DATE
,PL.CREATED_BY
,PL.REQUEST_DATE
,PL.INSTANCE_STATUS
,PL.LETTER_TYPE
,PL.PROGRAM
,PL.CASE_ID
,PL.COUNTY_CODE
,PL.ZIP_CODE
,PL.LANGUAGE
,PL.REPRINT
,PL.REQUEST_DRIVER_TYPE
,PL.REQUEST_DRIVER_TABLE
,PL.LETTER_STATUS
,PL.LETTER_STATUS_DATE
,PL.SENT_DATE
,PL.PRINT_DATE
,PL.MAILED_DATE
,PL.RETURN_DATE
,PL.RETURN_REASON
,PL.REJECTION_REASON
,PL.REQUEST_ERROR_REASON
,PL.TRANSMITTED_FILE_NAME
,PL.TRANSMITTED_FILE_DATE
,PL.LETTER_RESPONSE_FILE_NAME
,PL.LETTER_RESPONSE_FILE_DATE
,PL.LAST_UPDATE_DATE
,PL.LAST_UPDATED_BY_NAME
,PL.NEWBORN_FLAG
,PL.TASK_ID
,PL.CANCEL_DATE
,PL.CANCEL_BY
,PL.COMPLETE_DATE
,PL.PROCESS_LTR_REQUEST_START_DATE
,PL.PROCESS_LTR_REQUEST_END_DATE
,PL.SEND_TO_MAIL_HOUSE_START_DATE
,PL.SEND_TO_MAIL_HOUSE_END_DATE
,PL.RECEIVE_CONFIRM_START_DATE
,PL.RECEIVE_CONFIRM_END_DATE
,PL.CREATE_ROUTE_WORK_START_DATE
,PL.CREATE_ROUTE_WORK_END_DATE
,PL.AGE_IN_BUSINESS_DAYS
,PL.AGE_IN_CALENDAR_DAYS
,PL.TIMELINESS_STATUS
,PL.JEOPARDY_STATUS
,PL.SLA_CATEGORY
,PL.SLA_DAYS
,PL.SLA_DAYS_TYPE
,PL.SLA_JEOPARDY_DATE
,PL.SLA_JEOPARDY_DAYS
,PL.SLA_TARGET_DAYS
,PL.VALIDATION_FLAG
,PL.OUTCOME_FLAG
,PL.WORK_REQUIRED_FLAG
,PL.PROCESS_LETTERS_FLAG
,PL.TRANSMIT_FLAG
,PL.CONFIRMATION_FLAG
,PL.CREATE_ROUTE_WORK_FLAG
,PL.MATERIAL_REQUEST_ID
,PL.FAMILY_MEMBER_COUNT
,PL.AIAN_MEMBER_COUNT
,PL.ACCOUNT_ID
,LS.PARENT_MANUAL_NOTICE_CASE_ID
,LS.MANUAL_HAS_ADDTL_ADDRESS_IND
,LS.LETTER_CREATED_BY as CREATED_BY_ID
,LS.LETTER_UPDATED_BY as LAST_UPDATED_BY_ID
,LS.CREATION_GROUP as CREATION_GROUP
,(select TO_CHAR(DS.DEFAULT_GROUP_ID) from LETTERS_STG ls JOIN D_STAFF DS on to_char(DS.staff_id) = ls.letter_created_by  where LS.LETTER_ID = PL.LETTER_REQUEST_ID)as CREATED_BY_GROUP_ID
,(select TO_CHAR(DS.DEFAULT_GROUP_ID) from LETTERS_STG ls JOIN D_STAFF DS on to_char(DS.staff_id) = ls.letter_updated_by  where LS.LETTER_ID = PL.LETTER_REQUEST_ID)as LAST_UPDATED_BY_GROUP_ID
,PL.ALT_MEDIA_SENT_ON
,PL.MANUAL_NOTICE_TYPE
FROM D_PL_CURRENT pl
join LETTERS_STG ls
on PL.LETTER_REQUEST_ID = LS.LETTER_ID WITH READ ONLY;

Commit;
