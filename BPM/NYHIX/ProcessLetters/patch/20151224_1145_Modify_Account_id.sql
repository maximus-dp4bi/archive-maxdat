ALTER TABLE CORP_ETL_PROC_LETTERS DISABLE ALL TRIGGERS;

ALTER TABLE CORP_ETL_PROC_LETTERS_OLTP DISABLE ALL TRIGGERS;

ALTER TABLE CORP_ETL_PROC_LETTERS_WIP_BPM DISABLE ALL TRIGGERS;

ALTER TABLE CORP_ETL_PROC_LETTERS drop column ACCOUNT_ID ;

ALTER TABLE CORP_ETL_PROC_LETTERS_OLTP drop column ACCOUNT_ID ;

ALTER TABLE CORP_ETL_PROC_LETTERS_WIP_BPM drop column ACCOUNT_ID ;

ALTER TABLE D_PL_CURRENT drop column ACCOUNT_ID ;
commit;

ALTER TABLE CORP_ETL_PROC_LETTERS ADD (ACCOUNT_ID varchar2(32) DEFAULT null) ;

ALTER TABLE CORP_ETL_PROC_LETTERS_OLTP ADD (ACCOUNT_ID varchar2(32) DEFAULT null) ;

ALTER TABLE CORP_ETL_PROC_LETTERS_WIP_BPM ADD (ACCOUNT_ID varchar2(32) DEFAULT null) ;

ALTER TABLE D_PL_CURRENT ADD (ACCOUNT_ID varchar2(32) DEFAULT null) ;

ALTER TABLE CORP_ETL_PROC_LETTERS ENABLE ALL TRIGGERS;

ALTER TABLE CORP_ETL_PROC_LETTERS_OLTP ENABLE ALL TRIGGERS;

ALTER TABLE CORP_ETL_PROC_LETTERS_WIP_BPM ENABLE ALL TRIGGERS;

COMMIT;

CREATE OR REPLACE VIEW MAXDAT.D_PL_CURRENT_SV
AS SELECT "PL_BI_ID","LETTER_REQUEST_ID","CREATE_DATE","CREATED_BY","REQUEST_DATE","INSTANCE_STATUS","LETTER_TYPE","PROGRAM","CASE_ID","COUNTY_CODE","ZIP_CODE","LANGUAGE","REPRINT","REQUEST_DRIVER_TYPE","REQUEST_DRIVER_TABLE","LETTER_STATUS","LETTER_STATUS_DATE","SENT_DATE","PRINT_DATE","MAILED_DATE","RETURN_DATE","RETURN_REASON","REJECTION_REASON","REQUEST_ERROR_REASON","TRANSMITTED_FILE_NAME","TRANSMITTED_FILE_DATE","LETTER_RESPONSE_FILE_NAME","LETTER_RESPONSE_FILE_DATE","LAST_UPDATE_DATE","LAST_UPDATED_BY_NAME","NEWBORN_FLAG","TASK_ID","CANCEL_DATE","CANCEL_BY","COMPLETE_DATE","PROCESS_LTR_REQUEST_START_DATE","PROCESS_LTR_REQUEST_END_DATE","SEND_TO_MAIL_HOUSE_START_DATE","SEND_TO_MAIL_HOUSE_END_DATE","RECEIVE_CONFIRM_START_DATE","RECEIVE_CONFIRM_END_DATE","CREATE_ROUTE_WORK_START_DATE","CREATE_ROUTE_WORK_END_DATE","AGE_IN_BUSINESS_DAYS","AGE_IN_CALENDAR_DAYS","TIMELINESS_STATUS","JEOPARDY_STATUS","SLA_CATEGORY","SLA_DAYS","SLA_DAYS_TYPE","SLA_JEOPARDY_DATE","SLA_JEOPARDY_DAYS","SLA_TARGET_DAYS","VALIDATION_FLAG","OUTCOME_FLAG","WORK_REQUIRED_FLAG","PROCESS_LETTERS_FLAG","TRANSMIT_FLAG","CONFIRMATION_FLAG","CREATE_ROUTE_WORK_FLAG","MATERIAL_REQUEST_ID","FAMILY_MEMBER_COUNT","AIAN_MEMBER_COUNT", "ACCOUNT_ID" 
FROM D_PL_CURRENT WITH READ ONLY;


-- UPDATE THE LAST RUN DATE TO BEFORE THE PREVIOUS JIRA TO PICK UP ANY MISSED RECORDS
Update MAXDAT.CORP_ETL_CONTROL    
SET value = TRUNC(TO_DATE('12/23/2015','MM/DD/YYYY'))
WHERE NAME = 'LETTERS_LAST_UPDATE_DATE';