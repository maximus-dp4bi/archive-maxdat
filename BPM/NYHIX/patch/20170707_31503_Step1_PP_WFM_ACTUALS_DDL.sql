--------------------------------------------
-- THE FOLLOWING DDL IS FOR THE MAXDAT SCHEMA
-- CREATE THE NEW TABLE
--------------------------------------------

CREATE TABLE MAXDAT.PP_WFM_ACTUALS_NEW
	(
	  RT_ACTUALS_ID    NUMBER NOT NULL
	, STAFF_ID         NUMBER NOT NULL
	, EVENT_ID         NUMBER NOT NULL
	, SOURCE_ID        NUMBER NOT NULL
	, TASK_START       DATE NOT NULL
	, TASK_CATEGORY_ID NUMBER NOT NULL
	, TASK_END         DATE
	, WORK_ACTIVITY    VARCHAR2 (4000)
	, ANNOTATION       VARCHAR2 (4000)
	, CREATE_DATE      DATE NOT NULL
	, CREATE_STAFF_ID  NUMBER NOT NULL
	, MODIFY_DATE      DATE
	, MODIFY_STAFF_ID  NUMBER
	, QUEUE_ID         NUMBER
	, EXCLUSION_FLAG   VARCHAR2 (1) DEFAULT 'N'
	, WORK_SUBACTIVITY VARCHAR2 (4000)
	)
	STORAGE (BUFFER_POOL DEFAULT)
PARTITION BY RANGE (TASK_START) INTERVAL (NUMTOYMINTERVAL(1, 'MONTH'))
	(
	PARTITION P0 VALUES LESS THAN (TO_DATE(' 2016-01-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS', 'NLS_CALENDAR=GREGORIAN')) TABLESPACE MAXDAT_DATA
	);


GRANT SELECT ON MAXDAT.PP_WFM_ACTUALS_NEW TO DP_SCORECARD_READ_ONLY;

GRANT SELECT ON MAXDAT.PP_WFM_ACTUALS_NEW TO MAXDAT_READ_ONLY;
	
	
--------------------------------------------
-- COPY THE DATA FROM THE OLD TABLE
-- SHOULD TAKE ABOUT 15 MINUTES
--------------------------------------------

INSERT INTO MAXDAT.PP_WFM_ACTUALS_NEW
SELECT * FROM MAXDAT.PP_WFM_ACTUALS
ORDER BY TASK_START, STAFF_ID;

COMMIT;

---------------------------------------------
-- COMPARE THE COUNTS 
-- IF THEY DO NOT MATCH STOP!!!!
---------------------------------------------  


select count(*) from MAXDAT.PP_WFM_ACTUALS;
	
select count(*) from MAXDAT.PP_WFM_ACTUALS_NEW;
	
-------------------------------------------------
-- DO NOT PROCEDE IF THERE ARE ANY ERRORS OR DIFFERENCES
-------------------------------------------------

