--------------------------------------------
-- THE FOLLOWING DDL IS FOR THE DP_SCORECARD SCHEMA
-- CREATE THE NEW TABLE
--------------------------------------------

CREATE TABLE DP_SCORECARD.PP_WFM_TASK_BO_NEW
	(
	  PP_WFM_TASK_BO_ID             NUMBER (38) NOT NULL
	, STAFF_ID                      NUMBER (38) NOT NULL
	, TASK_START                    DATE NOT NULL
	, TASK_END                      DATE NOT NULL
	, TASK_CATEGORY_ID              NUMBER (38) NOT NULL
	, DURATION                      NUMBER (38) NOT NULL
	, EVENT_ID                      NUMBER (38) NOT NULL
	, SUPERVISOR                    NUMBER (38)
	, TASK_MODIFICATION_REQUEST_REF NUMBER (38)
	, TASK_ID                       NUMBER (38) NOT NULL
	, SCENARIO_GROUP_ID             NUMBER (38) NOT NULL
	, SCHEDULE_INSTANCE_ID          NUMBER (38)
	, TASK_EDIT_ID                  NUMBER (38)
	, EDIT_STATE                    NUMBER (38)
	, ALT_TASK_EDIT_ID              NUMBER (38)
	, NATIONAL_ID                   VARCHAR2 (250)
	, MAKE_DATE_TIME                DATE
	, EXTRACT_DT                    DATE NOT NULL
	, LAST_UPDATE_DT                DATE NOT NULL
	, LAST_UPDATED_BY               VARCHAR2 (30) NOT NULL
	, DELETE_FLAG                   VARCHAR2 (1) DEFAULT 'N'   
	)
	STORAGE (BUFFER_POOL DEFAULT)
PARTITION BY RANGE (TASK_START) INTERVAL (NUMTOYMINTERVAL(1, 'MONTH'))
	(
	PARTITION P0 VALUES LESS THAN (TO_DATE(' 2016-01-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS', 'NLS_CALENDAR=GREGORIAN')) TABLESPACE MAXDAT_DATA
	);
	
--------------------------------------------
-- COPY THE DATA FROM THE OLD TABLE
-- SHOULD TAKE ABOUT 15 MINUTES
--------------------------------------------
GRANT SELECT ON DP_SCORECARD.PP_WFM_TASK_BO_NEW TO MAXDAT;

GRANT SELECT ON DP_SCORECARD.PP_WFM_TASK_BO_NEW TO DP_SCORECARD_READ_ONLY;

GRANT SELECT ON DP_SCORECARD.PP_WFM_TASK_BO_NEW TO MAXDAT_READ_ONLY;



INSERT INTO DP_SCORECARD.PP_WFM_TASK_BO_NEW
SELECT * FROM DP_SCORECARD.PP_WFM_TASK_BO;

COMMIT;



---------------------------------------------
-- COMPARE THE COUNTS 
-- IF THEY DO NOT MATCH STOP!!!!
---------------------------------------------  

SELECT COUNT(*) FROM DP_SCORECARD.PP_WFM_TASK_BO;

SELECT COUNT(*) FROM DP_SCORECARD.PP_WFM_TASK_BO_NEW;
	

