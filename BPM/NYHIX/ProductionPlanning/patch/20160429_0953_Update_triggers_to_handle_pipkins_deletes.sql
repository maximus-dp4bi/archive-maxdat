-- Update Triggers for Pipkins deleted rows handling in MAXDAT

create or replace trigger BIU_PP_BO_STAFF_GROUP_TO_STAFF
    BEFORE INSERT OR UPDATE ON PP_BO_STAFF_GROUP_TO_STAFF
    FOR EACH ROW
    BEGIN
IF INSERTING THEN
          :NEW.EXTRACT_DT := SYSDATE;
END IF;
:NEW.LAST_UPDATE_DT := SYSDATE;
IF (:NEW.END_DATE = to_date('1900/01/01 00:00:00','yyyy/mm/dd hh24:mi:ss')) THEN
	:NEW.LAST_UPDATED_BY := 'DELETED_BY_PIPKINS';
ELSE
:NEW.LAST_UPDATED_BY := USER;
END IF;
END;
/

create or replace TRIGGER BIU_PP_BO_SUPERVISOR_TO_STAFF
    BEFORE INSERT OR UPDATE ON PP_BO_SUPERVISOR_TO_STAFF
    FOR EACH ROW 
    BEGIN
IF INSERTING THEN 
          :NEW.EXTRACT_DT := SYSDATE;
END IF;
:NEW.LAST_UPDATE_DT := SYSDATE;
IF (:NEW.END_DATE = to_date('1900/01/01 00:00:00','yyyy/mm/dd hh24:mi:ss')) THEN
	:NEW.LAST_UPDATED_BY := 'DELETED_BY_PIPKINS';
ELSE
:NEW.LAST_UPDATED_BY := USER;
END IF;
END; 
/