--Update fact D_DATE with latest EVENT_DATE as there is no change in data

update F_NYHIX_MFD_BY_DATE set D_DATE = TO_DATE('2014-01-28 23:59:02','YYYY-MM-DD HH24:MI:SS') where FNMFDBD_ID = 13821192;
update F_NYHIX_MFD_BY_DATE set D_DATE = TO_DATE('2014-01-28 21:02:38','YYYY-MM-DD HH24:MI:SS') where FNMFDBD_ID = 13848765;
update F_NYHIX_MFD_BY_DATE set D_DATE = TO_DATE('2014-01-28 23:59:02','YYYY-MM-DD HH24:MI:SS') where FNMFDBD_ID = 13821197;
update F_NYHIX_MFD_BY_DATE set D_DATE = TO_DATE('2014-01-22 21:36:36','YYYY-MM-DD HH24:MI:SS') where FNMFDBD_ID = 13298329;
update F_NYHIX_MFD_BY_DATE set D_DATE = TO_DATE('2014-01-29 22:00:55','YYYY-MM-DD HH24:MI:SS') where FNMFDBD_ID = 15237848;
update F_NYHIX_MFD_BY_DATE set D_DATE = TO_DATE('2014-01-22 21:36:23','YYYY-MM-DD HH24:MI:SS') where FNMFDBD_ID = 13306025;
commit;


--Delete from queue data where D_DATE is newer than EVENT_DATE

delete
from BPM_UPDATE_EVENT_QUEUE
where identifier     in ('10007816','10007817','10007818','10046435','10050029','10052296','10075770','10075771')
and BSL_ID            = 18;

commit;

--Update XML for DOC_STATUS_DT where it is null

update BPM_UPDATE_EVENT_QUEUE set OLD_DATA = DELETEXML(OLD_DATA,'/ROWSET/ROW/DOC_STATUS_DT'), NEW_DATA = DELETEXML(NEW_DATA,'/ROWSET/ROW/DOC_STATUS_DT') where BSL_ID = 18 and identifier='U141224428609' and EXISTSNODE
(OLD_DATA,'ROWSET/ROW/DOC_STATUS_DT') = 1;
update BPM_UPDATE_EVENT_QUEUE set OLD_DATA = DELETEXML(OLD_DATA,'/ROWSET/ROW/DOC_STATUS_DT'), NEW_DATA = DELETEXML(NEW_DATA,'/ROWSET/ROW/DOC_STATUS_DT') where BSL_ID = 18 and identifier='U141224428611' and EXISTSNODE
(OLD_DATA,'ROWSET/ROW/DOC_STATUS_DT') = 1;
update BPM_UPDATE_EVENT_QUEUE set OLD_DATA = DELETEXML(OLD_DATA,'/ROWSET/ROW/DOC_STATUS_DT'), NEW_DATA = DELETEXML(NEW_DATA,'/ROWSET/ROW/DOC_STATUS_DT') where BSL_ID = 18 and identifier='U141224428613' and EXISTSNODE
(OLD_DATA,'ROWSET/ROW/DOC_STATUS_DT') = 1;
update BPM_UPDATE_EVENT_QUEUE set OLD_DATA = DELETEXML(OLD_DATA,'/ROWSET/ROW/DOC_STATUS_DT'), NEW_DATA = DELETEXML(NEW_DATA,'/ROWSET/ROW/DOC_STATUS_DT') where BSL_ID = 18 and identifier='U141224428616' and EXISTSNODE
(OLD_DATA,'ROWSET/ROW/DOC_STATUS_DT') = 1;
update BPM_UPDATE_EVENT_QUEUE set OLD_DATA = DELETEXML(OLD_DATA,'/ROWSET/ROW/DOC_STATUS_DT'), NEW_DATA = DELETEXML(NEW_DATA,'/ROWSET/ROW/DOC_STATUS_DT') where BSL_ID = 18 and identifier='U141224428623' and EXISTSNODE
(OLD_DATA,'ROWSET/ROW/DOC_STATUS_DT') = 1;
update BPM_UPDATE_EVENT_QUEUE set OLD_DATA = DELETEXML(OLD_DATA,'/ROWSET/ROW/DOC_STATUS_DT'), NEW_DATA = DELETEXML(NEW_DATA,'/ROWSET/ROW/DOC_STATUS_DT') where BSL_ID = 18 and identifier='U141224428624' and EXISTSNODE
(OLD_DATA,'ROWSET/ROW/DOC_STATUS_DT') = 1;
update BPM_UPDATE_EVENT_QUEUE set OLD_DATA = DELETEXML(OLD_DATA,'/ROWSET/ROW/DOC_STATUS_DT'), NEW_DATA = DELETEXML(NEW_DATA,'/ROWSET/ROW/DOC_STATUS_DT') where BSL_ID = 18 and identifier='U141224429170' and EXISTSNODE
(OLD_DATA,'ROWSET/ROW/DOC_STATUS_DT') = 1;
update BPM_UPDATE_EVENT_QUEUE set OLD_DATA = DELETEXML(OLD_DATA,'/ROWSET/ROW/DOC_STATUS_DT'), NEW_DATA = DELETEXML(NEW_DATA,'/ROWSET/ROW/DOC_STATUS_DT') where BSL_ID = 18 and identifier='U141224429172' and EXISTSNODE
(OLD_DATA,'ROWSET/ROW/DOC_STATUS_DT') = 1;

update BPM_UPDATE_EVENT_QUEUE set OLD_DATA = APPENDCHILDXML(OLD_DATA,'/ROWSET/ROW',xmltype('<DOC_STATUS_DT>2014-05-02 10:59:02</DOC_STATUS_DT>')), NEW_DATA = APPENDCHILDXML(NEW_DATA,'/ROWSET/ROW',xmltype
('<DOC_STATUS_DT>2014-05-02 10:59:02</DOC_STATUS_DT>')) where BSL_ID = 18 and identifier='U141224428609';
update BPM_UPDATE_EVENT_QUEUE set OLD_DATA = APPENDCHILDXML(OLD_DATA,'/ROWSET/ROW',xmltype('<DOC_STATUS_DT>2014-05-02 10:59:02</DOC_STATUS_DT>')), NEW_DATA = APPENDCHILDXML(NEW_DATA,'/ROWSET/ROW',xmltype
('<DOC_STATUS_DT>2014-05-02 10:59:02</DOC_STATUS_DT>')) where BSL_ID = 18 and identifier='U141224428611';
update BPM_UPDATE_EVENT_QUEUE set OLD_DATA = APPENDCHILDXML(OLD_DATA,'/ROWSET/ROW',xmltype('<DOC_STATUS_DT>2014-05-02 10:59:02</DOC_STATUS_DT>')), NEW_DATA = APPENDCHILDXML(NEW_DATA,'/ROWSET/ROW',xmltype
('<DOC_STATUS_DT>2014-05-02 10:59:02</DOC_STATUS_DT>')) where BSL_ID = 18 and identifier='U141224428613';
update BPM_UPDATE_EVENT_QUEUE set OLD_DATA = APPENDCHILDXML(OLD_DATA,'/ROWSET/ROW',xmltype('<DOC_STATUS_DT>2014-05-02 10:59:02</DOC_STATUS_DT>')), NEW_DATA = APPENDCHILDXML(NEW_DATA,'/ROWSET/ROW',xmltype
('<DOC_STATUS_DT>2014-05-02 10:59:02</DOC_STATUS_DT>')) where BSL_ID = 18 and identifier='U141224428616';
update BPM_UPDATE_EVENT_QUEUE set OLD_DATA = APPENDCHILDXML(OLD_DATA,'/ROWSET/ROW',xmltype('<DOC_STATUS_DT>2014-05-02 10:59:02</DOC_STATUS_DT>')), NEW_DATA = APPENDCHILDXML(NEW_DATA,'/ROWSET/ROW',xmltype
('<DOC_STATUS_DT>2014-05-02 10:59:02</DOC_STATUS_DT>')) where BSL_ID = 18 and identifier='U141224428623';
update BPM_UPDATE_EVENT_QUEUE set OLD_DATA = APPENDCHILDXML(OLD_DATA,'/ROWSET/ROW',xmltype('<DOC_STATUS_DT>2014-05-02 10:59:02</DOC_STATUS_DT>')), NEW_DATA = APPENDCHILDXML(NEW_DATA,'/ROWSET/ROW',xmltype
('<DOC_STATUS_DT>2014-05-02 10:59:02</DOC_STATUS_DT>')) where BSL_ID = 18 and identifier='U141224428624';
update BPM_UPDATE_EVENT_QUEUE set OLD_DATA = APPENDCHILDXML(OLD_DATA,'/ROWSET/ROW',xmltype('<DOC_STATUS_DT>2014-05-02 11:30:07</DOC_STATUS_DT>')), NEW_DATA = APPENDCHILDXML(NEW_DATA,'/ROWSET/ROW',xmltype
('<DOC_STATUS_DT>2014-05-02 11:30:07</DOC_STATUS_DT>')) where BSL_ID = 18 and identifier='U141224429170';
update BPM_UPDATE_EVENT_QUEUE set OLD_DATA = APPENDCHILDXML(OLD_DATA,'/ROWSET/ROW',xmltype('<DOC_STATUS_DT>2014-05-02 11:30:07</DOC_STATUS_DT>')), NEW_DATA = APPENDCHILDXML(NEW_DATA,'/ROWSET/ROW',xmltype
('<DOC_STATUS_DT>2014-05-02 11:30:07</DOC_STATUS_DT>')) where BSL_ID = 18 and identifier='U141224429172';

commit;