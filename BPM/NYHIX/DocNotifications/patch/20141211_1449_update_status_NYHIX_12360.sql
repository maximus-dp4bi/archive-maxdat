DECLARE  
  CURSOR TEMP_CUR IS
   SELECT EDNDB_ID FROM NYHIX_ETL_DOC_NOTIFICATIONS
   WHERE
   INSTANCE_STATUS = 'Complete' AND 
   STATUS_CD NOT IN ('AWAIT_VERIF','VERIF_COMPLETE');

  TYPE T_TAB IS TABLE OF TEMP_CUR%ROWTYPE INDEX BY PLS_INTEGER;
  TEMP_TAB T_TAB;
  V_BULK_LIMIT NUMBER := 500;

BEGIN  
   OPEN TEMP_CUR;
   LOOP
     FETCH TEMP_CUR BULK COLLECT INTO TEMP_TAB LIMIT V_BULK_LIMIT;
     EXIT WHEN TEMP_TAB.COUNT = 0; 
  
     BEGIN
       FORALL INDX IN 1..TEMP_TAB.COUNT
         UPDATE NYHIX_ETL_DOC_NOTIFICATIONS
         SET 
         STATUS = 
         (CASE
          WHEN STATUS_CD = 'NO_VERIF_REQUIRED' THEN 'No Verification Required'
          WHEN STATUS_CD = 'INVALID_DOC' THEN 'Invalid Document'
         END)
         WHERE EDNDB_ID = TEMP_TAB(INDX).EDNDB_ID;
     END;
     COMMIT;
  END LOOP;
  COMMIT;
  CLOSE TEMP_CUR;
END;