CREATE OR REPLACE VIEW D_NYHIX_WEB_NOTIFICATIONS_SV
AS
SELECT DISTINCT a12.COMPLETE_DATE  COMPLETE_DATE_TIME, 
  a11.kofax_dcn,
  (Case when a12.TASK_TYPE_ID in (2013019) and a11.CREATE_DT <=  a12.COMPLETE_DATE then 1 else 0 end)  GODWFLAG2_1,
  (Case when a12.TASK_TYPE_ID in (2016306, 2016308, 2013051, 2013050, 2016307, 2013052) and a11.CREATE_DT >= a12.create_date then 1 else 0 end)  GODWFLAG4_1,
  TRUNC(a12.complete_date) complete_date,
  'Consumer Docs(Web)' as document_type,
  'Web' as channel,
  (Case when a12.TASK_TYPE_ID in (2013019) and a11.CREATE_DT <=  a12.COMPLETE_DATE then 1 else 0 end)   +
  (Case when a12.TASK_TYPE_ID in (2016306, 2016308, 2013051, 2013050, 2016307, 2013052) and a11.CREATE_DT >= a12.create_date then 1 else 0 end) as 
   completed_count
FROM D_NYHIX_DOC_NOTIF_CURRENT a11
INNER JOIN D_MW_V2_CURRENT a12
ON a12.SOURCE_PROCESS_INSTANCE_ID = a11.PROCESS_INSTANCE_ID
WHERE a11.KOFAX_DCN LIKE 'U%'
AND a12.CURR_TASK_STATUS = 'COMPLETED'
AND ( ( a12.TASK_TYPE_ID in (2016306,2013054,2016308,2013051,2013050,2016307,2013052) AND a11.CREATE_DT >= a12.create_date) 
  OR  (a12.task_type_id = 2013019 AND a11.CREATE_DT <= a12.COMPLETE_DATE ) );
  
grant select on D_NYHIX_WEB_NOTIFICATIONS_SV to MAXDAT_READ_ONLY;  


