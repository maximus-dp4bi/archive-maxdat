CREATE TABLE MAXDAT.F_MFB_BY_HOUR_BACKUP as (SELECT * from  MAXDAT.F_MFB_BY_HOUR);


UPDATE  MAXDAT.CORP_ETL_MFB_BATCH SET cancel_dt = SYSDATE , cancel_by = 'NYSOH-15529'    WHERE BATCH_NAME IN ( 'NYSOH-FAX-1/25/2019-4:20:52 PM');
UPDATE  MAXDAT.CORP_ETL_MFB_BATCH SET cancel_dt = SYSDATE , cancel_by = 'NYSOH-15529'    WHERE BATCH_NAME IN ( '538163-5/19/2017-2:34:17 PM-127619');
UPDATE  MAXDAT.CORP_ETL_MFB_BATCH SET cancel_dt = SYSDATE , cancel_by = 'NYSOH-15529'    WHERE BATCH_NAME IN ( '815144-2/26/2019-9:56:10 AM-149078');
UPDATE  MAXDAT.CORP_ETL_MFB_BATCH SET cancel_dt = SYSDATE , cancel_by = 'NYSOH-15529'    WHERE BATCH_NAME IN ( 'NYSOH-FAX-1/10/2019-2:29:02 PM');
UPDATE  MAXDAT.CORP_ETL_MFB_BATCH SET cancel_dt = SYSDATE , cancel_by = 'NYSOH-15529'    WHERE BATCH_NAME IN ( 'NYSOH-FAX-6/4/2019-4:12:06 PM');
UPDATE  MAXDAT.CORP_ETL_MFB_BATCH SET cancel_dt = SYSDATE , cancel_by = 'NYSOH-15529'    WHERE BATCH_NAME IN ( 'NYSOH-FAX-7/25/2018-3:13:04 PM');
UPDATE  MAXDAT.CORP_ETL_MFB_BATCH SET cancel_dt = SYSDATE , cancel_by = 'NYSOH-15529'    WHERE BATCH_NAME IN ( '571574-7/24/2017-12:59:19 PM-89436');
UPDATE  MAXDAT.CORP_ETL_MFB_BATCH SET cancel_dt = SYSDATE , cancel_by = 'NYSOH-15529'    WHERE BATCH_NAME IN ( '571577-7/24/2017-12:59:40 PM-132866');

UPDATE  MAXDAT.CORP_ETL_MFB_BATCH_STG SET cancel_dt = SYSDATE , cancel_by = 'NYSOH-15529'  WHERE BATCH_NAME IN ( 'NYSOH-FAX-1/25/2019-4:20:52 PM');
UPDATE  MAXDAT.CORP_ETL_MFB_BATCH_STG SET cancel_dt = SYSDATE , cancel_by = 'NYSOH-15529'  WHERE BATCH_NAME IN ( '538163-5/19/2017-2:34:17 PM-127619');
UPDATE  MAXDAT.CORP_ETL_MFB_BATCH_STG SET cancel_dt = SYSDATE , cancel_by = 'NYSOH-15529'  WHERE BATCH_NAME IN ( '815144-2/26/2019-9:56:10 AM-149078');
UPDATE  MAXDAT.CORP_ETL_MFB_BATCH_STG SET cancel_dt = SYSDATE , cancel_by = 'NYSOH-15529'  WHERE BATCH_NAME IN ( 'NYSOH-FAX-1/10/2019-2:29:02 PM');
UPDATE  MAXDAT.CORP_ETL_MFB_BATCH_STG SET cancel_dt = SYSDATE , cancel_by = 'NYSOH-15529'  WHERE BATCH_NAME IN ( 'NYSOH-FAX-6/4/2019-4:12:06 PM');
UPDATE  MAXDAT.CORP_ETL_MFB_BATCH_STG SET cancel_dt = SYSDATE , cancel_by = 'NYSOH-15529'  WHERE BATCH_NAME IN ( 'NYSOH-FAX-7/25/2018-3:13:04 PM');
UPDATE  MAXDAT.CORP_ETL_MFB_BATCH_STG SET cancel_dt = SYSDATE , cancel_by = 'NYSOH-15529'  WHERE BATCH_NAME IN ( '571574-7/24/2017-12:59:19 PM-89436');
UPDATE  MAXDAT.CORP_ETL_MFB_BATCH_STG SET cancel_dt = SYSDATE , cancel_by = 'NYSOH-15529'  WHERE BATCH_NAME IN ( '571577-7/24/2017-12:59:40 PM-132866');



---Cancel the 2 records in the documents table

update NYHIX_ETL_MAIL_FAX_DOC_V2 set CANCEL_DT  = to_date('07/24/2017', 'mm/dd/yyyy') ,CANCEL_BY = 'Devops-6630',ASF_CANCEL_DOC = 'Y' ,CANCEL_REASON = 'Inactivated' ,CANCEL_METHOD = 'Exception' ,INSTANCE_STATUS = 'Complete' ,INSTANCE_END_DATE = to_date('07/24/2017', 'mm/dd/yyyy') , STG_DONE_DATE  = to_date('07/24/2017', 'mm/dd/yyyy') ,where  BATCH_NAME IN ('571574-7/24/2017-12:59:19 PM-89436');
update NYHIX_ETL_MAIL_FAX_DOC_V2 set CANCEL_DT  = to_date('07/24/2017', 'mm/dd/yyyy') ,CANCEL_BY = 'Devops-6630',ASF_CANCEL_DOC = 'Y' ,CANCEL_REASON = 'Inactivated' ,CANCEL_METHOD = 'Exception' ,INSTANCE_STATUS = 'Complete' ,INSTANCE_END_DATE  = to_date('07/24/2017', 'mm/dd/yyyy') ,STG_DONE_DATE  = to_date('07/24/2017', 'mm/dd/yyyy') ,where  BATCH_NAME IN ('571577-7/24/2017-12:59:40 PM-132866');
-------------------------------------------------------------------------------------------------------------
---Cancel the 6 records in the documents table

UPDATE MAXDAT.D_MFB_CURRENT SET CANCEL_DT  = TO_DATE('11/12/2019', 'MM/DD/YYYY') ,CANCEL_BY = 'Devops-6630' ,CANCEL_REASON = 'INACTIVATED' ,CANCEL_METHOD = 'EXCEPTION' ,INSTANCE_STATUS = 'COMPLETE' WHERE BATCH_NAME IN ('NYSOH-FAX-1/25/2019-4:20:52 PM');
UPDATE MAXDAT.D_MFB_CURRENT SET CANCEL_DT  = TO_DATE('11/12/2019', 'MM/DD/YYYY') ,CANCEL_BY = 'Devops-6630' ,CANCEL_REASON = 'INACTIVATED' ,CANCEL_METHOD = 'EXCEPTION' ,INSTANCE_STATUS = 'COMPLETE' WHERE BATCH_NAME IN ('538163-5/19/2017-2:34:17 PM-127619');
UPDATE MAXDAT.D_MFB_CURRENT SET CANCEL_DT  = TO_DATE('11/12/2019', 'MM/DD/YYYY') , CANCEL_BY = 'Devops-6630' ,CANCEL_REASON = 'INACTIVATED' ,CANCEL_METHOD = 'EXCEPTION' ,INSTANCE_STATUS = 'COMPLETE' WHERE BATCH_NAME IN ('815144-2/26/2019-9:56:10 AM-149078');
UPDATE MAXDAT.D_MFB_CURRENT SET CANCEL_DT  = TO_DATE('11/12/2019', 'MM/DD/YYYY') ,CANCEL_BY = 'Devops-6630' ,CANCEL_REASON = 'INACTIVATED' ,CANCEL_METHOD = 'EXCEPTION' ,INSTANCE_STATUS = 'COMPLETE' WHERE BATCH_NAME IN ('NYSOH-FAX-1/10/2019-2:29:02 PM');
UPDATE MAXDAT.D_MFB_CURRENT SET CANCEL_DT  = TO_DATE('11/12/2019', 'MM/DD/YYYY') ,CANCEL_BY = 'Devops-6630' ,CANCEL_REASON = 'INACTIVATED' , CANCEL_METHOD = 'EXCEPTION' ,INSTANCE_STATUS = 'COMPLETE' WHERE BATCH_NAME IN ('NYSOH-FAX-6/4/2019-4:12:06 PM');
UPDATE MAXDAT.D_MFB_CURRENT SET CANCEL_DT  = TO_DATE('0/12/2019', 'MM/DD/YYYY') ,CANCEL_BY = 'Devops-6630' ,CANCEL_REASON = 'INACTIVATED' ,CANCEL_METHOD = 'EXCEPTION' ,INSTANCE_STATUS = 'COMPLETE' WHERE BATCH_NAME IN ('NYSOH-FAX-7/25/2018-3:13:04 PM');
--------------------------------------------------------------

--alter session set nls_date_format ='MON-DD-YYYY HH:MI:SS am';

DELETE FROM MAXDAT.F_MFB_BY_HOUR WHERE MFB_BI_ID IN ( SELECT MFB_BI_ID FROM MAXDAT.D_MFB_CURRENT WHERE BATCH_NAME IN ('NYSOH-FAX-1/25/2019-4:20:52 PM')) and D_Date > to_date('19-05-2017 15:42:36','DD-MM-YYYY HH24:MI:SS');
DELETE FROM MAXDAT.F_MFB_BY_HOUR WHERE MFB_BI_ID IN ( SELECT MFB_BI_ID FROM MAXDAT.D_MFB_CURRENT WHERE BATCH_NAME IN ('538163-5/19/2017-2:34:17 PM-127619')) and D_Date > to_date('19-05-2017 15:01:17','DD-MM-YYYY HH24:MI:SS');
DELETE FROM MAXDAT.F_MFB_BY_HOUR WHERE MFB_BI_ID IN ( SELECT MFB_BI_ID FROM MAXDAT.D_MFB_CURRENT WHERE BATCH_NAME IN ('815144-2/26/2019-9:56:10 AM-149078')) and D_Date > to_date('05-03-2019 00:00:00','DD-MM-YYYY HH24:MI:SS');
DELETE FROM MAXDAT.F_MFB_BY_HOUR WHERE MFB_BI_ID IN ( SELECT MFB_BI_ID FROM MAXDAT.D_MFB_CURRENT WHERE BATCH_NAME IN ('NYSOH-FAX-1/10/2019-2:29:02 PM')) and D_Date > to_date('18-01-2019 03:55:00','DD-MM-YYYY HH24:MI:SS');
DELETE FROM MAXDAT.F_MFB_BY_HOUR WHERE MFB_BI_ID IN ( SELECT MFB_BI_ID FROM MAXDAT.D_MFB_CURRENT WHERE BATCH_NAME IN ('NYSOH-FAX-6/4/2019-4:12:06 PM')) and D_Date > to_date('14-06-2019 06:39:00','DD-MM-YYYY HH24:MI:SS');
DELETE FROM MAXDAT.F_MFB_BY_HOUR WHERE MFB_BI_ID IN ( SELECT MFB_BI_ID FROM MAXDAT.D_MFB_CURRENT WHERE BATCH_NAME IN ('NYSOH-FAX-7/25/2018-3:13:04 PM')) and D_Date > to_date('25-07-2018 00:00:00','DD-MM-YYYY HH24:MI:SS');
 -----------------------

