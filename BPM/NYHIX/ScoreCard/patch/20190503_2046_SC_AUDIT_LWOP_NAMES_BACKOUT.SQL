set echo on

set verify on

-----------------------------------------------------
-- THE BACKUP TABLES ARE 
-- DP_SCORECARD.SC_AUDIT_LWOP_20190503_BAK
-- DP_SCORECARD.SC_AUDIT_LWOP_AUD_20190503_BAK
-----------------------------------------------------

ALTER TABLE DP_SCORECARD.SC_AUDIT_LWOP
DISABLE ALL TRIGGERS;

-----------------------------------------------------

UPDATE DP_SCORECARD.SC_AUDIT_LWOP LWOP
SET ( LWOP_CREATE_USER, LWOP_UPDATE_USER ) 
= 
(	SELECT DISTINCT LWOP_CREATE_USER, LWOP_UPDATE_USER  
			FROM DP_SCORECARD.SC_AUDIT_LWOP_20190503_BAK BAK
			WHERE BAK.LWOP_INSTANCE_ID = LWOP.LWOP_INSTANCE_ID
)			
WHERE LWOP_INSTANCE_ID 
IN ( 	SELECT LWOP_INSTANCE_ID
		FROM DP_SCORECARD.SC_AUDIT_LWOP_20190503_BAK
	);

COMMIT;	

-------------------------------------------

UPDATE DP_SCORECARD.SC_AUDIT_LWOP_AUD AUD
SET ( LWOP_CREATE_USER, LWOP_UPDATE_USER )
= ( SELECT LWOP_CREATE_USER, LWOP_UPDATE_USER
    FROM SC_AUDIT_LWOP_AUD_20190503_BAK BAK
    WHERE BAK.LWOP_INSTANCE_ID  =   AUD.LWOP_INSTANCE_ID
    AND BAK.LWOP_UPDATE_DATE    =   AUD.LWOP_UPDATE_DATE
    AND BAK.RECORD_TYPE         =   AUD.RECORD_TYPE
    AND BAK.RECORD_ACTION       =   AUD.RECORD_ACTION
  )
WHERE (LWOP_INSTANCE_ID, LWOP_UPDATE_DATE, RECORD_TYPE, RECORD_ACTION) 
IN ( SELECT LWOP_INSTANCE_ID, LWOP_UPDATE_DATE, RECORD_TYPE, RECORD_ACTION 
FROM SC_AUDIT_LWOP_AUD_20190503_BAK BAK
 );

COMMIT;
