CREATE OR REPLACE FORCE VIEW MAXDAT.PP_WFM_STAFF_SV
AS  
SELECT STAFF_ID
,NATIONAL_ID
,LAST_NAME
,FIRST_NAME
,MIDDLE_NAME
,SUFFIX
,HIRE_DATE
,TERMINATION_DATE
,SCHEDULE_TYPE
,DELETE_DATE
,SENIORITY_EFFECTIVE_DATE
,OWNER_USER
,MODIFY_USER
,OWNER_DATE
,MODIFY_DATE
,EMAIL_ADDRESS
,COMMAND_SCRIPT
,MESSAGE_BUFFER
,TO_DATE(SECONDARY_ID,'mm/dd/yyyy') secondary_id
,ADDRESS
,WORK_PHONE
,HOME_PHONE
,TERMINATION_POLICY_ID
,TERMINATION_REASON
,PIP_ADDRESS
,TEXT_ADDRESS
,CELL_PHONE
,EXTRACT_DT
,LAST_UPDATE_DT
,LAST_UPDATED_BY
FROM PP_WFM_STAFF
WHERE regexp_like(SECONDARY_ID,'^[0-1]?[0-9]/[0-3]?[0-9]/20[0123][0-9]')
UNION
SELECT STAFF_ID
,NATIONAL_ID
,LAST_NAME
,FIRST_NAME
,MIDDLE_NAME
,SUFFIX
,HIRE_DATE
,TERMINATION_DATE
,SCHEDULE_TYPE
,DELETE_DATE
,SENIORITY_EFFECTIVE_DATE
,OWNER_USER
,MODIFY_USER
,OWNER_DATE
,MODIFY_DATE
,EMAIL_ADDRESS
,COMMAND_SCRIPT
,MESSAGE_BUFFER
,NULL secondary_id
,ADDRESS
,WORK_PHONE
,HOME_PHONE
,TERMINATION_POLICY_ID
,TERMINATION_REASON
,PIP_ADDRESS
,TEXT_ADDRESS
,CELL_PHONE
,EXTRACT_DT
,LAST_UPDATE_DT
,LAST_UPDATED_BY
FROM PP_WFM_STAFF
WHERE (NOT regexp_like(SECONDARY_ID,'^[0-1]?[0-9]/[0-3]?[0-9]/20[0123][0-9]') OR SECONDARY_ID IS NULL)
WITH READ ONLY;


GRANT SELECT ON MAXDAT.PP_WFM_STAFF_SV TO MAXDAT_READ_ONLY;
