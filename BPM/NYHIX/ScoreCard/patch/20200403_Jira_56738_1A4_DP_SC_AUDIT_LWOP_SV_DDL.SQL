 CREATE OR REPLACE FORCE EDITIONABLE VIEW DP_SCORECARD.SC_AUDIT_LWOP_SV 
  (LWOP_INSTANCE_ID, UPDATED_BY_NATID, STAFF_STAFF_ID, HIRE_DATE, 
  LWOP_OCCURRENCE_DATE, LWOP_UPDATE_DATE, 
  LWOP_HOURS, START_DATE, LWOP_LIMIT, LWOP_BALANCE, MESSAGE) AS 
  SELECT
	LWOP_INSTANCE_ID, 
	UPDATED_BY_NATID,
    STAFF_STAFF_ID, 
	HIRE_DATE, 
	LWOP_OCCURRENCE_DATE, 
	LWOP_UPDATE_DATE,
	CASE WHEN REC_TYPE = 'LWOP'
		THEN LWOP_HOURS*-1 
		ELSE LWOP_HOURS
	END							AS LWOP_HOURS, 
	ACCRUAL_START_DATE       	AS START_DATE, 
	80 AS LWOP_LIMIT, 
	LWOP_BALANCE,
	CASE 
		WHEN REC_TYPE = 'LWOP'
		OR REC_TYPE = 'ACCRUAL'
			THEN MESSAGE
			ELSE REC_DESC
		END 					AS MESSAGE
	FROM SC_AUDIT_SPPL_LWOP LB
	ORDER BY STAFF_STAFF_ID, HIRE_DATE, LWOP_OCCURRENCE_DATE DESC, LWOP_INSTANCE_ID, LWOP_UPDATE_DATE DESC;

COMMIT;    

GRANT SELECT ON DP_SCORECARD.SC_AUDIT_LWOP_SV TO MAXDAT;
GRANT SELECT ON DP_SCORECARD.SC_AUDIT_LWOP_SV TO MAXDAT_REPORTS;
GRANT SELECT ON DP_SCORECARD.SC_AUDIT_LWOP_SV TO MAXDAT_READ_ONLY;
GRANT SELECT ON DP_SCORECARD.SC_AUDIT_LWOP_SV TO DP_SCORECARD_READ_ONLY;

COMMIT;