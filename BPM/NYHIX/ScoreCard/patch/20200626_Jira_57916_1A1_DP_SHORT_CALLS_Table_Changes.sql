--------------------------------------------------------------------------------------
-----------------------SAVE OLD TABLE VERSIONS------------------------------------
--------------------------------------------------------------------------------------

CREATE TABLE DP_SCORECARD.SC_SUMMARY_CC_WRK_20200724_PROD
  AS (SELECT * FROM DP_SCORECARD.SC_SUMMARY_CC_WRK);

CREATE TABLE DP_SCORECARD.PP_WFM_DAILY_SUMMARY_WRK_20200724_PROD
  AS (SELECT * FROM DP_SCORECARD.PP_WFM_DAILY_SUMMARY_WRK);
  
CREATE TABLE DP_SCORECARD.SC_SUMMARY_CC_20200724_PROD
  AS (SELECT * FROM DP_SCORECARD.SC_SUMMARY_CC);

CREATE TABLE DP_SCORECARD.SC_SUMMARY_CC_ROLLUP_20200724_PROD
  AS (SELECT * FROM DP_SCORECARD.SC_SUMMARY_CC_ROLLUP);
  
COMMIT;

grant select on "DP_SCORECARD"."SC_SUMMARY_CC_WRK_20200724_PROD" to MAXDAT;
grant select on "DP_SCORECARD"."SC_SUMMARY_CC_WRK_20200724_PROD" to MAXDAT_REPORTS;
grant select on "DP_SCORECARD"."SC_SUMMARY_CC_WRK_20200724_PROD" to MAXDAT_READ_ONLY;
grant select on "DP_SCORECARD"."SC_SUMMARY_CC_WRK_20200724_PROD" to DP_SCORECARD_READ_ONLY;
grant INSERT, SELECT, UPDATE on "DP_SCORECARD"."SC_SUMMARY_CC_WRK_20200724_PROD" to DP_SCORECARD_OLTP_SIU;
grant DELETE, INSERT, UPDATE, SELECT on "DP_SCORECARD"."SC_SUMMARY_CC_WRK_20200724_PROD" to DP_SCORECARD_OLTP_SIUD;

commit;

grant select on "DP_SCORECARD"."PP_WFM_DAILY_SUMMARY_WRK_20200724_PROD" to MAXDAT;
grant select on "DP_SCORECARD"."PP_WFM_DAILY_SUMMARY_WRK_20200724_PROD" to MAXDAT_REPORTS;
grant select on "DP_SCORECARD"."PP_WFM_DAILY_SUMMARY_WRK_20200724_PROD" to MAXDAT_READ_ONLY;
grant select on "DP_SCORECARD"."PP_WFM_DAILY_SUMMARY_WRK_20200724_PROD" to DP_SCORECARD_READ_ONLY;
grant INSERT, SELECT, UPDATE on "DP_SCORECARD"."PP_WFM_DAILY_SUMMARY_WRK_20200724_PROD" to DP_SCORECARD_OLTP_SIU;
grant DELETE, INSERT, UPDATE, SELECT on "DP_SCORECARD"."PP_WFM_DAILY_SUMMARY_WRK_20200724_PROD" to DP_SCORECARD_OLTP_SIUD;

commit;

grant select on "DP_SCORECARD"."SC_SUMMARY_CC_20200724_PROD" to MAXDAT;
grant select on "DP_SCORECARD"."SC_SUMMARY_CC_20200724_PROD" to MAXDAT_REPORTS;
grant select on "DP_SCORECARD"."SC_SUMMARY_CC_20200724_PROD" to MAXDAT_READ_ONLY;
grant select on "DP_SCORECARD"."SC_SUMMARY_CC_20200724_PROD" to DP_SCORECARD_READ_ONLY;
grant INSERT, SELECT, UPDATE on "DP_SCORECARD"."SC_SUMMARY_CC_20200724_PROD" to DP_SCORECARD_OLTP_SIU;
grant DELETE, INSERT, UPDATE, SELECT on "DP_SCORECARD"."SC_SUMMARY_CC_20200724_PROD" to DP_SCORECARD_OLTP_SIUD;

commit;

grant select on "DP_SCORECARD"."SC_SUMMARY_CC_ROLLUP_20200724_PROD" to MAXDAT;
grant select on "DP_SCORECARD"."SC_SUMMARY_CC_ROLLUP_20200724_PROD" to MAXDAT_REPORTS;
grant select on "DP_SCORECARD"."SC_SUMMARY_CC_ROLLUP_20200724_PROD" to MAXDAT_READ_ONLY;
grant select on "DP_SCORECARD"."SC_SUMMARY_CC_ROLLUP_20200724_PROD" to DP_SCORECARD_READ_ONLY;
grant INSERT, SELECT, UPDATE on "DP_SCORECARD"."SC_SUMMARY_CC_ROLLUP_20200724_PROD" to DP_SCORECARD_OLTP_SIU;
grant DELETE, INSERT, UPDATE, SELECT on "DP_SCORECARD"."SC_SUMMARY_CC_ROLLUP_20200724_PROD" to DP_SCORECARD_OLTP_SIUD;

commit;


--------------------------------------------------------------------------------------
-----------------------SC_SUMMARY_CC TABLE_UPDATES------------------------------------
--------------------------------------------------------------------------------------

ALTER TABLE DP_SCORECARD.SC_SUMMARY_CC
RENAME COLUMN THREE_MONTH_ADHERENCE_FLAG TO THREE_MONTH_ADHERENCE_CONFORMANCE_FLAG;

COMMIT;


ALTER TABLE DP_SCORECARD.SC_SUMMARY_CC
ADD (
FIRST_PRIOR_MONTH_SC_AGENT_DISCONNECTED_SHORT_CALLS NUMBER(5,0),
FIRST_PRIOR_MONTH_SC_TOT_CALLS_ANSWERED NUMBER,
SECOND_PRIOR_MONTH_SC_AGENT_DISCONNECTED_SHORT_CALLS  NUMBER(5,0),
SECOND_PRIOR_MONTH_SC_TOT_CALLS_ANSWERED NUMBER,
FIRST_PRIOR_MONTH_RTQ_TOT_TOT_RETURN_TO_QUEUE NUMBER,
FIRST_PRIOR_MONTH_RTQ_CALLS_OFFERED NUMBER(6,0),
SECOND_PRIOR_MONTH_RTQ_TOT_TOT_RETURN_TO_QUEUE NUMBER,
SECOND_PRIOR_MONTH_RTQ_CALLS_OFFERED NUMBER(6,0),
FIRST_PRIOR_MONTH_SUM_QC_SCORE NUMBER
,FIRST_PRIOR_MONTH_COUNT_QC_SCORE NUMBER
,SECOND_PRIOR_MONTH_SUM_QC_SCORE NUMBER
,SECOND_PRIOR_MONTH_COUNT_QC_SCORE NUMBER,
THREE_MONTH_ADHERENCE_MISSED_COUNT	NUMBER(1,0),
THREE_MONTH_ADHERENCE_MET_COUNT	NUMBER(1,0),
THREE_MONTH_SHORT_CALLS_REQ_MISSED_COUNT	NUMBER(1,0),
THREE_MONTH_SHORT_CALLS_REQ_MET_COUNT	NUMBER(1,0),
THREE_MONTH_ADHERENCE_FLAG	NUMBER(1,0),
THREE_MONTH_SHORT_CALLS_FLAG	NUMBER(1,0),
MONTHLY_SHORT_CALLS_FLAG	NUMBER(1,0)
);

COMMIT;

--------------------------------------------------------------------------------------
-----------------------SC_SUMMARY_CC_ROLLUP TABLE_UPDATES------------------------------------
--------------------------------------------------------------------------------------

ALTER TABLE DP_SCORECARD.SC_SUMMARY_CC_ROLLUP
ADD (
AGENT_DISCONNECTED_SHORT_CALLS_DT_AGG NUMBER(5,0),
TOT_CALLS_ANSWERED_DT_AGG NUMBER,
TOT_TOT_RETURN_TO_QUEUE_DT_AGG NUMBER,
CALLS_OFFERED_DT_AGG NUMBER(6,0),
FIRST_PRIOR_MONTH_SC_AGENT_DISCONNECTED_SHORT_CALLS NUMBER(5,0),
FIRST_PRIOR_MONTH_SC_TOT_CALLS_ANSWERED NUMBER,
SECOND_PRIOR_MONTH_SC_AGENT_DISCONNECTED_SHORT_CALLS  NUMBER(5,0),
SECOND_PRIOR_MONTH_SC_TOT_CALLS_ANSWERED NUMBER,
FIRST_PRIOR_MONTH_RTQ_TOT_TOT_RETURN_TO_QUEUE NUMBER,
FIRST_PRIOR_MONTH_RTQ_CALLS_OFFERED NUMBER(6,0),
SECOND_PRIOR_MONTH_RTQ_TOT_TOT_RETURN_TO_QUEUE NUMBER,
SECOND_PRIOR_MONTH_RTQ_CALLS_OFFERED NUMBER(6,0),
SUM_QC_SCORE_DT_AGG NUMBER,
COUNT_QC_SCORE_DT_AGG NUMBER,
FIRST_PRIOR_MONTH_SUM_QC_SCORE_DT_AGG NUMBER,
FIRST_PRIOR_MONTH_COUNT_QC_SCORE_DT_AGG NUMBER,
SECOND_PRIOR_MONTH_SUM_QC_SCORE_DT_AGG NUMBER,
SECOND_PRIOR_MONTH_COUNT_QC_SCORE_DT_AGG NUMBER,
ADHERENCE_TOT_LOGGED_IN_TIME_DT_AGG NUMBER,
ADHERENCE_TOT_NOT_READY_TIME_DT_AGG NUMBER,
LAG_TIME_TOT_SCHED_PROD_TIME_DT_AGG NUMBER,
FIRST_PRIOR_MONTH_ADHERENCE_TOT_LOGGED_IN_TIME_DT_AGG NUMBER,
FIRST_PRIOR_MONTH_ADHERENCE_TOT_NOT_READY_TIME_DT_AGG NUMBER,
FIRST_PRIOR_MONTH_ADHERENCE_LAG_TIME_TOT_SCHED_PROD_TIME_DT_AGG NUMBER,
SECOND_PRIOR_MONTH_ADHERENCE_TOT_LOGGED_IN_TIME_DT_AGG NUMBER,
SECOND_PRIOR_MONTH_ADHERENCE_TOT_NOT_READY_TIME_DT_AGG NUMBER,
SECOND_PRIOR_MONTH_ADHERENCE_LAG_TIME_TOT_SCHED_PROD_TIME_DT_AGG NUMBER,
THREE_MONTH_TEAM_QUALITY_REQ_MISSED_COUNT NUMBER(1,0),
THREE_MONTH_TEAM_ADHERENCE_REQ_MISSED_COUNT NUMBER(1,0),
THREE_MONTH_AVG_TEAM_QUALITY NUMBER,
THREE_MONTH_AVG_TEAM_ADHERENCE NUMBER,
THREE_MONTH_SHORT_CALLS_REQ_MISSED_COUNT	NUMBER(1,0),
THREE_MONTH_SHORT_CALLS_REQ_MET_COUNT	NUMBER(1,0),
THREE_MONTH_RTQ_REQ_MISSED_COUNT	NUMBER(1,0),
THREE_MONTH_RTQ_REQ_MET_COUNT	NUMBER(1,0),
THREE_MONTH_TRTQ_TSC_FLAG	NUMBER(1,0),
THREE_MONTH_TEAM_QUALITY_DT_AGG_FLAG	NUMBER(1,0),
THREE_MONTH_TEAM_ADHERENCE_DT_AGG_FLAG	NUMBER(1,0)
);

COMMIT;
--------------------------------------------------------------------------------------
