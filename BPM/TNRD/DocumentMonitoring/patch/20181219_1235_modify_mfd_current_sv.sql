
 CREATE OR REPLACE VIEW maxdat.d_mfd_current_sv as
 SELECT
    DCN
    , CREATE_DT
    , RECEIVED_DT
    , DOC_TYPE_CD
    , PAGE_COUNT
    , ECN
    , KOFAX_DCN
    , BATCH_ID
    , BATCH_NAME
    , CHANNEL
    , DOC_STATUS_CD
    , DOC_STATUS_DT
    , DOC_UPDATE_DT
    , DOC_UPDATED_BY_STAFF_ID
    , PRIORITY
    , APP_DOC_DATA_ID
    , FORM_TYPE_CD
    , SCAN_DT
    , RELEASE_DT
    , MAXE_ORIGINATION_DT
    , RESCANNED_IND
    , RETURN_MAIL_IND
    , RETURN_MAIL_REASON
    , RESCAN_COUNT
    , NOTE_ID
    , EXPEDITED_IND
    , RESEARCH_REQUESTED_IND
    , ORIG_DOC_TYPE_CD
    , ORIG_DOC_FORM_TYPE_CD
    , TRASHED_DOC_IND
    , TRASHED_BY
    , TRASHED_DT
    , FORM_TYPE
    , LINK_ID
    , LINKED_CLIENT
    , AUTO_LINKED_IND
    , LINK_DT
    , TIMELINESS_DAYS
    , TIMELINESS_DAYS_TYPE
    , JEOPARDY_DAYS
    , JEOPARDY_DAYS_TYPE
    , CURR_AGE_IN_CALENDAR_DAYS
    , CURR_AGE_IN_BUSINESS_DAYS
    , CURR_JEOPARDY_FLAG
    , CURR_TIMELINESS_STATUS
    , INSTANCE_STATUS
    , COMPLETE_DT
    , CANCEL_DT
    , CANCEL_REASON
    , CANCEL_METHOD
    , AUTO_POPULATE
    , KOFAX_STATION_ID
    , LINK_SLA_TIMELINESS
    , LINK_BUSINESS_DAYS_AGE
    , LINK_CALENDAR_DAYS_AGE
    , LINK_SLA_DAYS
    , LINKED_BY
    , RECIPIENT_ID
    , DS_TASK_COMPLETE_DATE
    , PROCESSED_DT
    , PROCESSED_MONTH
    , CYCLE_START_DATE
    , CYCLE_START_MONTH
    , LINK_JEOPARDY_STATUS
    , SCAN_PROCESSED_MONTH
    , FACILITY_RECEIPT_DATE
    , DS_TASK_TYPE
    , BUSINESS_UNIT_NAME
    , FOLSOM_RECEIPT_DATE
FROM MAXDAT.D_MFD_CURRENT md
WHERE (link_id = 0 AND NOT EXISTS(SELECT 1 FROM d_mfd_current m WHERE m.dcn = md.dcn AND m.ecn = md.ecn AND link_id != 0)
  OR (link_id != 0))
WITH read only;

 GRANT SELECT ON D_MFD_CURRENT_SV TO MAXDAT_READ_ONLY;