
  CREATE OR REPLACE VIEW F_MW_V2_BY_DATE_SV
AS
SELECT        d.MW_BI_ID,
              bdd.D_DATE,
              CASE WHEN bdd.D_DATE = TRUNC(d.CREATE_DATE) THEN 1 else 0 END AS CREATION_COUNT,
              CASE WHEN (bdd.D_DATE = TRUNC(d.COMPLETE_DATE) OR bdd.D_DATE = TRUNC(d.CANCEL_WORK_DATE)) THEN 0 ELSE 1 END AS INVENTORY_COUNT,
              CASE WHEN (bdd.D_DATE = TRUNC(d.COMPLETE_DATE) OR bdd.D_DATE = TRUNC(d.CANCEL_WORK_DATE)) THEN 1 else 0 END AS COMPLETION_COUNT
  FROM D_DATES bdd
  JOIN D_MW_V2_CURRENT d ON (bdd.D_DATE >= TRUNC(d.INSTANCE_START_DATE) AND (bdd.D_DATE <= d.INSTANCE_END_DATE OR d.INSTANCE_END_DATE IS NULL))
                                          OR bdd.D_DATE = TRUNC(d.INSTANCE_START_DATE)
                                          OR bdd.D_DATE = TRUNC(d.INSTANCE_END_DATE);


grant select on F_MW_V2_BY_DATE_SVto MAXDAT_READ_ONLY;