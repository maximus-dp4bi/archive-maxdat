/*
Created: 11/7/2019
Modified: 12/3/2019
Model: maxbae_maxbaeprd
Database: MS SQL Server 2016
Update OPS, BSE and mart tables to add current location and current management unit name
*/

USE [maxbae]
GO

ALTER TABLE [maxbaeprd].[OPS_WFM_AGENT]
ADD  [CURRENT_LOCATION] Varchar(50) NULL,
[CURRENT_MANAGEMENT_UNIT_NAME] Varchar(50) NULL;
go

ALTER TABLE [maxbaeprd].[BSE_WFM_AGENT]
ADD  [CURRENT_LOCATION] Varchar(50) NULL],
[CURRENT_MANAGEMENT_UNIT_NAME] Varchar(50) NULL;
go

ALTER TABLE [maxbaeprd].[D_EMPLOYEE_DLY]
ADD  [CURRENT_LOCATION] Varchar(50) NULL,
 [CURRENT_MANAGEMENT_UNIT_NAME] Varchar(50) NULL;
go

ALTER VIEW [maxbaeprd].[D_EMPLOYEE_DLY_V] AS
SELECT [e].[DT], [e].[PERSON_ID], [e].[FIRST_NAME], [e].[LAST_NAME], [e].[FULL_NAME], [e].[POSITION_TITLE], [e].[POSITION_TITLE_EFF_DT], [e].[DAYS_IN_POSITION], [e].[EMPLOYMENT_CATEGORY], [e].[STATUS], [e].[STATUS_EFF_DT], [e].[DAYS_IN_STATUS], [e].[CITY], [e].[STATE], [e].[ORG_ID_DELTEK], [e].[LABOR_LOCATION_DESC_DELTEK], [e].[ORG_ID_WORKDAY], [e].[PROJECT_ID_WORKDAY], [e].[PROJECT_NAME_WORKDAY], [e].[SITE_BARTECH], [e].[ACCOUNT_CD_CD_BARTECH], [e].[HOURLY_RT], [e].[HOURLY_RT_EFF_DT], [e].[DAYS_IN_HOURLY_RT], [e].[EMP_ID_MGR_LVL_1], [e].[MGR_NAME_LVL_1], [e].[MGR_LVL_1_EFF_DT], [e].[DAYS_IN_MGR_LVL_1], [e].[EMP_ID_MGR_LVL_2], [e].[MGR_NAME_LVL_2], [e].[MGR_LVL_2_EFF_DT], [e].[DAYS_IN_MGR_LVL_2], [e].[EMP_ID_MGR_LVL_3], [e].[MGR_NAME_LVL_3], [e].[MGR_LVL_3_EFF_DT], [e].[DAYS_IN_MGR_LVL_3], [e].[ORIGINAL_HIRE_DT], [e].[LENGTH_OF_SERVICE], [e].[DAYS_SINCE_ORIGINAL_HIRE], [e].[LAST_HIRE_DT], [e].[DAYS_SINCE_LAST_HIRE], [e].[CONVERSION_DT], [e].[DAYS_SINCE_CONVERSION], [e].[CONTINUOUS_SERVICE_DT], [e].[LOA_END_DT], [e].[DAYS_SINCE_LOA_END], [e].[TERMINATION_DT], [e].[DAYS_SINCE_TERMINATION], [e].[TERMINATION_REASON], [e].[TERMINATION_CATEGORY], [e].[HIRING_TEST_SCORE], [e].[TRAINING_DAYS], [e].[SUPPLIER], [e].[SUPPLIER_EFF_DT], [e].[REHIRE_DT], [e].[DAYS_SINCE_REHIRE], [e].[WORK_DAYS_PER_WK], [e].[LANGUAGE_1], [e].[LANGUAGE_2], [e].[MULTILINGUAL], [e].[ROLE], [e].[SITE_WFM], [e].[TEAM], [e].[TEAM_SET_NAME], [e].[TEAM_SET_NAME_EFF_DT], [e].[WORK_STATUS], [e].[MANAGEMENT_UNIT_NAME], [e].[JOB_TITLE], [e].[SITE_ACD], [e].[PROJECT_ID_ACD], [e].[PROJECT_NAME_ACD], [e].[PROGRAM_ID_ACD], [e].[PROGRAM_NAME_ACD], [e].[CREATE_DT], [e].[CREATED_BY], [e].[UPDATE_DT], [e].[UPDATED_BY], [e].[CURRENT_LOCATION], [e].[CURRENT_MANAGEMENT_UNIT_NAME]
FROM [maxbaeprd].[D_EMPLOYEE_DLY] [e]
go