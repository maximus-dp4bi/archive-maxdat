use role SYSADMIN;
use warehouse PUREINSIGHTS_PRD_LOAD_DAILY_WH;
use database PUREINSIGHTS_PRD;
use schema PUBLIC;

CREATE OR REPLACE VIEW D_PI_TRANSCRIPTION_PROGRAM_FLOW_MAPPING_VW COPY GRANTS AS
SELECT    
	pr.projectid													AS	projectid,
	pr.projectname													AS	projectname,
	t.programid														AS	programid,
	t.programname													AS	programname,
    TRIM(CAST(t.raw:flowId AS VARCHAR(255)))						AS	flowId,
    TRIM(CAST(t.raw:programId AS VARCHAR(255)))						AS	program_Id
FROM raw.transcription_program_flow_mapping T
	INNER JOIN D_PI_PROJECTS pr ON T.projectid = pr.projectid;

GRANT SELECT ON D_PI_TRANSCRIPTION_PROGRAM_FLOW_MAPPING_VW TO BI_PRODUCT_DEV;   
GRANT SELECT ON D_PI_TRANSCRIPTION_PROGRAM_FLOW_MAPPING_VW TO DATA_SUPPORT_ROLE;
GRANT SELECT ON D_PI_TRANSCRIPTION_PROGRAM_FLOW_MAPPING_VW TO DA_LAB_ADMIN;
GRANT SELECT ON D_PI_TRANSCRIPTION_PROGRAM_FLOW_MAPPING_VW TO DA_LAB_READ;
GRANT SELECT ON D_PI_TRANSCRIPTION_PROGRAM_FLOW_MAPPING_VW TO MAX_DEV;
GRANT SELECT ON D_PI_TRANSCRIPTION_PROGRAM_FLOW_MAPPING_VW TO OPS_ANALYTICS_TEAM;
GRANT SELECT ON D_PI_TRANSCRIPTION_PROGRAM_FLOW_MAPPING_VW TO PUBLIC;
GRANT SELECT ON D_PI_TRANSCRIPTION_PROGRAM_FLOW_MAPPING_VW TO INFA_DATA_CATALOG_DEV_READ;
GRANT SELECT ON D_PI_TRANSCRIPTION_PROGRAM_FLOW_MAPPING_VW TO PUREINSIGHTS_DEV_READ;
GRANT SELECT ON D_PI_TRANSCRIPTION_PROGRAM_FLOW_MAPPING_VW TO PI_DATA_INGEST_DEV_ALERT_USER;
GRANT DELETE, INSERT, REBUILD, REFERENCES, SELECT, TRUNCATE, UPDATE ON D_PI_TRANSCRIPTION_PROGRAM_FLOW_MAPPING_VW TO PUREINSIGHTS_DEV_POC;
