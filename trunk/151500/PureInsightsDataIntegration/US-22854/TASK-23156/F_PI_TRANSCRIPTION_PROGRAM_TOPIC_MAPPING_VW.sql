use role SYSADMIN;
use warehouse PUREINSIGHTS_PRD_LOAD_DAILY_WH;
use database PUREINSIGHTS_PRD;
use schema PUBLIC;

create or replace view F_PI_TRANSCRIPTION_PROGRAM_TOPIC_MAPPING_VW(
	PROJECTID,
	PROJECTNAME,
	PROGRAM_ID,
	PROGRAMNAME,
	PROGRAMID,
	TOPICID
) COPY GRANTS as
Select
  rt.projectId as projectId,
  rt.projectName as projectName,
  rt.programId as program_Id,
  rt.programName as programName,
  cast (rt.raw:programId as VARCHAR(255)) as programId,
  cast (rt.raw:topicId as VARCHAR(255)) as topicId
from RAW.TRANSCRIPTION_PROGRAM_TOPIC_MAPPING rt
join PUBLIC.D_PI_PROJECTS pr
on rt.projectId = pr.projectId;

GRANT SELECT ON F_PI_TRANSCRIPTION_PROGRAM_TOPIC_MAPPING_VW TO BI_PRODUCT_DEV;   
GRANT SELECT ON F_PI_TRANSCRIPTION_PROGRAM_TOPIC_MAPPING_VW TO DATA_SUPPORT_ROLE;
GRANT SELECT ON F_PI_TRANSCRIPTION_PROGRAM_TOPIC_MAPPING_VW TO DA_LAB_ADMIN;
GRANT SELECT ON F_PI_TRANSCRIPTION_PROGRAM_TOPIC_MAPPING_VW TO DA_LAB_READ;
GRANT SELECT ON F_PI_TRANSCRIPTION_PROGRAM_TOPIC_MAPPING_VW TO MAX_DEV;
GRANT SELECT ON F_PI_TRANSCRIPTION_PROGRAM_TOPIC_MAPPING_VW TO OPS_ANALYTICS_TEAM;
GRANT SELECT ON F_PI_TRANSCRIPTION_PROGRAM_TOPIC_MAPPING_VW TO PUBLIC;
GRANT SELECT ON F_PI_TRANSCRIPTION_PROGRAM_TOPIC_MAPPING_VW TO INFA_DATA_CATALOG_DEV_READ;
GRANT SELECT ON F_PI_TRANSCRIPTION_PROGRAM_TOPIC_MAPPING_VW TO PUREINSIGHTS_DEV_READ;
GRANT SELECT ON F_PI_TRANSCRIPTION_PROGRAM_TOPIC_MAPPING_VW TO PI_DATA_INGEST_DEV_ALERT_USER;
GRANT DELETE, INSERT, REBUILD, REFERENCES, SELECT, TRUNCATE, UPDATE ON F_PI_TRANSCRIPTION_PROGRAM_TOPIC_MAPPING_VW TO PUREINSIGHTS_DEV_POC;