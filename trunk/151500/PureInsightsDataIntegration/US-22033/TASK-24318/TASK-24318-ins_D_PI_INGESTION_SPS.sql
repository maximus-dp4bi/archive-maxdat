use role SYSADMIN;
use warehouse PUREINSIGHTS_PRD_LOAD_DAILY_WH;
use database PUREINSIGHTS_PRD;
use schema PUBLIC;

GRANT USAGE ON PROCEDURE DECISIONPOINT_PRD.STAGE.LOAD_PI_TRANSCRIPTION_PROGRAM_QUEUE_MAPPING_HISTORY_PROC(VARCHAR, BOOLEAN, BOOLEAN) TO PI_DATA_INGEST_PRD_ALERT_USER WITH GRANT OPTION;

DELETE FROM 
	PUBLIC.D_PI_INGESTION_SPS 
WHERE 	
	sp_name = 'LOAD_PI_TRANSCRIPTION_PROGRAM_QUEUE_MAPPING_HISTORY_PROC'
AND	schema_name = 'DECISIONPOINT_PRD.STAGE';

INSERT INTO
	PUBLIC.D_PI_INGESTION_SPS	
	(
		sp_name,
		schema_name,
		active,
		update_timestamp
	)
VALUES
	(	'LOAD_PI_TRANSCRIPTION_PROGRAM_QUEUE_MAPPING_HISTORY_PROC',	
		'DECISIONPOINT_PRD.STAGE',
		TRUE,
		current_timestamp()
	);
