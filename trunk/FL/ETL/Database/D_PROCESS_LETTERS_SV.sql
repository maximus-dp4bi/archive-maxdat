--------------------------------------------------------
--  FILE CREATED - TUESDAY-OCTOBER-01-2013   
--  FILE UPDATED - FRIDAY-JANUARY-10-2014 - SASIKANTH PAGADRAI
--------------------------------------------------------
--------------------------------------------------------
--  DDL FOR VIEW D_PROCESS_LETTERS_SV
--------------------------------------------------------

  CREATE OR REPLACE FORCE VIEW "D_PROCESS_LETTERS_SV" 
("PK_ID",
 "LETTER_REQ_ID",
 "CREATE_DATE",
 "CREATED_BY_NAME",
 "REQUESTED_ON_DATE",
 "STATUS",
 "STATUS_DATE",
 "TYPE",
 "CATEGORY",
 "USER_NAME",
 "SOURCE",
 "TRIGGERING_METHOD",
 --"BATCH_ID",
 "LANGUAGE",
 "DRIVER_TYPE",
 "DRIVER_KEY",
 "ACCOUNT_ID",
 "MEMBER_ID",
 "APP_ID",
 "LAST_UPDATE_DATE",
 "LAST_UPDATE_BY_NAME",
 "VALIDATED_DATE",
 "VALIDATED_OUTCOME",
 "TRANSMITTED_DATE",
 "CONFIRMED_DATE",
 "IMAGE_RECEIVED_DATE",
 "REPLACEMENT_REQUEST_ID",
 "CANCEL_DATE",
-- "COMPLETE_DATE",
 "ASSD_PROCESS_LETTER_REQUEST",
 "ASED_PROCESS_LETTER_REQUEST",
 "ASF_PROCESS_LETTER_REQUEST",
 "ASED_RECEIVED_CONFIRMATION",
 "ASF_RECEIVED_CONFIRMATION",
 "ASSD_RECEIVED_CONFIRMATION",
 "ASED_WAIT_UNTIL_NEW_RQST",
 "ASF_WAIT_UNTIL_NEW_RQST",
 "ASSD_WAIT_UNTIL_NEW_RQST",
 "GWF_TRANSMIT",
 "GWF_NEW_LETTER_NEEDED",
 "STAGE_DONE_DATE",
 "STG_EXTRACT_DATE",
 "STG_LAST_UPDATE_DATE",
 "INSTANCE_STATUS",
 "INSTANCE_COMPLETE_DATE",
 "LETTER_CODE",
 "ACCOUNT_NUMBER",
 "PERSON_NUMBER",
 "MAX_QC",
 "MAX_QC_USER",
 "FHKC_QC",
 "FHKC_QC_USER",
 "AGE_BUSINESS_DAYS",
 "AGE_CALENDAR_DAYS",
 "STATUS_AGE_BUSINESS_DAYS",
 "STATUS_AGE_CAL_DAYS") 
AS 
SELECT  
  PK_ID, 
  LETTER_REQ_ID, 
  CREATE_DATE, 
  CREATED_BY_NAME, 
  REQUESTED_ON_DATE, 
  STATUS, 
  STATUS_DATE, 
  TYPE , 
  CATEGORY , 
  USER_NAME , 
  SOURCE, 
  TRIGGERING_METHOD, 
--  BATCH_ID, 
  LANGUAGE , 
  DRIVER_TYPE, 
  DRIVER_KEY, 
  ACCOUNT_ID, 
  MEMBER_ID, 
  APP_ID, 
  LAST_UPDATE_DATE, 
  LAST_UPDATE_BY_NAME, 
  VALIDATED_DATE, 
  VALIDATED_OUTCOME , 
  TRANSMITTED_DATE, 
  CONFIRMED_DATE, 
  IMAGE_RECEIVED_DATE, 
  REPLACEMENT_REQUEST_ID , 
  Cancel_Date, 
--  COMPLETE_DATE, 
  ASSD_PROCESS_LETTER_REQUEST, 
  ASED_PROCESS_LETTER_REQUEST, 
  ASF_PROCESS_LETTER_REQUEST , 
  ASED_RECEIVED_CONFIRMATION, 
  ASF_RECEIVED_CONFIRMATION , 
  ASSD_RECEIVED_CONFIRMATION, 
  ASED_WAIT_UNTIL_NEW_RQST, 
  ASF_WAIT_UNTIL_NEW_RQST , 
  ASSD_WAIT_UNTIL_NEW_RQST , 
  GWF_TRANSMIT , 
  GWF_NEW_LETTER_NEEDED , 
  STAGE_DONE_DATE, 
  STG_EXTRACT_DATE, 
  STG_LAST_UPDATE_DATE, 
  INSTANCE_STATUS , 
  INSTANCE_COMPLETE_DATE, 
  LETTER_CODE , 
  ACCOUNT_NUMBER, 
  PERSON_NUMBER, 
  MAX_QC,
  MAX_QC_USER,
  FHKC_QC,
  FHKC_QC_USER,
  business_days_between(CREATE_DATE, sysdate)    as "AGE_IN_BUSINESS_DAYS",
  round(sysdate - create_date,0) as "AGE_IN_CALENDAR_DAYS",
  business_days_between(STATUS_DATE, sysdate) as "STATUS_AGE_IN_BUS_DAYS", 
  round(sysdate - STATUS_DATE,0 ) as "STATUS_AGE_IN_CAL_DAYS"
FROM   FLHK_ETL_PROCESS_LETTERS;

