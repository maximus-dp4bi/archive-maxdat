--------------------------------------------------------
--  File created - Monday-August-19-2013   
--------------------------------------------------------
DROP VIEW "D_MANAGE_WORK_SV";
/
--------------------------------------------------------
--  DDL for View D_MANAGE_WORK_SV
--------------------------------------------------------

  CREATE OR REPLACE FORCE VIEW "D_MANAGE_WORK_SV" ("TASK_ID", "PARENT_TASK_ID", "TASK_TYPE", "TASK_STATUS", "STATUS_DATE", "STATUS_REASON", "CREATE_DATE", "CREATED_BY_NAME", "PRIORITY", "DUE_DATE", "ASSIGNED_TO", "QUEUE", "CONTEXT", "DRIVER_TYPE", "DRIVER_KEY", "ACTION_CATEGORY", "RULE_EXECUTED", "ROLE_NAME", "CANCEL_WORK_DATE", "COMPLETE_DATE", "INSTANCE_STATUS", "LAST_UPDATE_DATE", "LAST_UPDATE_BY_NAME", "ASF_CANCEL_WORK", "ASF_COMPLETE_WORK", "ASSD_COMPLETE_TASK", "ASED_COMPLETE_TASK", "STATUS_AGE_BUS_DAYS", "STATUS_AGE_CAL_DAYS", "JEOPARDY_FLAG", "SLA_DAYS_TYPE", "SLA_JEOPARDY_DAYS", "SLA_TARGET_DAYS", "SLA_DAYS", "AGE_CALENDAR_DAYS", "AGE_BUSINESS_DAYS", "TIMELINESS_STATUS") AS SELECT  "TASK_ID",
 "PARENT_TASK_ID",
 "TASK_TYPE",
 "TASK_STATUS",
 "STATUS_DATE",
 "STATUS_REASON",
 "CREATE_DATE",
 "CREATED_BY_NAME",
 "PRIORITY",
 "DUE_DATE",
 "ASSIGNED_TO",
 "QUEUE",
 "CONTEXT",
 "DRIVER_TYPE",
 "DRIVER_KEY",
 "ACTION_CATEGORY",
 "RULE_EXECUTED",
 "ROLE_NAME",
 "CANCEL_WORK_DATE",
 "COMPLETE_DATE",
 "INSTANCE_STATUS",
 "LAST_UPDATE_DATE",
 "LAST_UPDATE_BY_NAME",
 "ASF_CANCEL_WORK",
 "ASF_COMPLETE_WORK",
 "ASSD_COMPLETE_TASK",
 "ASED_COMPLETE_TASK", 
 business_days_between(STATUS_DATE,sysdate) as  "STATUS_AGE_BUS_DAYS", 
 round(sysdate - status_date,0)  AS "STATUS_AGE_CAL_DAYS", 
 'N' AS "JEOPARDY_FLAG",
 NULL AS "SLA_DAYS_TYPE",
 0 AS "SLA_JEOPARDY_DAYS",
 0 AS "SLA_TARGET_DAYS",
 0 AS "SLA_DAYS",
 round(sysdate - create_date,0) AS "AGE_CALENDAR_DAYS", 
 business_days_between(CREATE_DATE, sysdate) AS "AGE_BUSINESS_DAYS",
 'Not Required' AS "TIMELINESS_STATUS"
FROM FLHK_ETL_MANAGE_WORK;
/
