--------------------------------------------------------
--  File created - Monday-December-30-2013   
--------------------------------------------------------
DROP TABLE "APPLICATION_TEMP";
--------------------------------------------------------
--  DDL for Table APPLICATION_TEMP
--------------------------------------------------------

  CREATE TABLE "APPLICATION_TEMP" ("APPLICATION_ID" NUMBER(10,0), "ACCOUNT_ID" NUMBER(10,0), "CELL_PHONE" VARCHAR2(20 CHAR), "EMAIL_ADDRESS" VARCHAR2(256 CHAR), "HOME_PHONE" VARCHAR2(20 CHAR), "JPA_VERSION" NUMBER(10,0) DEFAULT 1, "LANGUAGE_PREFERENCE" VARCHAR2(2 CHAR) DEFAULT ( 'en'), "MONTH_INCOME_DISCREPANCY_NOTE" VARCHAR2(1024 CHAR), "RECEIVED_DATE" DATE, "SOURCE" VARCHAR2(255 CHAR), "STATUS" VARCHAR2(80 CHAR), "APP_TYPE" VARCHAR2(32 CHAR), "STATUS_DATE" DATE, "UNPAID_MEDICAL_BILLS_IND" CHAR(1 CHAR), "NO_UNEARNED_INCOME_IND" VARCHAR2(1 CHAR), "WEB_APPLICATION_ID" VARCHAR2(64), "NO_EARNED_INCOME_IND" VARCHAR2(1 CHAR), "HOME_CITY" VARCHAR2(255 CHAR), "NOTES" VARCHAR2(4000 CHAR), "HOME_COUNTY" VARCHAR2(255 CHAR), "HOME_STREET" VARCHAR2(255 CHAR), "HOME_STREET2" VARCHAR2(255 CHAR), "HOME_STATE" VARCHAR2(255 CHAR), "HOME_POSTAL_CODE" VARCHAR2(255 CHAR), "MAILING_CITY" VARCHAR2(255 CHAR), "MAILING_COUNTY" VARCHAR2(255 CHAR), "MAILING_STREET" VARCHAR2(255 CHAR), "MAILING_STREET2" VARCHAR2(255 CHAR), "MAILING_STATE" VARCHAR2(255 CHAR), "MAILING_POSTAL_CODE" VARCHAR2(255 CHAR), "PREGNANCY_DUE_DATE" DATE, "INSERT_DATE" DATE DEFAULT SYSDATE, "INSERT_USER" VARCHAR2(100 CHAR) DEFAULT SUBSTR(coalesce(sys_context('USERENV','CLIENT_IDENTIFIER'),user),1,100), "UPDATE_DATE" DATE, "APP_ENTERED_BY" VARCHAR2(100 CHAR), "LAST_UPDATE_USER" VARCHAR2(100 CHAR), "APP_SIGNED_FLAG" VARCHAR2(1 CHAR), "CHILD_ID_SIGNED_FLAG" VARCHAR2(1 CHAR), "APP_SIGNED_DATE" DATE, "CHILD_ID_SIGNED_DATE" DATE, "MDCD_CASE_NUMBER" VARCHAR2(30 CHAR), "HOME_VALIDATED_FLAG" VARCHAR2(1 CHAR), "MAILING_VALIDATED_FLAG" VARCHAR2(1 CHAR), "RENEWAL_DATE" DATE, "APP_ENTERED_TIMESTAMP" DATE, "ASSOCIATED_DOCUMENT_TYPE" VARCHAR2(80 CHAR), "ASSOC_SRC_DOC_CONTROL_NUMBER" VARCHAR2(30 CHAR), "ACCOUNT_NUMBER" NUMBER(10,0), "INSERT_USER_ROLE" VARCHAR2(100 CHAR) DEFAULT SUBSTR(sys_context('VIDAENV','USER_ROLE'),1,100), "UPDATE_USER_ROLE" VARCHAR2(100 CHAR), "INSERT_JOB_NAME" VARCHAR2(100 CHAR) DEFAULT SUBSTR(sys_context('VIDAENV','JOB_NAME'),1,100), "LAST_UPDATE_JOB_NAME" VARCHAR2(100 CHAR), "ATO_ID" VARCHAR2(20)) ;

   COMMENT ON COLUMN "APPLICATION_TEMP"."APPLICATION_ID" IS 'System generated primary key';
   COMMENT ON COLUMN "APPLICATION_TEMP"."ACCOUNT_ID" IS 'If the APPLICATION_TEMP created an account or updated an account, this is an FK to the account.';
   COMMENT ON COLUMN "APPLICATION_TEMP"."CELL_PHONE" IS 'Cell phone number listed on APPLICATION_TEMP.';
   COMMENT ON COLUMN "APPLICATION_TEMP"."EMAIL_ADDRESS" IS 'E-mail address listed on APPLICATION_TEMP.';
   COMMENT ON COLUMN "APPLICATION_TEMP"."HOME_PHONE" IS 'Home phone number as it was entered on the APPLICATION_TEMP.';
   COMMENT ON COLUMN "APPLICATION_TEMP"."JPA_VERSION" IS 'This is a system level field that is used to manage optimistic locking in JPA.';
   COMMENT ON COLUMN "APPLICATION_TEMP"."LANGUAGE_PREFERENCE" IS 'Language preference as entered on the APPLICATION_TEMP';
   COMMENT ON COLUMN "APPLICATION_TEMP"."MONTH_INCOME_DISCREPANCY_NOTE" IS 'Monthly income discrepency note.';
   COMMENT ON COLUMN "APPLICATION_TEMP"."RECEIVED_DATE" IS 'Date the APPLICATION_TEMP was submitted by the applicant.';
   COMMENT ON COLUMN "APPLICATION_TEMP"."SOURCE" IS 'This designates where the applicant acquired the APPLICATION_TEMP, i.e. web, mail request, etc.';
   COMMENT ON COLUMN "APPLICATION_TEMP"."STATUS" IS 'Status of the APPLICATION_TEMP.';
   COMMENT ON COLUMN "APPLICATION_TEMP"."APP_TYPE" IS 'Type of APPLICATION_TEMP, i.e. new or renewal.';
   COMMENT ON COLUMN "APPLICATION_TEMP"."STATUS_DATE" IS 'Date the APPLICATION_TEMP status was last set.';
   COMMENT ON COLUMN "APPLICATION_TEMP"."UNPAID_MEDICAL_BILLS_IND" IS 'Unpaid medical bills indicator as it is listed on the APPLICATION_TEMP';
   COMMENT ON COLUMN "APPLICATION_TEMP"."NO_UNEARNED_INCOME_IND" IS 'No unearned income indicated on APPLICATION_TEMP.';
   COMMENT ON COLUMN "APPLICATION_TEMP"."WEB_APPLICATION_ID" IS 'This is the website assigned APPLICATION_TEMP_id.';
   COMMENT ON COLUMN "APPLICATION_TEMP"."NO_EARNED_INCOME_IND" IS 'No earned income indicated on APPLICATION_TEMP.';
   COMMENT ON COLUMN "APPLICATION_TEMP"."HOME_CITY" IS 'Home address city';
   COMMENT ON COLUMN "APPLICATION_TEMP"."NOTES" IS 'Notes on the APPLICATION_TEMP';
   COMMENT ON COLUMN "APPLICATION_TEMP"."HOME_COUNTY" IS 'Home address county';
   COMMENT ON COLUMN "APPLICATION_TEMP"."HOME_STREET" IS 'Home address line 1';
   COMMENT ON COLUMN "APPLICATION_TEMP"."HOME_STREET2" IS 'Home address line 2 ';
   COMMENT ON COLUMN "APPLICATION_TEMP"."HOME_STATE" IS 'Home address state';
   COMMENT ON COLUMN "APPLICATION_TEMP"."HOME_POSTAL_CODE" IS 'Home address zipcode';
   COMMENT ON COLUMN "APPLICATION_TEMP"."MAILING_CITY" IS 'Mailing address city';
   COMMENT ON COLUMN "APPLICATION_TEMP"."MAILING_COUNTY" IS 'Mailing address county';
   COMMENT ON COLUMN "APPLICATION_TEMP"."MAILING_STREET" IS 'Mailing address line 1';
   COMMENT ON COLUMN "APPLICATION_TEMP"."MAILING_STREET2" IS 'Mailing address line 2 ';
   COMMENT ON COLUMN "APPLICATION_TEMP"."MAILING_STATE" IS 'Mailing address state';
   COMMENT ON COLUMN "APPLICATION_TEMP"."MAILING_POSTAL_CODE" IS 'Mailing address zipcode';
   COMMENT ON COLUMN "APPLICATION_TEMP"."PREGNANCY_DUE_DATE" IS 'Pregnancy due date as it is listed on the APPLICATION_TEMP';
   COMMENT ON COLUMN "APPLICATION_TEMP"."INSERT_DATE" IS 'The date when the record get created.';
   COMMENT ON COLUMN "APPLICATION_TEMP"."INSERT_USER" IS 'The user who created the record .';
   COMMENT ON COLUMN "APPLICATION_TEMP"."UPDATE_DATE" IS 'The date when last update was made to the record.';
   COMMENT ON COLUMN "APPLICATION_TEMP"."APP_ENTERED_BY" IS 'APPLICATION_TEMP entered by field for APPLICATION_TEMP';
   COMMENT ON COLUMN "APPLICATION_TEMP"."LAST_UPDATE_USER" IS 'The user who modified the record recently .';
   COMMENT ON COLUMN "APPLICATION_TEMP"."APP_SIGNED_FLAG" IS 'APPLICATION_TEMP signed flag for APPLICATION_TEMP';
   COMMENT ON COLUMN "APPLICATION_TEMP"."CHILD_ID_SIGNED_FLAG" IS 'Child identification signed flag';
   COMMENT ON COLUMN "APPLICATION_TEMP"."APP_SIGNED_DATE" IS 'Date the APPLICATION_TEMP was signed.  (Comes from the form).';
   COMMENT ON COLUMN "APPLICATION_TEMP"."CHILD_ID_SIGNED_DATE" IS 'Child ID signed date';
   COMMENT ON COLUMN "APPLICATION_TEMP"."MDCD_CASE_NUMBER" IS 'The associated MedicAid Case Number- NOT the VIDA case number.';
   COMMENT ON COLUMN "APPLICATION_TEMP"."HOME_VALIDATED_FLAG" IS 'Flag indicating whether home address has been validated.';
   COMMENT ON COLUMN "APPLICATION_TEMP"."MAILING_VALIDATED_FLAG" IS 'Flag indicating whether mailing address has been validated.';
   COMMENT ON COLUMN "APPLICATION_TEMP"."RENEWAL_DATE" IS 'Renewal month-year associated with this APPLICATION_TEMP';
   COMMENT ON COLUMN "APPLICATION_TEMP"."ASSOC_SRC_DOC_CONTROL_NUMBER" IS 'The document control number of the associated source  document';
   COMMENT ON COLUMN "APPLICATION_TEMP"."ACCOUNT_NUMBER" IS 'Family account number sent in on the renewal. It should be matching ACCOUNT.ACCOUNT_NUMBER ';
   COMMENT ON COLUMN "APPLICATION_TEMP"."ATO_ID" IS 'The id of the APPLICATION_TEMP from ATM';
   COMMENT ON TABLE "APPLICATION_TEMP"  IS 'Holds meta data from a single APPLICATION_TEMP that is used for searching.';
/
--------------------------------------------------------
--  DDL for Index PK_APPLICATION_TEMP
--------------------------------------------------------

  CREATE UNIQUE INDEX "PK_APPLICATION_TEMP" ON "APPLICATION_TEMP" ("APPLICATION_ID") ;
/
--------------------------------------------------------
--  DDL for Index IDX_APP_ACCT_ID_RECD_DATE
--------------------------------------------------------

  CREATE INDEX "IDX_APP_ACCT_ID_RECD_DATE" ON "APPLICATION_TEMP" ("ACCOUNT_ID", "RECEIVED_DATE") ;
/
--------------------------------------------------------
--  DDL for Index UC_WEB_APPLICATION_TEMP_ID
--------------------------------------------------------

  CREATE UNIQUE INDEX "UC_WEB_APPLICATION_TEMP_ID" ON "APPLICATION_TEMP" ("WEB_APPLICATION_ID") ;
/
--------------------------------------------------------
--  DDL for Index IDX_APPLICATION_TEMP_APP_TYPE
--------------------------------------------------------

  CREATE INDEX "IDX_APPLICATION_TEMP_APP_TYPE" ON "APPLICATION_TEMP" ("APP_TYPE") ;
/
--------------------------------------------------------
--  DDL for Index IDX_APPLICATION_TEMP_STATUS
--------------------------------------------------------

  CREATE INDEX "IDX_APPLICATION_TEMP_STATUS" ON "APPLICATION_TEMP" ("STATUS") ;
/
--------------------------------------------------------
--  DDL for Index IDX_APPLICATION_TEMP_SOURCE
--------------------------------------------------------

  CREATE INDEX "IDX_APPLICATION_TEMP_SOURCE" ON "APPLICATION_TEMP" ("SOURCE") ;
/
--------------------------------------------------------
--  DDL for Index IDX_APP_ACCT_NUM
--------------------------------------------------------

  CREATE INDEX "IDX_APP_ACCT_NUM" ON "APPLICATION_TEMP" ("ACCOUNT_NUMBER") ;
/
--------------------------------------------------------
--  DDL for Index IDX_APP_RECD_DATE
--------------------------------------------------------

  CREATE INDEX "IDX_APP_RECD_DATE" ON "APPLICATION_TEMP" ("RECEIVED_DATE") ;
/
--------------------------------------------------------
--  DDL for Index IDX_APPLICATION_TEMP_LANG_PREF
--------------------------------------------------------

  CREATE INDEX "IDX_APPLICATION_TEMP_LANG_PREF" ON "APPLICATION_TEMP" ("LANGUAGE_PREFERENCE") ;
/
--------------------------------------------------------
--  Constraints for Table APPLICATION_TEMP
--------------------------------------------------------

  ALTER TABLE "APPLICATION_TEMP" MODIFY ("MAILING_VALIDATED_FLAG" NOT NULL ENABLE);
  ALTER TABLE "APPLICATION_TEMP" MODIFY ("HOME_VALIDATED_FLAG" NOT NULL ENABLE);
  ALTER TABLE "APPLICATION_TEMP" MODIFY ("CHILD_ID_SIGNED_FLAG" NOT NULL ENABLE);
  ALTER TABLE "APPLICATION_TEMP" MODIFY ("APP_SIGNED_FLAG" NOT NULL ENABLE);
  ALTER TABLE "APPLICATION_TEMP" MODIFY ("INSERT_USER" NOT NULL ENABLE);
  ALTER TABLE "APPLICATION_TEMP" MODIFY ("INSERT_DATE" NOT NULL ENABLE);
  ALTER TABLE "APPLICATION_TEMP" MODIFY ("APP_TYPE" NOT NULL ENABLE);
  ALTER TABLE "APPLICATION_TEMP" MODIFY ("SOURCE" NOT NULL ENABLE);
  ALTER TABLE "APPLICATION_TEMP" MODIFY ("RECEIVED_DATE" NOT NULL ENABLE);
  ALTER TABLE "APPLICATION_TEMP" MODIFY ("JPA_VERSION" NOT NULL ENABLE);
  ALTER TABLE "APPLICATION_TEMP" MODIFY ("APPLICATION_ID" NOT NULL ENABLE);
  ALTER TABLE "APPLICATION_TEMP" ADD CONSTRAINT "UC_WEB_APPLICATION_TEMP_ID" UNIQUE ("WEB_APPLICATION_ID") ENABLE;
  ALTER TABLE "APPLICATION_TEMP" ADD CONSTRAINT "CK_APPLN_HOME_VLDTD_FLAG" CHECK (	HOME_VALIDATED_FLAG In ('0','1') ) ENABLE;
  ALTER TABLE "APPLICATION_TEMP" ADD CONSTRAINT "PK_APPLICATION_TEMP" PRIMARY KEY ("APPLICATION_ID") ENABLE;
  ALTER TABLE "APPLICATION_TEMP" ADD CONSTRAINT "CK_APPLN_MAILING_VLDTD_FLAG" CHECK (	MAILING_VALIDATED_FLAG In ('0','1') ) ENABLE;
  ALTER TABLE "APPLICATION_TEMP" ADD CONSTRAINT "CK_APPLN_CHILD_ID_SGND_FLAG" CHECK (	CHILD_ID_SIGNED_FLAG In ('0','1') ) ENABLE;
  ALTER TABLE "APPLICATION_TEMP" ADD CONSTRAINT "CK_APPLN_APP_SIGNED_FLAG" CHECK (	APP_SIGNED_FLAG	 In ('0','1') ) ENABLE;
  ALTER TABLE "APPLICATION_TEMP" ADD SUPPLEMENTAL LOG DATA (FOREIGN KEY) COLUMNS;
  ALTER TABLE "APPLICATION_TEMP" ADD SUPPLEMENTAL LOG DATA (UNIQUE INDEX) COLUMNS;
  ALTER TABLE "APPLICATION_TEMP" ADD SUPPLEMENTAL LOG DATA (PRIMARY KEY) COLUMNS;
  ALTER TABLE "APPLICATION_TEMP" ADD SUPPLEMENTAL LOG DATA (ALL) COLUMNS;
/
--------------------------------------------------------
--  DDL for Trigger APPLICATION_TEMP_DATE_TRG
--------------------------------------------------------

  CREATE OR REPLACE TRIGGER "APPLICATION_TEMP_DATE_TRG" 
BEFORE UPDATE ON APPLICATION_TEMP
REFERENCING OLD AS OLD NEW AS NEW
FOR EACH ROW
BEGIN
 :NEW.update_date := sysdate;
 :NEW.last_update_user:= SUBSTR(coalesce(sys_context('USERENV','CLIENT_IDENTIFIER'),user),1,100);
 :NEW.last_update_job_name:= SUBSTR(sys_context('VIDAENV','JOB_NAME'),1,100);
 :NEW.update_user_role:= SUBSTR(sys_context('VIDAENV','USER_ROLE'),1,100);

EXCEPTION WHEN
OTHERS THEN RAISE_APPLICATION_TEMP_ERROR(-20002,'An error has occurred in the UPDATE trigger firing');
END;
/
ALTER TRIGGER "APPLICATION_TEMP_DATE_TRG" ENABLE;
/
