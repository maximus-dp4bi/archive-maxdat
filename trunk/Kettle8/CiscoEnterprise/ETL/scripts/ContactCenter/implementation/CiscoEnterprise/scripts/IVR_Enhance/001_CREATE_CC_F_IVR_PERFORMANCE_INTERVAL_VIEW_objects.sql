CREATE OR REPLACE VIEW CC_F_IVR_PERFORMANCE_INTERVAL_SV AS 
SELECT 
/*+ PARALLEL(10) */
--F_IVR_PERFORMANCE_INTERVAL_ID   
D_DATE_ID          
,D_INTERVAL_ID      
,D_PROJECT_ID       
,D_PROGRAM_ID       
,IVR_SOURCE         
,IVR_APPLICATION_NAME     
,D_IVR_LANG_ID  
, INBOUND_DNIS          
, INBOUND_DNIS_TYPE    
, UNIT_OF_WORK             
, IVR_EXIT_RESULT
, IVR_EXIT_RESULT_DETAIL
, MAIN_MENU_SELECTION
, SELF_SERVICE_DESCRIPTION
, DESTINATION_TRANSFER
, AGENT_ROUTING_GROUP_NAME
, AGENT_ROUTING_GROUP_ID
, IVR_EXIT_POINT 
, IVR_EXIT_CAUSE 
, QUEUE_NAME      
, QUEUE_NUMBER     
,COUNT(1)                         CALLS_RECEIVED_IN_IVR        
,SUM(CALL_ROUTED_TO_AGENT)       CALLS_ROUTED_TO_AGENT       
,SUM(CALL_CONTAINED_IN_IVR)      ALLS_CONTAINED_IN_IVR     
,SUM(CALL_RECEIVED_AFTER_HOURS)  CALLS_RECEIVED_AFTER_HOURS 
,SUM(DURATION_IN_IVR)             TOTAL_DURATION_IN_IVR   
,CAST(ROUND(SUM(DURATION_IN_IVR)/COUNT(1),2) AS DECIMAL(10,2))     AVG_DURATION_IN_IVR      
,MIN(DURATION_IN_IVR)                        MIN_DURATION_IN_IVR          
,MAX(DURATION_IN_IVR)                        MAX_DURATION_IN_IVR          
FROM
CC_F_IVR_PERFORMANCE_INSTANCE_SV IR 
GROUP BY 
D_DATE_ID          
,D_INTERVAL_ID      
,D_PROJECT_ID       
,D_PROGRAM_ID       
,IVR_SOURCE         
,IVR_APPLICATION_NAME     
,D_IVR_LANG_ID  
, INBOUND_DNIS          
, INBOUND_DNIS_TYPE    
, UNIT_OF_WORK             
, IVR_EXIT_RESULT
, IVR_EXIT_RESULT_DETAIL
, MAIN_MENU_SELECTION
, SELF_SERVICE_DESCRIPTION
, DESTINATION_TRANSFER
, AGENT_ROUTING_GROUP_NAME
, AGENT_ROUTING_GROUP_ID
, IVR_EXIT_POINT 
, IVR_EXIT_CAUSE 
, QUEUE_NAME      
, QUEUE_NUMBER    
;

--select * from CC_F_IVR_PERFORMANCE_INTERVAL_SV

GRANT SELECT ON CC_F_IVR_PERFORMANCE_INTERVAL_SV TO CISCO_READ_ONLY;
GRANT SELECT ON CC_F_IVR_PERFORMANCE_INTERVAL_SV TO MAXDAT_READ_ONLY;


