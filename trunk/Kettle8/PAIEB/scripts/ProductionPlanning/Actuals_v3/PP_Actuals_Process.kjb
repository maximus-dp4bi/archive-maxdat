<?xml version="1.0" encoding="UTF-8"?>
<job>
  <name>PP_Actuals_Process</name>
  <description/>
    <extended_description>
----------------------------------------------------------------
Do not edit these four SVN_* variable values.  They are populated when you commit code to SVN and used later to identify deployed code.
----------------------------------------------------------------

---------------------------------
SVN_FILE_URL        = $URL$ 
SVN_REVISION        = $Revision$ 
SVN_REVISION_DATE   = $Date$
SVN_REVISION_AUTHOR = $Author$
---------------------------------

</extended_description>
  <job_version/>
  <directory>/</directory>
  <created_user>-</created_user>
  <created_date>2013/07/30 01:04:45.392</created_date>
  <modified_user>-</modified_user>
  <modified_date>2013/07/30 01:04:45.392</modified_date>
  <parameters>
    </parameters>
  <connection>
    <name>EMRS</name>
    <server>${DB_EMRS_HOSTNAME}</server>
    <type>ORACLE</type>
    <access>Native</access>
    <database>${DB_EMRS_NAME}</database>
    <port>${DB_EMRS_PORT}</port>
    <username>${DB_EMRS_USER}</username>
    <password>${DB_EMRS_PASSWORD}</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>${DB_EMRS_PORT}</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>MAXDAT</name>
    <server>${DB_MAXDAT_HOSTNAME}</server>
    <type>ORACLE</type>
    <access>Native</access>
    <database>${DB_MAXDAT_NAME}</database>
    <port>${DB_MAXDAT_PORT}</port>
    <username>${DB_MAXDAT_USER}</username>
    <password>${DB_MAXDAT_PASSWORD}</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>INITIAL_POOL_SIZE</code>
        <attribute>20</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MAXIMUM_POOL_SIZE</code>
        <attribute>100</attribute>
      </attribute>
      <attribute>
        <code>POOLING_initialSize</code>
        <attribute>20</attribute>
      </attribute>
      <attribute>
        <code>POOLING_logAbandoned</code>
        <attribute>false</attribute>
      </attribute>
      <attribute>
        <code>POOLING_maxActive</code>
        <attribute>100</attribute>
      </attribute>
      <attribute>
        <code>POOLING_testOnBorrow</code>
        <attribute>true</attribute>
      </attribute>
      <attribute>
        <code>POOLING_validationQuery</code>
        <attribute>select 1 from dual</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>${DB_MAXDAT_PORT}</attribute>
      </attribute>
      <attribute>
        <code>PREFERRED_SCHEMA_NAME</code>
        <attribute>${DB_MAXDAT_SCHEMA}</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SQL_CONNECT</code>
        <attribute>ALTER SESSION SET CURRENT_SCHEMA = CISCO_ENTERPRISE_CC;</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>Y</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>MAXDATHCO</name>
    <server>${DB_MAXDATHCO_HOSTNAME}</server>
    <type>ORACLE</type>
    <access>Native</access>
    <database>${DB_MAXDATHCO_NAME}</database>
    <port>${DB_MAXDATHCO_PORT}</port>
    <username>${DB_MAXDATHCO_USER}</username>
    <password>${DB_MAXDATHCO_PASSWORD}</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>INITIAL_POOL_SIZE</code>
        <attribute>20</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MAXIMUM_POOL_SIZE</code>
        <attribute>100</attribute>
      </attribute>
      <attribute>
        <code>POOLING_initialSize</code>
        <attribute>20</attribute>
      </attribute>
      <attribute>
        <code>POOLING_logAbandoned</code>
        <attribute>false</attribute>
      </attribute>
      <attribute>
        <code>POOLING_maxActive</code>
        <attribute>100</attribute>
      </attribute>
      <attribute>
        <code>POOLING_testOnBorrow</code>
        <attribute>true</attribute>
      </attribute>
      <attribute>
        <code>POOLING_validationQuery</code>
        <attribute>select 1 from dual</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>${DB_MAXDATHCO_PORT}</attribute>
      </attribute>
      <attribute>
        <code>PREFERRED_SCHEMA_NAME</code>
        <attribute>${DB_MAXDATHCO_SCHEMA}</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SQL_CONNECT</code>
        <attribute>ALTER SESSION SET CURRENT_SCHEMA = MAXDAT;</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>Y</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>MOTS</name>
    <server>${DB_MOTS_HOSTNAME}</server>
    <type>ORACLE</type>
    <access>Native</access>
    <database>${DB_MOTS_DATABASENAME}</database>
    <port>${DB_MOTS_PORT}</port>
    <username>${DB_MOTS_USER}</username>
    <password>${DB_MOTS_PASSWORD}</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>${DB_MOTS_PORT}</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>NYECDMS</name>
    <server>${DB_DMS_HOSTNAME}</server>
    <type>ORACLE</type>
    <access>Native</access>
    <database>${DB_DMS_NAME}</database>
    <port>${DB_DMS_PORT}</port>
    <username>${DB_DMS_USER}</username>
    <password>${DB_DMS_PASSWORD}</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>INITIAL_POOL_SIZE</code>
        <attribute>5</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MAXIMUM_POOL_SIZE</code>
        <attribute>10</attribute>
      </attribute>
      <attribute>
        <code>POOLING_initialSize</code>
        <attribute>${INIT_POOL_SIZE}</attribute>
      </attribute>
      <attribute>
        <code>POOLING_logAbandoned</code>
        <attribute>false</attribute>
      </attribute>
      <attribute>
        <code>POOLING_maxActive</code>
        <attribute>${MAX_POOL_SIZE}</attribute>
      </attribute>
      <attribute>
        <code>POOLING_testOnBorrow</code>
        <attribute>true</attribute>
      </attribute>
      <attribute>
        <code>POOLING_validationQuery</code>
        <attribute>select 1 from dual</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>${DB_DMS_PORT}</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>Y</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>OLTP_SOURCE</name>
    <server>${DB_OLTP_HOSTNAME}</server>
    <type>ORACLE</type>
    <access>Native</access>
    <database>${DB_OLTP_NAME}</database>
    <port>${DB_OLTP_PORT}</port>
    <username>${DB_OLTP_USER}</username>
    <password>${DB_OLTP_PASSWORD}</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>${DB_OLTP_PORT}</attribute>
      </attribute>
      <attribute>
        <code>PREFERRED_SCHEMA_NAME</code>
        <attribute>$DB_OLTP_SCHEMA</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <slaveservers>
    </slaveservers>
  <job-log-table>
    <connection/>
    <schema/>
    <table/>
    <size_limit_lines/>
    <interval/>
    <timeout_days/>
    <field>
      <id>ID_JOB</id>
      <enabled>Y</enabled>
      <name>ID_JOB</name>
    </field>
    <field>
      <id>CHANNEL_ID</id>
      <enabled>Y</enabled>
      <name>CHANNEL_ID</name>
    </field>
    <field>
      <id>JOBNAME</id>
      <enabled>Y</enabled>
      <name>JOBNAME</name>
    </field>
    <field>
      <id>STATUS</id>
      <enabled>Y</enabled>
      <name>STATUS</name>
    </field>
    <field>
      <id>LINES_READ</id>
      <enabled>Y</enabled>
      <name>LINES_READ</name>
    </field>
    <field>
      <id>LINES_WRITTEN</id>
      <enabled>Y</enabled>
      <name>LINES_WRITTEN</name>
    </field>
    <field>
      <id>LINES_UPDATED</id>
      <enabled>Y</enabled>
      <name>LINES_UPDATED</name>
    </field>
    <field>
      <id>LINES_INPUT</id>
      <enabled>Y</enabled>
      <name>LINES_INPUT</name>
    </field>
    <field>
      <id>LINES_OUTPUT</id>
      <enabled>Y</enabled>
      <name>LINES_OUTPUT</name>
    </field>
    <field>
      <id>LINES_REJECTED</id>
      <enabled>Y</enabled>
      <name>LINES_REJECTED</name>
    </field>
    <field>
      <id>ERRORS</id>
      <enabled>Y</enabled>
      <name>ERRORS</name>
    </field>
    <field>
      <id>STARTDATE</id>
      <enabled>Y</enabled>
      <name>STARTDATE</name>
    </field>
    <field>
      <id>ENDDATE</id>
      <enabled>Y</enabled>
      <name>ENDDATE</name>
    </field>
    <field>
      <id>LOGDATE</id>
      <enabled>Y</enabled>
      <name>LOGDATE</name>
    </field>
    <field>
      <id>DEPDATE</id>
      <enabled>Y</enabled>
      <name>DEPDATE</name>
    </field>
    <field>
      <id>REPLAYDATE</id>
      <enabled>Y</enabled>
      <name>REPLAYDATE</name>
    </field>
    <field>
      <id>LOG_FIELD</id>
      <enabled>Y</enabled>
      <name>LOG_FIELD</name>
    </field>
    <field>
      <id>EXECUTING_SERVER</id>
      <enabled>N</enabled>
      <name>EXECUTING_SERVER</name>
    </field>
    <field>
      <id>EXECUTING_USER</id>
      <enabled>N</enabled>
      <name>EXECUTING_USER</name>
    </field>
    <field>
      <id>START_JOB_ENTRY</id>
      <enabled>N</enabled>
      <name>START_JOB_ENTRY</name>
    </field>
    <field>
      <id>CLIENT</id>
      <enabled>N</enabled>
      <name>CLIENT</name>
    </field>
  </job-log-table>
  <jobentry-log-table>
    <connection/>
    <schema/>
    <table/>
    <timeout_days/>
    <field>
      <id>ID_BATCH</id>
      <enabled>Y</enabled>
      <name>ID_BATCH</name>
    </field>
    <field>
      <id>CHANNEL_ID</id>
      <enabled>Y</enabled>
      <name>CHANNEL_ID</name>
    </field>
    <field>
      <id>LOG_DATE</id>
      <enabled>Y</enabled>
      <name>LOG_DATE</name>
    </field>
    <field>
      <id>JOBNAME</id>
      <enabled>Y</enabled>
      <name>TRANSNAME</name>
    </field>
    <field>
      <id>JOBENTRYNAME</id>
      <enabled>Y</enabled>
      <name>STEPNAME</name>
    </field>
    <field>
      <id>LINES_READ</id>
      <enabled>Y</enabled>
      <name>LINES_READ</name>
    </field>
    <field>
      <id>LINES_WRITTEN</id>
      <enabled>Y</enabled>
      <name>LINES_WRITTEN</name>
    </field>
    <field>
      <id>LINES_UPDATED</id>
      <enabled>Y</enabled>
      <name>LINES_UPDATED</name>
    </field>
    <field>
      <id>LINES_INPUT</id>
      <enabled>Y</enabled>
      <name>LINES_INPUT</name>
    </field>
    <field>
      <id>LINES_OUTPUT</id>
      <enabled>Y</enabled>
      <name>LINES_OUTPUT</name>
    </field>
    <field>
      <id>LINES_REJECTED</id>
      <enabled>Y</enabled>
      <name>LINES_REJECTED</name>
    </field>
    <field>
      <id>ERRORS</id>
      <enabled>Y</enabled>
      <name>ERRORS</name>
    </field>
    <field>
      <id>RESULT</id>
      <enabled>Y</enabled>
      <name>RESULT</name>
    </field>
    <field>
      <id>NR_RESULT_ROWS</id>
      <enabled>Y</enabled>
      <name>NR_RESULT_ROWS</name>
    </field>
    <field>
      <id>NR_RESULT_FILES</id>
      <enabled>Y</enabled>
      <name>NR_RESULT_FILES</name>
    </field>
    <field>
      <id>LOG_FIELD</id>
      <enabled>N</enabled>
      <name>LOG_FIELD</name>
    </field>
    <field>
      <id>COPY_NR</id>
      <enabled>N</enabled>
      <name>COPY_NR</name>
    </field>
  </jobentry-log-table>
  <channel-log-table>
    <connection/>
    <schema/>
    <table/>
    <timeout_days/>
    <field>
      <id>ID_BATCH</id>
      <enabled>Y</enabled>
      <name>ID_BATCH</name>
    </field>
    <field>
      <id>CHANNEL_ID</id>
      <enabled>Y</enabled>
      <name>CHANNEL_ID</name>
    </field>
    <field>
      <id>LOG_DATE</id>
      <enabled>Y</enabled>
      <name>LOG_DATE</name>
    </field>
    <field>
      <id>LOGGING_OBJECT_TYPE</id>
      <enabled>Y</enabled>
      <name>LOGGING_OBJECT_TYPE</name>
    </field>
    <field>
      <id>OBJECT_NAME</id>
      <enabled>Y</enabled>
      <name>OBJECT_NAME</name>
    </field>
    <field>
      <id>OBJECT_COPY</id>
      <enabled>Y</enabled>
      <name>OBJECT_COPY</name>
    </field>
    <field>
      <id>REPOSITORY_DIRECTORY</id>
      <enabled>Y</enabled>
      <name>REPOSITORY_DIRECTORY</name>
    </field>
    <field>
      <id>FILENAME</id>
      <enabled>Y</enabled>
      <name>FILENAME</name>
    </field>
    <field>
      <id>OBJECT_ID</id>
      <enabled>Y</enabled>
      <name>OBJECT_ID</name>
    </field>
    <field>
      <id>OBJECT_REVISION</id>
      <enabled>Y</enabled>
      <name>OBJECT_REVISION</name>
    </field>
    <field>
      <id>PARENT_CHANNEL_ID</id>
      <enabled>Y</enabled>
      <name>PARENT_CHANNEL_ID</name>
    </field>
    <field>
      <id>ROOT_CHANNEL_ID</id>
      <enabled>Y</enabled>
      <name>ROOT_CHANNEL_ID</name>
    </field>
  </channel-log-table>
  <pass_batchid>N</pass_batchid>
  <shared_objects_file/>
  <entries>
    <entry>
      <name>Check Db connections</name>
      <description/>
      <type>CHECK_DB_CONNECTIONS</type>
      <attributes/>
      <connections>
        <connection>
          <name>MAXDAT</name>
          <waitfor>0</waitfor>
          <waittime>millisecond</waittime>
        </connection>
      </connections>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>694</xloc>
      <yloc>58</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>Write Log</name>
      <description/>
      <type>TRANS</type>
      <attributes/>
      <specification_method>filename</specification_method>
      <trans_object_id/>
      <filename>${Internal.Job.Filename.Directory}/tr_pps_write_to_db_log.ktr</filename>
      <transname/>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <clear_rows>N</clear_rows>
      <clear_files>N</clear_files>
      <set_logfile>N</set_logfile>
      <logfile/>
      <logext/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <loglevel>Basic</loglevel>
      <cluster>N</cluster>
      <slave_server_name/>
      <set_append_logfile>N</set_append_logfile>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <create_parent_folder>N</create_parent_folder>
      <logging_remote_work>N</logging_remote_work>
      <run_configuration/>
      <parameters>
        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>1766</xloc>
      <yloc>57</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>Set Log Vars</name>
      <description/>
      <type>SET_VARIABLES</type>
      <attributes/>
      <replacevars>Y</replacevars>
      <filename/>
      <file_variable_type>JVM</file_variable_type>
      <fields>
        <field>
          <variable_name>V_LOG_TYPE</variable_name>
          <variable_value>ERR</variable_value>
          <variable_type>JVM</variable_type>
        </field>
        <field>
          <variable_name>V_LOG_PROCESS</variable_name>
          <variable_value>PP_Actuals_Process_v3</variable_value>
          <variable_type>JVM</variable_type>
        </field>
        <field>
          <variable_name>V_LOG_DESCRIPTION</variable_name>
          <variable_value>DB is not available. Aborting process! DB: ${DB_MAXDAT_NAME}</variable_value>
          <variable_type>JVM</variable_type>
        </field>
      </fields>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>1220</xloc>
      <yloc>60</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>START</name>
      <description/>
      <type>SPECIAL</type>
      <attributes/>
      <start>Y</start>
      <dummy>N</dummy>
      <repeat>N</repeat>
      <schedulerType>0</schedulerType>
      <intervalSeconds>0</intervalSeconds>
      <intervalMinutes>60</intervalMinutes>
      <hour>12</hour>
      <minutes>0</minutes>
      <weekDay>1</weekDay>
      <DayOfMonth>1</DayOfMonth>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>415</xloc>
      <yloc>59</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>Abort job 2</name>
      <description/>
      <type>ABORT</type>
      <attributes/>
      <message/>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>1768</xloc>
      <yloc>932</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>Write Log 14</name>
      <description/>
      <type>TRANS</type>
      <attributes/>
      <specification_method>filename</specification_method>
      <trans_object_id/>
      <filename>${Internal.Job.Filename.Directory}/tr_pps_write_to_db_log.ktr</filename>
      <transname/>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <clear_rows>N</clear_rows>
      <clear_files>N</clear_files>
      <set_logfile>N</set_logfile>
      <logfile/>
      <logext/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <loglevel>Basic</loglevel>
      <cluster>N</cluster>
      <slave_server_name/>
      <set_append_logfile>N</set_append_logfile>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <create_parent_folder>N</create_parent_folder>
      <logging_remote_work>N</logging_remote_work>
      <run_configuration/>
      <parameters>
        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>694</xloc>
      <yloc>304</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>Set Log Vars 23</name>
      <description/>
      <type>SET_VARIABLES</type>
      <attributes/>
      <replacevars>Y</replacevars>
      <filename/>
      <file_variable_type>JVM</file_variable_type>
      <fields>
        <field>
          <variable_name>V_LOG_TYPE</variable_name>
          <variable_value>LOG</variable_value>
          <variable_type>JVM</variable_type>
        </field>
        <field>
          <variable_name>V_LOG_PROCESS</variable_name>
          <variable_value>PP_Actuals_Process_v3</variable_value>
          <variable_type>JVM</variable_type>
        </field>
        <field>
          <variable_name>V_LOG_DESCRIPTION</variable_name>
          <variable_value>PP_Actuals_Process STARTED</variable_value>
          <variable_type>JVM</variable_type>
        </field>
      </fields>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>694</xloc>
      <yloc>211</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>MW Arrivals</name>
      <description/>
      <type>SQL</type>
      <attributes/>
      <sql>DECLARE
V_ERRCODE varchar2(50);
V_ERRMSG varchar2(3000);

BEGIN
  FOR RECS IN 
    (
      SELECT X.CREATE_DATE, X.CREATE_HOUR, X.CFG_UOW_ID, X.PROJECT_ID, X.PROGRAM_ID, X.GEOGRAPHY_MASTER_ID,X.CREATION_COUNT, 
        (SELECT ACTUALS_ID FROM PP_F_ACTUALS WHERE D_DATE=X.CREATE_DATE AND D_HOUR=X.CREATE_HOUR AND UOW_ID=X.CFG_UOW_ID AND PROJECT_ID=X.PROJECT_ID AND PROGRAM_ID=X.PROGRAM_ID AND GEOGRAPHY_MASTER_ID=X.GEOGRAPHY_MASTER_ID) AS ACTUALS_ID 
        FROM
        (
        SELECT ARRIVAL.CREATE_DATE,
                              0 AS CREATE_HOUR,
                              ARRIVAL.CFG_UOW_ID,
                              ARRIVAL.CREATION_COUNT,
                              (SELECT CFG_PROJECT_CONFIG_ID
                                 FROM PP_CFG_PROJECT_CONFIG) AS PROJECT_ID,
                              (SELECT CFG_PROGRAM_CONFIG_ID
                                 FROM PP_CFG_PROGRAM_CONFIG) AS PROGRAM_ID,
                              (SELECT CFG_GEOGRAPHY_CONFIG_ID
                                 FROM PP_CFG_GEOGRAPHY_CONFIG) AS GEOGRAPHY_MASTER_ID
                         FROM (SELECT TRUNC(CREATE_DATE) AS CREATE_DATE,
                                      UOW.CFG_UOW_ID,
                                      COUNT(1) AS CREATION_COUNT
                                 FROM PP_CFG_UNIT_OF_WORK UOW
                                INNER JOIN PP_D_UOW_SOURCE_REF USR
                                   ON UOW.CFG_UOW_ID = USR.UOW_ID
                                  AND SYSDATE BETWEEN USR.EFFECTIVE_DATE AND
                                      USR.END_DATE
                                INNER JOIN PP_D_SOURCE_REF_TYPE SRT
                                   ON USR.SOURCE_REF_TYPE_ID = SRT.SOURCE_REF_TYPE_ID
                                  AND SRT.SOURCE_REF_TYPE_NAME = 'TASK TYPE'
                                INNER JOIN PP_D_SOURCE S
                                   ON SRT.SOURCE_ID = S.SOURCE_ID
                                  AND S.SOURCE_NAME = 'MANAGE WORK STG'
                                INNER JOIN D_MW_TASK_INSTANCE_SV MW
                                   ON USR.SOURCE_REF_ID = MW.TASK_TYPE_ID 
                                WHERE MW.CREATE_DATE >= TRUNC(SYSDATE - 730) 
                                  AND UOW.HOURLY_FLAG = 'N'
                                GROUP BY TRUNC(MW.CREATE_DATE), UOW.CFG_UOW_ID) ARRIVAL
                       UNION ALL
                       SELECT ARRIVAL.CREATE_DATE,
                              TO_NUMBER(ARRIVAL.CREATE_HOUR),
                              ARRIVAL.CFG_UOW_ID,
                              ARRIVAL.CREATION_COUNT,
                              (SELECT CFG_PROJECT_CONFIG_ID
                                 FROM PP_CFG_PROJECT_CONFIG) AS PROJECT_ID,
                              (SELECT CFG_PROGRAM_CONFIG_ID
                                 FROM PP_CFG_PROGRAM_CONFIG) AS PROGRAM_ID,
                              (SELECT CFG_GEOGRAPHY_CONFIG_ID
                                 FROM PP_CFG_GEOGRAPHY_CONFIG) AS GEOGRAPHY_MASTER_ID
                         FROM (SELECT TRUNC(CREATE_DATE) AS CREATE_DATE,
                                      TO_CHAR(CREATE_DATE, 'HH24') AS CREATE_HOUR,
                                      UOW.CFG_UOW_ID,
                                      COUNT(1) AS CREATION_COUNT
                                 FROM PP_CFG_UNIT_OF_WORK UOW
                                INNER JOIN PP_D_UOW_SOURCE_REF USR
                                   ON UOW.CFG_UOW_ID = USR.UOW_ID
                                  AND SYSDATE BETWEEN USR.EFFECTIVE_DATE AND
                                      USR.END_DATE
                                INNER JOIN PP_D_SOURCE_REF_TYPE SRT
                                   ON USR.SOURCE_REF_TYPE_ID = SRT.SOURCE_REF_TYPE_ID
                                  AND SRT.SOURCE_REF_TYPE_NAME = 'TASK TYPE'
                                INNER JOIN PP_D_SOURCE S
                                   ON SRT.SOURCE_ID = S.SOURCE_ID
                                  AND S.SOURCE_NAME = 'MANAGE WORK STG'
                                INNER JOIN D_MW_TASK_INSTANCE_SV MW
                                   ON USR.SOURCE_REF_ID = MW.TASK_TYPE_ID 
                                WHERE MW.CREATE_DATE >= TRUNC(SYSDATE - 730)
                                  AND UOW.HOURLY_FLAG = 'Y'
                                GROUP BY TRUNC(MW.CREATE_DATE),
                                         TO_CHAR(MW.CREATE_DATE, 'HH24'),
                                         UOW.CFG_UOW_ID) ARRIVAL
        ) X
    ) 
    LOOP
        CASE
            WHEN (RECS.ACTUALS_ID >=0) THEN 
              UPDATE PP_F_ACTUALS
                 SET ACTL_ARRIVAL = RECS.CREATION_COUNT
               WHERE ACTUALS_ID=RECS.ACTUALS_ID;
            ELSE 
              INSERT INTO PP_F_ACTUALS
                (ACTUALS_ID,
                 D_DATE,
                 D_HOUR,
                 UOW_ID,
                 PROJECT_ID,
                 PROGRAM_ID,
                 GEOGRAPHY_MASTER_ID,
                 ACTL_ARRIVAL)
              VALUES
                (SEQ_PP_F_ACTUALS_ID.NEXTVAL,
                 RECS.CREATE_DATE,
                 RECS.CREATE_HOUR,
                 RECS.CFG_UOW_ID,
                 RECS.PROJECT_ID,
                 RECS.PROGRAM_ID,
                 RECS.GEOGRAPHY_MASTER_ID,
                 RECS.CREATION_COUNT);
          END CASE;
  END LOOP;
  INSERT INTO PP_STG_LOG
      (PP_STG_ID, LOG_TYPE, PROCESS_DATE, PROCESS, DESCRIPTION, CREATE_DATE)
      VALUES (SEQ_PP_STG_ID.NEXTVAL,'LOG',SYSDATE,'PP_Actuals_Process_v3','MW Arrivals - Processed', SYSDATE); 
  COMMIT;


EXCEPTION
WHEN OTHERS 
  THEN 
    ROLLBACK;
    V_ERRCODE := SQLCODE;
    V_ERRMSG := SUBSTR(SQLERRM, 1, 3000);                 
    INSERT INTO PP_STG_LOG
      (PP_STG_ID, LOG_TYPE, PROCESS_DATE, PROCESS, DESCRIPTION, CREATE_DATE)
      VALUES (SEQ_PP_STG_ID.NEXTVAL,'ERR',SYSDATE,'PP_Actuals_Process_v3','MW Arrivals - ' || V_ERRCODE || ' : ' || V_ERRMSG,SYSDATE); 
      COMMIT; 
    RAISE;
END;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>T</sendOneStatement>
      <connection>MAXDAT</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>694</xloc>
      <yloc>421</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>MW Inventory Avg Age</name>
      <description/>
      <type>SQL</type>
      <attributes/>
      <sql>DECLARE
V_ERRCODE varchar2(50);
V_ERRMSG varchar2(3000);

BEGIN
  FOR RECS IN 
    (
      SELECT X.INVENTORY_DATE,
       X.INVENTORY_HOUR,
       X.CFG_UOW_ID,
       X.PROJECT_ID,
       X.PROGRAM_ID,
       X.GEOGRAPHY_MASTER_ID,
       X.AVG_AGE,
       (SELECT ACTUALS_ID
          FROM PP_F_ACTUALS
         WHERE D_DATE = X.INVENTORY_DATE
           AND D_HOUR = X.INVENTORY_HOUR
           AND UOW_ID = X.CFG_UOW_ID
           AND PROJECT_ID = X.PROJECT_ID
           AND PROGRAM_ID = X.PROGRAM_ID
           AND GEOGRAPHY_MASTER_ID = X.GEOGRAPHY_MASTER_ID) AS ACTUALS_ID
  FROM 
  (
      SELECT TRUNC(SYSDATE) AS INVENTORY_DATE,
           '0' AS INVENTORY_HOUR,
           UOW.CFG_UOW_ID,
           AVG(CASE
                 WHEN UOW.AGE_DAYS_TYPE = 'BUS' THEN
                  (CASE
                    WHEN BUS_DAYS_BETWEEN(TRUNC(CREATE_DATE), TRUNC(SYSDATE)) >=
                         UOW.INV_AVG_AGE THEN
                     UOW.INV_AVG_AGE
                    ELSE
                     BUS_DAYS_BETWEEN(TRUNC(CREATE_DATE), TRUNC(SYSDATE))
                  END)
                 ELSE
                  (CASE
                    WHEN (SELECT TRUNC(SYSDATE) - TRUNC(CREATE_DATE) AS AGE FROM DUAL) >=
                         UOW.INV_AVG_AGE THEN
                     UOW.INV_AVG_AGE
                    ELSE
                     (SELECT TRUNC(SYSDATE) - TRUNC(CREATE_DATE) AS AGE FROM DUAL)
                  END)
               END) as AVG_AGE,
           (SELECT CFG_PROJECT_CONFIG_ID FROM PP_CFG_PROJECT_CONFIG) AS PROJECT_ID,
           (SELECT CFG_PROGRAM_CONFIG_ID FROM PP_CFG_PROGRAM_CONFIG) AS PROGRAM_ID,
           (SELECT CFG_GEOGRAPHY_CONFIG_ID FROM PP_CFG_GEOGRAPHY_CONFIG) AS GEOGRAPHY_MASTER_ID
      FROM PP_CFG_UNIT_OF_WORK UOW
      INNER JOIN PP_D_UOW_SOURCE_REF USR
        ON UOW.CFG_UOW_ID = USR.UOW_ID
       AND SYSDATE BETWEEN USR.EFFECTIVE_DATE AND USR.END_DATE
      INNER JOIN PP_D_SOURCE_REF_TYPE SRT
        ON USR.SOURCE_REF_TYPE_ID = SRT.SOURCE_REF_TYPE_ID
       AND SRT.SOURCE_REF_TYPE_NAME = 'TASK TYPE'
      INNER JOIN PP_D_SOURCE S
        ON SRT.SOURCE_ID = S.SOURCE_ID
       AND S.SOURCE_NAME = 'MANAGE WORK STG'
      INNER JOIN D_MW_TASK_INSTANCE_SV MW
        ON USR.SOURCE_REF_ID = MW.TASK_TYPE_ID 
      WHERE 
        COMPLETE_DATE IS NULL
       AND UOW.HOURLY_FLAG = 'N'
       AND CANCEL_WORK_DATE IS NULL
      GROUP BY TRUNC(SYSDATE), UOW.CFG_UOW_ID
      UNION ALL
      SELECT TRUNC(SYSDATE) AS INVENTORY_DATE,
           TO_CHAR(SYSDATE, 'HH24') AS INVENTORY_HOUR,
           UOW.CFG_UOW_ID,
           AVG(CASE
                 WHEN UOW.AGE_DAYS_TYPE = 'BUS' THEN
                  (CASE
                    WHEN BUS_DAYS_BETWEEN(TRUNC(CREATE_DATE), TRUNC(SYSDATE)) >=
                         UOW.INV_AVG_AGE THEN
                     UOW.INV_AVG_AGE
                    ELSE
                     BUS_DAYS_BETWEEN(TRUNC(CREATE_DATE), TRUNC(SYSDATE))
                  END)
                 ELSE
                  (CASE
                    WHEN (SELECT TRUNC(SYSDATE) - TRUNC(CREATE_DATE) AS AGE FROM DUAL) >=
                         UOW.INV_AVG_AGE THEN
                     UOW.INV_AVG_AGE
                    ELSE
                     (SELECT TRUNC(SYSDATE) - TRUNC(CREATE_DATE) AS AGE FROM DUAL)
                  END)
               END) as AVG_AGE,
           (SELECT CFG_PROJECT_CONFIG_ID FROM PP_CFG_PROJECT_CONFIG) AS PROJECT_ID,
           (SELECT CFG_PROGRAM_CONFIG_ID FROM PP_CFG_PROGRAM_CONFIG) AS PROGRAM_ID,
           (SELECT CFG_GEOGRAPHY_CONFIG_ID FROM PP_CFG_GEOGRAPHY_CONFIG) AS GEOGRAPHY_MASTER_ID
      FROM PP_CFG_UNIT_OF_WORK UOW
      INNER JOIN PP_D_UOW_SOURCE_REF USR
        ON UOW.CFG_UOW_ID = USR.UOW_ID
       AND SYSDATE BETWEEN USR.EFFECTIVE_DATE AND USR.END_DATE
      INNER JOIN PP_D_SOURCE_REF_TYPE SRT
        ON USR.SOURCE_REF_TYPE_ID = SRT.SOURCE_REF_TYPE_ID
       AND SRT.SOURCE_REF_TYPE_NAME = 'TASK TYPE'
      INNER JOIN PP_D_SOURCE S
        ON SRT.SOURCE_ID = S.SOURCE_ID
       AND S.SOURCE_NAME = 'MANAGE WORK STG'
      INNER JOIN D_MW_TASK_INSTANCE_SV MW
        ON USR.SOURCE_REF_ID = MW.TASK_TYPE_ID
      WHERE 
       COMPLETE_DATE IS NULL
       AND UOW.HOURLY_FLAG = 'Y'
       AND CANCEL_WORK_DATE IS NULL
      GROUP BY TRUNC(SYSDATE), TO_CHAR(SYSDATE, 'HH24'), UOW.CFG_UOW_ID           
      ) X
    ) 
    LOOP
        CASE
            WHEN (RECS.ACTUALS_ID >=0) THEN 
              UPDATE PP_F_ACTUALS
                 SET ACTL_INVENTORY_AGE_AVG=RECS.AVG_AGE
               WHERE ACTUALS_ID=RECS.ACTUALS_ID;
            ELSE 
              INSERT INTO PP_F_ACTUALS
                (ACTUALS_ID,
                 D_DATE,
                 D_HOUR,
                 UOW_ID,
                 PROJECT_ID,
                 PROGRAM_ID,
                 GEOGRAPHY_MASTER_ID,
                 ACTL_INVENTORY_AGE_AVG)
              VALUES
                (SEQ_PP_F_ACTUALS_ID.NEXTVAL,
                 RECS.INVENTORY_DATE,
                 RECS.INVENTORY_HOUR,
                 RECS.CFG_UOW_ID,
                 RECS.PROJECT_ID,
                 RECS.PROGRAM_ID,
                 RECS.GEOGRAPHY_MASTER_ID,
                 RECS.AVG_AGE);
          END CASE;
  END LOOP;
  INSERT INTO PP_STG_LOG
      (PP_STG_ID, LOG_TYPE, PROCESS_DATE, PROCESS, DESCRIPTION, CREATE_DATE)
      VALUES (SEQ_PP_STG_ID.NEXTVAL,'LOG',SYSDATE,'PP_Actuals_Process_v3','MW Inventory Avg Age - Processed', SYSDATE); 
  COMMIT;


EXCEPTION
WHEN OTHERS 
  THEN 
    ROLLBACK;
    V_ERRCODE := SQLCODE;
    V_ERRMSG := SUBSTR(SQLERRM, 1, 3000);                 
    INSERT INTO PP_STG_LOG
      (PP_STG_ID, LOG_TYPE, PROCESS_DATE, PROCESS, DESCRIPTION, CREATE_DATE)
      VALUES (SEQ_PP_STG_ID.NEXTVAL,'ERR',SYSDATE,'PP_Actuals_Process_v3','MW Inventory Avg Age - ' || V_ERRCODE || ' : ' || V_ERRMSG,SYSDATE); 
      COMMIT; 
	  RAISE;
END; </sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>T</sendOneStatement>
      <connection>MAXDAT</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>694</xloc>
      <yloc>1105</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>MW Completions</name>
      <description/>
      <type>SQL</type>
      <attributes/>
      <sql>DECLARE
V_ERRCODE varchar2(50);
V_ERRMSG varchar2(3000);

BEGIN
  FOR RECS IN 
    (
      SELECT X.COMPLETE_DATE, X.COMPLETE_HOUR, X.CFG_UOW_ID, X.PROJECT_ID, X.PROGRAM_ID, X.GEOGRAPHY_MASTER_ID,X.COMPLETION_COUNT, 
        (SELECT ACTUALS_ID FROM PP_F_ACTUALS WHERE D_DATE=X.COMPLETE_DATE AND D_HOUR=X.COMPLETE_HOUR AND UOW_ID=X.CFG_UOW_ID AND PROJECT_ID=X.PROJECT_ID AND PROGRAM_ID=X.PROGRAM_ID AND GEOGRAPHY_MASTER_ID=X.GEOGRAPHY_MASTER_ID) AS ACTUALS_ID 
        FROM
        (
        SELECT COMPLETIONS.COMPLETE_DATE,
                              0 AS COMPLETE_HOUR,
                              COMPLETIONS.CFG_UOW_ID,
                              COMPLETIONS.COMPLETION_COUNT,
                              (SELECT CFG_PROJECT_CONFIG_ID
                                 FROM PP_CFG_PROJECT_CONFIG) AS PROJECT_ID,
                              (SELECT CFG_PROGRAM_CONFIG_ID
                                 FROM PP_CFG_PROGRAM_CONFIG) AS PROGRAM_ID,
                              (SELECT CFG_GEOGRAPHY_CONFIG_ID
                                 FROM PP_CFG_GEOGRAPHY_CONFIG) AS GEOGRAPHY_MASTER_ID
                         FROM (SELECT TRUNC(MW.COMPLETE_DATE) AS COMPLETE_DATE,
                                      UOW.CFG_UOW_ID,
                                      COUNT(1) AS COMPLETION_COUNT
                                 FROM PP_CFG_UNIT_OF_WORK UOW
                                INNER JOIN PP_D_UOW_SOURCE_REF USR
                                   ON UOW.CFG_UOW_ID = USR.UOW_ID
                                  AND SYSDATE BETWEEN USR.EFFECTIVE_DATE AND
                                      USR.END_DATE
                                INNER JOIN PP_D_SOURCE_REF_TYPE SRT
                                   ON USR.SOURCE_REF_TYPE_ID = SRT.SOURCE_REF_TYPE_ID
                                  AND SRT.SOURCE_REF_TYPE_NAME = 'TASK TYPE'
                                INNER JOIN PP_D_SOURCE S
                                   ON SRT.SOURCE_ID = S.SOURCE_ID
                                  AND S.SOURCE_NAME = 'MANAGE WORK STG'
                                INNER JOIN D_MW_TASK_INSTANCE_SV MW
                                   ON USR.SOURCE_REF_ID = MW.TASK_TYPE_ID 
                                WHERE MW.COMPLETE_DATE >= TRUNC(SYSDATE - 730) 
                                  AND UOW.HOURLY_FLAG = 'N'
                                GROUP BY TRUNC(MW.COMPLETE_DATE), UOW.CFG_UOW_ID) COMPLETIONS
                       UNION ALL
                       SELECT COMPLETIONS.COMPLETE_DATE,
                              TO_NUMBER(COMPLETIONS.COMPLETE_HOUR) AS COMPLETE_HOUR,
                              COMPLETIONS.CFG_UOW_ID,
                              COMPLETIONS.COMPLETION_COUNT,
                              (SELECT CFG_PROJECT_CONFIG_ID
                                 FROM PP_CFG_PROJECT_CONFIG) AS PROJECT_ID,
                              (SELECT CFG_PROGRAM_CONFIG_ID
                                 FROM PP_CFG_PROGRAM_CONFIG) AS PROGRAM_ID,
                              (SELECT CFG_GEOGRAPHY_CONFIG_ID
                                 FROM PP_CFG_GEOGRAPHY_CONFIG) AS GEOGRAPHY_MASTER_ID
                         FROM (SELECT TRUNC(COMPLETE_DATE) AS COMPLETE_DATE,
                                      TO_CHAR(COMPLETE_DATE, 'HH24') AS COMPLETE_HOUR,
                                      UOW.CFG_UOW_ID,
                                      COUNT(1) AS COMPLETION_COUNT
                                 FROM PP_CFG_UNIT_OF_WORK UOW
                                INNER JOIN PP_D_UOW_SOURCE_REF USR
                                   ON UOW.CFG_UOW_ID = USR.UOW_ID
                                  AND SYSDATE BETWEEN USR.EFFECTIVE_DATE AND
                                      USR.END_DATE
                                INNER JOIN PP_D_SOURCE_REF_TYPE SRT
                                   ON USR.SOURCE_REF_TYPE_ID = SRT.SOURCE_REF_TYPE_ID
                                  AND SRT.SOURCE_REF_TYPE_NAME = 'TASK TYPE'
                                INNER JOIN PP_D_SOURCE S
                                   ON SRT.SOURCE_ID = S.SOURCE_ID
                                  AND S.SOURCE_NAME = 'MANAGE WORK STG'
                                INNER JOIN D_MW_TASK_INSTANCE_SV MW
                                   ON USR.SOURCE_REF_ID = MW.TASK_TYPE_ID 
                                WHERE MW.COMPLETE_DATE >= TRUNC(SYSDATE - 730) 
                                  AND UOW.HOURLY_FLAG = 'Y'
                                GROUP BY TRUNC(MW.COMPLETE_DATE),
                                         TO_CHAR(MW.COMPLETE_DATE, 'HH24'),
                                         UOW.CFG_UOW_ID) COMPLETIONS
        ) X
    ) 
    LOOP
        CASE
            WHEN (RECS.ACTUALS_ID >=0) THEN 
              UPDATE PP_F_ACTUALS
                 SET ACTL_COMPLETION = RECS.COMPLETION_COUNT
               WHERE ACTUALS_ID=RECS.ACTUALS_ID;
            ELSE 
              INSERT INTO PP_F_ACTUALS
                (ACTUALS_ID,
                 D_DATE,
                 D_HOUR,
                 UOW_ID,
                 PROJECT_ID,
                 PROGRAM_ID,
                 GEOGRAPHY_MASTER_ID,
                 ACTL_COMPLETION)
              VALUES
                (SEQ_PP_F_ACTUALS_ID.NEXTVAL,
                 RECS.COMPLETE_DATE,
                 RECS.COMPLETE_HOUR,
                 RECS.CFG_UOW_ID,
                 RECS.PROJECT_ID,
                 RECS.PROGRAM_ID,
                 RECS.GEOGRAPHY_MASTER_ID,
                 RECS.COMPLETION_COUNT);
          END CASE;
  END LOOP;
  INSERT INTO PP_STG_LOG
      (PP_STG_ID, LOG_TYPE, PROCESS_DATE, PROCESS, DESCRIPTION, CREATE_DATE)
      VALUES (SEQ_PP_STG_ID.NEXTVAL,'LOG',SYSDATE,'PP_Actuals_Process_v3','MW Completions - Processed', SYSDATE); 
  COMMIT;


EXCEPTION
WHEN OTHERS 
  THEN 
    ROLLBACK;
    V_ERRCODE := SQLCODE;
    V_ERRMSG := SUBSTR(SQLERRM, 1, 3000);                 
    INSERT INTO PP_STG_LOG
      (PP_STG_ID, LOG_TYPE, PROCESS_DATE, PROCESS, DESCRIPTION, CREATE_DATE)
      VALUES (SEQ_PP_STG_ID.NEXTVAL,'ERR',SYSDATE,'PP_Actuals_Process_v3','MW Completions - ' || V_ERRCODE || ' : ' || V_ERRMSG,SYSDATE); 
      COMMIT; 
    RAISE;
END;     </sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>T</sendOneStatement>
      <connection>MAXDAT</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>694</xloc>
      <yloc>567</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>MW Inventory Jeopardy</name>
      <description/>
      <type>SQL</type>
      <attributes/>
      <sql>DECLARE
V_ERRCODE varchar2(50);
V_ERRMSG varchar2(3000);

BEGIN
  FOR RECS IN 
    (
        SELECT X.INVENTORY_DATE,
               X.INVENTORY_HOUR,
               X.CFG_UOW_ID,
               X.PROJECT_ID,
               X.PROGRAM_ID,
               X.GEOGRAPHY_MASTER_ID,
               X.INVENTORY_COUNT,
               (SELECT ACTUALS_ID
                  FROM PP_F_ACTUALS
                 WHERE D_DATE = X.INVENTORY_DATE
                   AND D_HOUR = X.INVENTORY_HOUR
                   AND UOW_ID = X.CFG_UOW_ID
                   AND PROJECT_ID = X.PROJECT_ID
                   AND PROGRAM_ID = X.PROGRAM_ID
                   AND GEOGRAPHY_MASTER_ID =
                       X.GEOGRAPHY_MASTER_ID) AS ACTUALS_ID
          FROM (SELECT INVENTORY.INVENTORY_DATE,
                       0 AS INVENTORY_HOUR,
                       INVENTORY.CFG_UOW_ID,
                       INVENTORY.INVENTORY_COUNT,
                       (SELECT CFG_PROJECT_CONFIG_ID
                          FROM PP_CFG_PROJECT_CONFIG) AS PROJECT_ID,
                       (SELECT CFG_PROGRAM_CONFIG_ID
                          FROM PP_CFG_PROGRAM_CONFIG) AS PROGRAM_ID,
                       (SELECT CFG_GEOGRAPHY_CONFIG_ID
                          FROM PP_CFG_GEOGRAPHY_CONFIG) AS GEOGRAPHY_MASTER_ID
                  FROM (SELECT INVENTORY_DATE,
                               CFG_UOW_ID,
                               COUNT(1) AS INVENTORY_COUNT
                          FROM (SELECT TRUNC(SYSDATE) AS INVENTORY_DATE,
                                       UOW.CFG_UOW_ID,
                                       CASE
                                         WHEN UOW.AGE_DAYS_TYPE =
                                              'BUS' AND
                                              BUS_DAYS_BETWEEN(CREATE_DATE,
                                                               SYSDATE) >=
                                              UOW.JEOPARDY_INV_AGE THEN
                                          'Y'
                                         WHEN UOW.AGE_DAYS_TYPE =
                                              'CAL' AND
                                              TRUNC(SYSDATE) -
                                              TRUNC(CREATE_DATE) >=
                                              UOW.JEOPARDY_INV_AGE THEN
                                          'Y'
                                         ELSE
                                          'N'
                                       END AS JP_FLAG,
                                       UOW.AGE_DAYS_TYPE
                                  FROM PP_CFG_UNIT_OF_WORK UOW
                                 INNER JOIN PP_D_UOW_SOURCE_REF USR
                                    ON UOW.CFG_UOW_ID =
                                       USR.UOW_ID
                                   AND SYSDATE BETWEEN
                                       USR.EFFECTIVE_DATE AND
                                       USR.END_DATE
                                 INNER JOIN PP_D_SOURCE_REF_TYPE SRT
                                    ON USR.SOURCE_REF_TYPE_ID =
                                       SRT.SOURCE_REF_TYPE_ID
                                   AND SRT.SOURCE_REF_TYPE_NAME =
                                       'TASK TYPE'
                                 INNER JOIN PP_D_SOURCE S
                                    ON SRT.SOURCE_ID =
                                       S.SOURCE_ID
                                   AND S.SOURCE_NAME =
                                       'MANAGE WORK STG'
                                 INNER JOIN D_MW_TASK_INSTANCE_SV MW
                                   ON USR.SOURCE_REF_ID = MW.TASK_TYPE_ID 
                                 WHERE COMPLETE_DATE IS NULL
                                   AND CANCEL_WORK_DATE IS NULL
                                   AND UOW.HOURLY_FLAG = 'N') X
                         WHERE JP_FLAG = 'Y'
                         GROUP BY INVENTORY_DATE, CFG_UOW_ID) INVENTORY
                UNION ALL
                SELECT INVENTORY.INVENTORY_DATE,
                       TO_NUMBER(INVENTORY.INVENTORY_HOUR) AS INVENTORY_HOUR,
                       INVENTORY.CFG_UOW_ID,
                       INVENTORY.INVENTORY_COUNT,
                       (SELECT CFG_PROJECT_CONFIG_ID
                          FROM PP_CFG_PROJECT_CONFIG) AS PROJECT_ID,
                       (SELECT CFG_PROGRAM_CONFIG_ID
                          FROM PP_CFG_PROGRAM_CONFIG) AS PROGRAM_ID,
                       (SELECT CFG_GEOGRAPHY_CONFIG_ID
                          FROM PP_CFG_GEOGRAPHY_CONFIG) AS GEOGRAPHY_MASTER_ID
                  FROM (SELECT TRUNC(SYSDATE) AS INVENTORY_DATE,
                               TO_CHAR(SYSDATE, 'HH24') AS INVENTORY_HOUR,
                               UOW.CFG_UOW_ID,
                               COUNT(1) AS INVENTORY_COUNT
                          FROM PP_CFG_UNIT_OF_WORK UOW
                         INNER JOIN PP_D_UOW_SOURCE_REF USR
                            ON UOW.CFG_UOW_ID = USR.UOW_ID
                           AND SYSDATE BETWEEN
                               USR.EFFECTIVE_DATE AND
                               USR.END_DATE
                         INNER JOIN PP_D_SOURCE_REF_TYPE SRT
                            ON USR.SOURCE_REF_TYPE_ID =
                               SRT.SOURCE_REF_TYPE_ID
                           AND SRT.SOURCE_REF_TYPE_NAME =
                               'TASK TYPE'
                         INNER JOIN PP_D_SOURCE S
                            ON SRT.SOURCE_ID = S.SOURCE_ID
                           AND S.SOURCE_NAME =
                               'MANAGE WORK STG'
                         INNER JOIN D_MW_TASK_INSTANCE_SV MW
                                   ON USR.SOURCE_REF_ID = MW.TASK_TYPE_ID 
                         WHERE COMPLETE_DATE IS NULL
                           AND CANCEL_WORK_DATE IS NULL
                           AND JEOPARDY_FLAG = 'Y'
                           AND UOW.HOURLY_FLAG = 'Y'
                         GROUP BY TRUNC(SYSDATE),
                                  TO_CHAR(SYSDATE, 'HH24'),
                                  UOW.CFG_UOW_ID) INVENTORY) X
    ) 
    LOOP
        CASE
            WHEN (RECS.ACTUALS_ID >=0) THEN 
              UPDATE PP_F_ACTUALS
                 SET ACTL_INVENTORY_JEOPARDY = RECS.INVENTORY_COUNT
               WHERE ACTUALS_ID=RECS.ACTUALS_ID;
            ELSE 
              INSERT INTO PP_F_ACTUALS
                (ACTUALS_ID,
                 D_DATE,
                 D_HOUR,
                 UOW_ID,
                 PROJECT_ID,
                 PROGRAM_ID,
                 GEOGRAPHY_MASTER_ID,
                 ACTL_INVENTORY_JEOPARDY)
              VALUES
                (SEQ_PP_F_ACTUALS_ID.NEXTVAL,
                 RECS.INVENTORY_DATE,
                 RECS.INVENTORY_HOUR,
                 RECS.CFG_UOW_ID,
                 RECS.PROJECT_ID,
                 RECS.PROGRAM_ID,
                 RECS.GEOGRAPHY_MASTER_ID,
                 RECS.INVENTORY_COUNT);
          END CASE;
  END LOOP;
  INSERT INTO PP_STG_LOG
      (PP_STG_ID, LOG_TYPE, PROCESS_DATE, PROCESS, DESCRIPTION, CREATE_DATE)
      VALUES (SEQ_PP_STG_ID.NEXTVAL,'LOG',SYSDATE,'PP_Actuals_Process_v3','MW Inventory Jeopardy - Processed', SYSDATE); 
  COMMIT;


EXCEPTION
WHEN OTHERS 
  THEN 
    ROLLBACK;
    V_ERRCODE := SQLCODE;
    V_ERRMSG := SUBSTR(SQLERRM, 1, 3000);                 
    INSERT INTO PP_STG_LOG
      (PP_STG_ID, LOG_TYPE, PROCESS_DATE, PROCESS, DESCRIPTION, CREATE_DATE)
      VALUES (SEQ_PP_STG_ID.NEXTVAL,'ERR',SYSDATE,'PP_Actuals_Process_v3','MW Inventory Jeopardy - ' || V_ERRCODE || ' : ' || V_ERRMSG,SYSDATE); 
      COMMIT; 
    RAISE;
END;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>T</sendOneStatement>
      <connection>MAXDAT</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>692</xloc>
      <yloc>702</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>MW Inventory Min,Max, etc</name>
      <description/>
      <type>SQL</type>
      <attributes/>
      <sql>DECLARE
V_ERRCODE varchar2(50);
V_ERRMSG varchar2(3000);

BEGIN
  FOR RECS IN 
    (
      SELECT X.INVENTORY_DATE,
       X.INVENTORY_HOUR,
       X.CFG_UOW_ID,
       X.PROJECT_ID,
       X.PROGRAM_ID,
       X.GEOGRAPHY_MASTER_ID,
       X.INVENTORY_COUNT,
       X.INV_AGE_MIN,
       X.INV_AGE_MAX,
       X.INV_AGE_MEAN,
       X.INV_AGE_MEDIAN,
       X.INV_AGE_STDDEV,
       (SELECT ACTUALS_ID
          FROM PP_F_ACTUALS
         WHERE D_DATE = X.INVENTORY_DATE
           AND D_HOUR = X.INVENTORY_HOUR
           AND UOW_ID = X.CFG_UOW_ID
           AND PROJECT_ID = X.PROJECT_ID
           AND PROGRAM_ID = X.PROGRAM_ID
           AND GEOGRAPHY_MASTER_ID = X.GEOGRAPHY_MASTER_ID) AS ACTUALS_ID
  FROM (SELECT DISTINCT INVENTORY.INVENTORY_DATE,
                        0 AS INVENTORY_HOUR,
                        INVENTORY.CFG_UOW_ID,
                        SUM(INVENTORY.INVENTORY_COUNT) OVER(PARTITION BY INVENTORY.INVENTORY_DATE, INVENTORY.CFG_UOW_ID) as INVENTORY_COUNT,
                        MIN(INVENTORY.INV_AGE) OVER(PARTITION BY INVENTORY.INVENTORY_DATE, INVENTORY.CFG_UOW_ID) AS INV_AGE_MIN,
                        MAX(INVENTORY.INV_AGE) OVER(PARTITION BY INVENTORY.INVENTORY_DATE, INVENTORY.CFG_UOW_ID) AS INV_AGE_MAX,
                        AVG(INVENTORY.INV_AGE) OVER(PARTITION BY INVENTORY.INVENTORY_DATE, INVENTORY.CFG_UOW_ID) AS INV_AGE_MEAN,
                        MEDIAN(INVENTORY.INV_AGE) OVER(PARTITION BY INVENTORY.INVENTORY_DATE, INVENTORY.CFG_UOW_ID) AS INV_AGE_MEDIAN,
                        STDDEV(INVENTORY.INV_AGE) OVER(PARTITION BY INVENTORY.INVENTORY_DATE, INVENTORY.CFG_UOW_ID) AS INV_AGE_STDDEV,
                        (SELECT CFG_PROJECT_CONFIG_ID
                           FROM PP_CFG_PROJECT_CONFIG) AS PROJECT_ID,
                        (SELECT CFG_PROGRAM_CONFIG_ID
                           FROM PP_CFG_PROGRAM_CONFIG) AS PROGRAM_ID,
                        (SELECT CFG_GEOGRAPHY_CONFIG_ID
                           FROM PP_CFG_GEOGRAPHY_CONFIG) AS GEOGRAPHY_MASTER_ID
          FROM (SELECT TRUNC(SYSDATE) AS INVENTORY_DATE,
                       UOW.CFG_UOW_ID,
                       1 AS INVENTORY_COUNT,
                       CASE
                         WHEN UOW.AGE_DAYS_TYPE = 'BUS' THEN 
                           BUS_DAYS_BETWEEN(TRUNC(CREATE_DATE),TRUNC(SYSDATE))
                         ELSE
                          (SELECT TRUNC(SYSDATE) - TRUNC(CREATE_DATE) AS AGE FROM DUAL)  
                       END AS INV_AGE
                  FROM PP_CFG_UNIT_OF_WORK UOW
                 INNER JOIN PP_D_UOW_SOURCE_REF USR
                    ON UOW.CFG_UOW_ID = USR.UOW_ID
                   AND SYSDATE BETWEEN USR.EFFECTIVE_DATE AND USR.END_DATE
                 INNER JOIN PP_D_SOURCE_REF_TYPE SRT
                    ON USR.SOURCE_REF_TYPE_ID = SRT.SOURCE_REF_TYPE_ID
                   AND SRT.SOURCE_REF_TYPE_NAME = 'TASK TYPE'
                 INNER JOIN PP_D_SOURCE S
                    ON SRT.SOURCE_ID = S.SOURCE_ID
                   AND S.SOURCE_NAME = 'MANAGE WORK STG'
                 INNER JOIN D_MW_TASK_INSTANCE_SV MW 
                    ON USR.SOURCE_REF_ID = MW.TASK_TYPE_ID 
                 WHERE  
                   COMPLETE_DATE IS NULL
                   AND UOW.HOURLY_FLAG = 'N'
                   AND CANCEL_WORK_DATE IS NULL) INVENTORY
        
        UNION ALL
        SELECT DISTINCT INVENTORY.INVENTORY_DATE,
                        TO_NUMBER(INVENTORY.INVENTORY_HOUR) AS INVENTORY_HOUR,
                        INVENTORY.CFG_UOW_ID,
                        SUM(INVENTORY.INVENTORY_COUNT) OVER(PARTITION BY INVENTORY.INVENTORY_DATE, INVENTORY.INVENTORY_HOUR, INVENTORY.CFG_UOW_ID) as INVENTORY_COUNT,
                        MIN(INVENTORY.INV_AGE) OVER(PARTITION BY INVENTORY.INVENTORY_DATE, INVENTORY.INVENTORY_HOUR, INVENTORY.CFG_UOW_ID) AS INV_AGE_MIN,
                        MAX(INVENTORY.INV_AGE) OVER(PARTITION BY INVENTORY.INVENTORY_DATE, INVENTORY.INVENTORY_HOUR, INVENTORY.CFG_UOW_ID) AS INV_AGE_MAX,
                        AVG(INVENTORY.INV_AGE) OVER(PARTITION BY INVENTORY.INVENTORY_DATE, INVENTORY.INVENTORY_HOUR, INVENTORY.CFG_UOW_ID) AS INV_AGE_MEAN,
                        MEDIAN(INVENTORY.INV_AGE) OVER(PARTITION BY INVENTORY.INVENTORY_DATE, INVENTORY.INVENTORY_HOUR, INVENTORY.CFG_UOW_ID) AS INV_AGE_MEDIAN,
                        STDDEV(INVENTORY.INV_AGE) OVER(PARTITION BY INVENTORY.INVENTORY_DATE, INVENTORY.INVENTORY_HOUR, INVENTORY.CFG_UOW_ID) AS INV_AGE_STDDEV,
                        (SELECT CFG_PROJECT_CONFIG_ID
                           FROM PP_CFG_PROJECT_CONFIG) AS PROJECT_ID,
                        (SELECT CFG_PROGRAM_CONFIG_ID
                           FROM PP_CFG_PROGRAM_CONFIG) AS PROGRAM_ID,
                        (SELECT CFG_GEOGRAPHY_CONFIG_ID
                           FROM PP_CFG_GEOGRAPHY_CONFIG) AS GEOGRAPHY_MASTER_ID
          FROM (SELECT TRUNC(SYSDATE) AS INVENTORY_DATE,
                       TO_CHAR(SYSDATE, 'HH24') AS INVENTORY_HOUR,
                       UOW.CFG_UOW_ID,
                       1 AS INVENTORY_COUNT,
                       CASE
                         WHEN UOW.AGE_DAYS_TYPE = 'BUS' THEN 
                           BUS_DAYS_BETWEEN(TRUNC(CREATE_DATE),TRUNC(SYSDATE))
                         ELSE
                          (SELECT TRUNC(SYSDATE) - TRUNC(CREATE_DATE) AS AGE FROM DUAL)  
                       END AS INV_AGE
                  FROM PP_CFG_UNIT_OF_WORK UOW
                 INNER JOIN PP_D_UOW_SOURCE_REF USR
                    ON UOW.CFG_UOW_ID = USR.UOW_ID
                   AND SYSDATE BETWEEN USR.EFFECTIVE_DATE AND USR.END_DATE
                 INNER JOIN PP_D_SOURCE_REF_TYPE SRT
                    ON USR.SOURCE_REF_TYPE_ID = SRT.SOURCE_REF_TYPE_ID
                   AND SRT.SOURCE_REF_TYPE_NAME = 'TASK TYPE'
                 INNER JOIN PP_D_SOURCE S
                    ON SRT.SOURCE_ID = S.SOURCE_ID
                   AND S.SOURCE_NAME = 'MANAGE WORK STG'
                 INNER JOIN D_MW_TASK_INSTANCE_SV MW
                    ON USR.SOURCE_REF_ID = MW.TASK_TYPE_ID 
                 WHERE  
                   COMPLETE_DATE IS NULL
                   AND UOW.HOURLY_FLAG = 'Y'
                   AND CANCEL_WORK_DATE IS NULL) INVENTORY) X
    ) 
    LOOP
        CASE
            WHEN (RECS.ACTUALS_ID >=0) THEN 
              UPDATE PP_F_ACTUALS
                 SET ACTL_INVENTORY=RECS.INVENTORY_COUNT,
                     ACTL_INVENTORY_AGE_MIN=RECS.INV_AGE_MIN,
                     ACTL_INVENTORY_AGE_MAX=RECS.INV_AGE_MAX,
                     ACTL_INVENTORY_AGE_MEAN=RECS.INV_AGE_MEAN,
                     ACTL_INVENTORY_AGE_MEDIAN=RECS.INV_AGE_MEDIAN,
                     ACTL_INVENTORY_AGE_SD=RECS.INV_AGE_STDDEV
               WHERE ACTUALS_ID=RECS.ACTUALS_ID;
            ELSE 
              INSERT INTO PP_F_ACTUALS
                (ACTUALS_ID,
                 D_DATE,
                 D_HOUR,
                 UOW_ID,
                 PROJECT_ID,
                 PROGRAM_ID,
                 GEOGRAPHY_MASTER_ID,
         ACTL_INVENTORY,
                 ACTL_INVENTORY_AGE_MIN,
                 ACTL_INVENTORY_AGE_MAX,
                 ACTL_INVENTORY_AGE_MEAN,
                 ACTL_INVENTORY_AGE_MEDIAN,
                 ACTL_INVENTORY_AGE_SD)
              VALUES
                (SEQ_PP_F_ACTUALS_ID.NEXTVAL,
                 RECS.INVENTORY_DATE,
                 RECS.INVENTORY_HOUR,
                 RECS.CFG_UOW_ID,
                 RECS.PROJECT_ID,
                 RECS.PROGRAM_ID,
                 RECS.GEOGRAPHY_MASTER_ID,
                 RECS.INVENTORY_COUNT,
         RECS.INV_AGE_MIN,
                 RECS.INV_AGE_MAX,
                 RECS.INV_AGE_MEAN,
                 RECS.INV_AGE_MEDIAN,
                 RECS.INV_AGE_STDDEV);
          END CASE;
  END LOOP;
  INSERT INTO PP_STG_LOG
      (PP_STG_ID, LOG_TYPE, PROCESS_DATE, PROCESS, DESCRIPTION, CREATE_DATE)
      VALUES (SEQ_PP_STG_ID.NEXTVAL,'LOG',SYSDATE,'PP_Actuals_Process_v3','MW Inventory Min,Max, etc - Processed', SYSDATE); 
  COMMIT;


EXCEPTION
WHEN OTHERS 
  THEN 
    ROLLBACK;
    V_ERRCODE := SQLCODE;
    V_ERRMSG := SUBSTR(SQLERRM, 1, 3000);                 
    INSERT INTO PP_STG_LOG
      (PP_STG_ID, LOG_TYPE, PROCESS_DATE, PROCESS, DESCRIPTION, CREATE_DATE)
      VALUES (SEQ_PP_STG_ID.NEXTVAL,'ERR',SYSDATE,'PP_Actuals_Process_v3','MW Inventory Min,Max, etc - ' || V_ERRCODE || ' : ' || V_ERRMSG,SYSDATE); 
      COMMIT; 
	  RAISE;
END;
 </sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>T</sendOneStatement>
      <connection>MAXDAT</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>694</xloc>
      <yloc>838</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>MW Zero HandleTime and Staff</name>
      <description/>
      <type>SQL</type>
      <attributes/>
      <sql>DECLARE
V_ERRCODE varchar2(50);
V_ERRMSG varchar2(3000);

BEGIN
  FOR RECS IN 
    (
      SELECT ACTUALS_ID
		  FROM PP_F_ACTUALS
		  WHERE ACTL_HANDLE_TIME_AVG IS NULL
		    OR ACTL_HANDLE_TIME_MIN IS NULL
		    OR ACTL_HANDLE_TIME_MAX IS NULL
		    OR ACTL_HANDLE_TIME_MEAN IS NULL
		    OR ACTL_HANDLE_TIME_MEDIAN IS NULL
		    OR ACTL_HANDLE_TIME_SD IS NULL
		    OR ACTL_STAFF_HOURS IS NULL
    ) 
    LOOP

              UPDATE PP_F_ACTUALS
				   SET ACTL_HANDLE_TIME_AVG    = 0,
				       ACTL_HANDLE_TIME_MIN    = 0,
       				   ACTL_HANDLE_TIME_MAX    = 0,
				       ACTL_HANDLE_TIME_MEAN   = 0,
				       ACTL_HANDLE_TIME_MEDIAN = 0,
				       ACTL_HANDLE_TIME_SD     = 0,
				       ACTL_STAFF_HOURS        = 0
			 WHERE ACTUALS_ID = RECS.ACTUALS_ID;
  END LOOP;
  INSERT INTO PP_STG_LOG
      (PP_STG_ID, LOG_TYPE, PROCESS_DATE, PROCESS, DESCRIPTION, CREATE_DATE)
      VALUES (SEQ_PP_STG_ID.NEXTVAL,'LOG',SYSDATE,'PP_Actuals_Process_v3','MW Zero HandleTime and Staff - Processed', SYSDATE); 
  COMMIT;


EXCEPTION
WHEN OTHERS 
  THEN 
    ROLLBACK;
    V_ERRCODE := SQLCODE;
    V_ERRMSG := SUBSTR(SQLERRM, 1, 3000);                 
    INSERT INTO PP_STG_LOG
      (PP_STG_ID, LOG_TYPE, PROCESS_DATE, PROCESS, DESCRIPTION, CREATE_DATE)
      VALUES (SEQ_PP_STG_ID.NEXTVAL,'ERR',SYSDATE,'PP_Actuals_Process_v3','MW Zero HandleTime and Staff - ' || V_ERRCODE || ' : ' || V_ERRMSG,SYSDATE); 
      COMMIT; 
	  RAISE;
END;                  
  

  </sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>T</sendOneStatement>
      <connection>MAXDAT</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>694</xloc>
      <yloc>958</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>MW Actual Details Arrivals</name>
      <description/>
      <type>SQL</type>
      <attributes/>
      <sql>DECLARE
V_ERRCODE varchar2(50);
V_ERRMSG varchar2(3000);

BEGIN
  FOR RECS IN 
    (
      SELECT X.D_DATE, X.D_HOUR, X.USR_ID, X.TASK_ID, X.ACTUAL_CNT, X.COMPLETE_DATE, X.JEOPARDY_FLAG
      FROM (SELECT DISTINCT TRUNC(CREATE_DATE) AS D_DATE,
                            0 AS D_HOUR,
                            USR.USR_ID,
                            MW.TASK_ID,
                            TRUNC(MW.COMPLETE_DATE) AS COMPLETE_DATE,
                            1 AS ACTUAL_CNT,
                            CASE
                               WHEN UOW.AGE_DAYS_TYPE = 'BUS' AND BUS_DAYS_BETWEEN(CREATE_DATE, SYSDATE) >= UOW.JEOPARDY_INV_AGE THEN
                                'Y'
                               WHEN UOW.AGE_DAYS_TYPE = 'CAL' AND TRUNC(SYSDATE) - TRUNC(CREATE_DATE) >= UOW.JEOPARDY_INV_AGE THEN
                                'Y'
                               ELSE
                                'N'
                             END AS JEOPARDY_FLAG
              FROM PP_CFG_UNIT_OF_WORK UOW
             INNER JOIN PP_D_UOW_SOURCE_REF USR
                ON UOW.CFG_UOW_ID = USR.UOW_ID
               AND SYSDATE BETWEEN USR.EFFECTIVE_DATE AND USR.END_DATE
             INNER JOIN PP_D_SOURCE_REF_TYPE SRT
                ON USR.SOURCE_REF_TYPE_ID = SRT.SOURCE_REF_TYPE_ID
               AND SRT.SOURCE_REF_TYPE_NAME = 'TASK TYPE'
             INNER JOIN PP_D_SOURCE S
                ON SRT.SOURCE_ID = S.SOURCE_ID
               AND S.SOURCE_NAME = 'MANAGE WORK STG'
             INNER JOIN D_MW_TASK_INSTANCE_SV MW
                ON USR.SOURCE_REF_ID = MW.TASK_TYPE_ID 
             WHERE CREATE_DATE >= TRUNC(SYSDATE - 730) 
               AND UOW.HOURLY_FLAG = 'N'
            UNION ALL
            SELECT DISTINCT TRUNC(CREATE_DATE) AS D_DATE,
                            TO_NUMBER(TO_CHAR(CREATE_DATE, 'HH24')) AS D_HOUR,
                            USR.USR_ID,
                            MW.TASK_ID,
                            TRUNC(MW.COMPLETE_DATE) AS COMPLETE_DATE,
                            1 AS ACTUAL_CNT,
                            CASE
                               WHEN UOW.AGE_DAYS_TYPE = 'BUS' AND BUS_DAYS_BETWEEN(CREATE_DATE, SYSDATE) >= UOW.JEOPARDY_INV_AGE THEN
                                'Y'
                               WHEN UOW.AGE_DAYS_TYPE = 'CAL' AND TRUNC(SYSDATE) - TRUNC(CREATE_DATE) >= UOW.JEOPARDY_INV_AGE THEN
                                'Y'
                               ELSE
                                'N'
                             END AS JEOPARDY_FLAG
              FROM PP_CFG_UNIT_OF_WORK UOW
             INNER JOIN PP_D_UOW_SOURCE_REF USR
                ON UOW.CFG_UOW_ID = USR.UOW_ID
               AND SYSDATE BETWEEN USR.EFFECTIVE_DATE AND USR.END_DATE
             INNER JOIN PP_D_SOURCE_REF_TYPE SRT
                ON USR.SOURCE_REF_TYPE_ID = SRT.SOURCE_REF_TYPE_ID
               AND SRT.SOURCE_REF_TYPE_NAME = 'TASK TYPE'
             INNER JOIN PP_D_SOURCE S
                ON SRT.SOURCE_ID = S.SOURCE_ID
               AND S.SOURCE_NAME = 'MANAGE WORK STG'
             INNER JOIN D_MW_TASK_INSTANCE_SV MW
                ON USR.SOURCE_REF_ID = MW.TASK_TYPE_ID 
             WHERE CREATE_DATE >= TRUNC(SYSDATE - 730) 
               AND UOW.HOURLY_FLAG = 'Y') X
             WHERE NOT EXISTS (SELECT DAD_ID
                    FROM PP_D_ACTUAL_DETAILS
                   WHERE D_DATE = X.D_DATE
                     AND D_HOUR = X.D_HOUR
                     AND USR_ID = X.USR_ID
                     AND SOURCE_DETAIL_ID = X.TASK_ID)  
      ORDER BY X.D_DATE, X.D_HOUR, X.TASK_ID
) 
    LOOP
              INSERT INTO PP_D_ACTUAL_DETAILS
                (DAD_ID,
                 D_DATE,
                 D_HOUR,
                 USR_ID,
                 SOURCE_DETAIL_ID,
                 ACTUAL_ARRIVAL,
                 ACTUAL_COMPLETION,
                 ACTUAL_INVENTORY,
                 ACTUAL_INVENTORY_AGE,
                 ACTUAL_HANDLE_TIME,
                 ACTUAL_STAFF_HOURS,
                 BUCKET_START_DATE,
                 BUCKET_END_DATE,
                 JEOPARDY_FLAG)
              VALUES
                (SEQ_PP_DAD_ID.NEXTVAL,
                 RECS.D_DATE,
                 RECS.D_HOUR,
                 RECS.USR_ID,
                 RECS.TASK_ID,
                 1,
                 0,
                 1,
                 0,
                 0,
                 0,
                 RECS.D_DATE,
                 TO_DATE('07/07/2077','MM/DD/YYYY'),
                 RECS.JEOPARDY_FLAG
);
  END LOOP;
  INSERT INTO PP_STG_LOG
      (PP_STG_ID, LOG_TYPE, PROCESS_DATE, PROCESS, DESCRIPTION, CREATE_DATE)
      VALUES (SEQ_PP_STG_ID.NEXTVAL,'LOG',SYSDATE,'PP_Actuals_Process_v3','MW Actual Details Arrivals - Processed', SYSDATE); 
  COMMIT;


EXCEPTION
WHEN OTHERS 
  THEN 
    ROLLBACK;
    V_ERRCODE := SQLCODE;
    V_ERRMSG := SUBSTR(SQLERRM, 1, 3000);                 
    INSERT INTO PP_STG_LOG
      (PP_STG_ID, LOG_TYPE, PROCESS_DATE, PROCESS, DESCRIPTION, CREATE_DATE)
      VALUES (SEQ_PP_STG_ID.NEXTVAL,'ERR',SYSDATE,'PP_Actuals_Process_v3','MW Actual Details Arrivals - ' || V_ERRCODE || ' : ' || V_ERRMSG,SYSDATE); 
      COMMIT; 
    RAISE;
END; </sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>T</sendOneStatement>
      <connection>MAXDAT</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>694</xloc>
      <yloc>1352</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>MW Actual Details Completions</name>
      <description/>
      <type>SQL</type>
      <attributes/>
      <sql>DECLARE
V_ERRCODE varchar2(50);
V_ERRMSG varchar2(3000);

BEGIN
  FOR RECS IN 
    (
       SELECT DAD_ID,
             SOURCE_DETAIL_ID,
             D_HOUR,
             D_DATE,
             USR_ID,
             TASK_ID,
             COMPLETE_DATE,
             JEOPARDY_FLAG,
             COMPLETED_SAME_DAY
       FROM      
       (SELECT DAD.DAD_ID,
             DAD.SOURCE_DETAIL_ID,
             DAD.D_HOUR,
             DAD.D_DATE,
             DAD.USR_ID,
             MW.TASK_ID,
             CASE WHEN MW.CANCEL_WORK_DATE IS NOT NULL THEN TRUNC(MW.CANCEL_WORK_DATE)
                                           ELSE TRUNC(MW.COMPLETE_DATE)
                                      END AS COMPLETE_DATE,
             CASE
               WHEN UOW.AGE_DAYS_TYPE = 'BUS' AND BUS_DAYS_BETWEEN(CREATE_DATE, SYSDATE) >= UOW.JEOPARDY_INV_AGE THEN
                'Y'
               WHEN UOW.AGE_DAYS_TYPE = 'CAL' AND TRUNC(SYSDATE) - TRUNC(CREATE_DATE) >= UOW.JEOPARDY_INV_AGE THEN
                'Y'
               ELSE
                'N'
             END AS JEOPARDY_FLAG,
             DAD.JEOPARDY_FLAG AS DAD_JEOPARDY_FLAG,
             CASE WHEN TRUNC(MW.CREATE_DATE) = TRUNC(MW.COMPLETE_DATE)
               THEN 'Y'
                 ELSE 'N'
             END AS COMPLETED_SAME_DAY,
             MW.CANCEL_WORK_DATE
          FROM PP_D_SOURCE S
       INNER JOIN PP_D_SOURCE_REF_TYPE SRT
          ON SRT.SOURCE_ID = S.SOURCE_ID
         AND S.SOURCE_NAME = 'MANAGE WORK STG'
         AND SRT.SOURCE_REF_TYPE_NAME = 'TASK TYPE'
       INNER JOIN PP_D_UOW_SOURCE_REF USR
          ON USR.SOURCE_REF_TYPE_ID = SRT.SOURCE_REF_TYPE_ID
         AND SYSDATE BETWEEN USR.EFFECTIVE_DATE AND USR.END_DATE
       INNER JOIN PP_CFG_UNIT_OF_WORK UOW
            ON UOW.CFG_UOW_ID = USR.UOW_ID  
       INNER JOIN PP_D_ACTUAL_DETAILS DAD
          ON DAD.USR_ID = USR.USR_ID
       INNER JOIN D_MW_TASK_INSTANCE_SV MW
          ON MW.TASK_ID = DAD.SOURCE_DETAIL_ID
       WHERE DAD.BUCKET_END_DATE = TO_DATE('07/07/2077', 'MM/DD/YYYY')) R
         WHERE (R.COMPLETE_DATE IS NOT NULL OR R.CANCEL_WORK_DATE IS NOT NULL
          OR R.JEOPARDY_FLAG &lt;&gt; R.DAD_JEOPARDY_FLAG)    
) 
    LOOP
         CASE WHEN RECS.COMPLETE_DATE IS NOT NULL AND RECS.COMPLETED_SAME_DAY='Y' THEN
                UPDATE PP_D_ACTUAL_DETAILS
                   SET BUCKET_END_DATE=RECS.COMPLETE_DATE, ACTUAL_INVENTORY=0, ACTUAL_COMPLETION=1
                 WHERE DAD_ID=RECS.DAD_ID;
         ELSE
                 UPDATE PP_D_ACTUAL_DETAILS
                       SET BUCKET_END_DATE=
                       CASE
                           WHEN RECS.COMPLETE_DATE IS NULL THEN TRUNC(SYSDATE)
                            ELSE RECS.COMPLETE_DATE
                       END
                     WHERE DAD_ID=RECS.DAD_ID;
               
                 INSERT INTO PP_D_ACTUAL_DETAILS
                      (DAD_ID,
                       D_DATE,
                       D_HOUR,
                       USR_ID,
                       SOURCE_DETAIL_ID,
                       ACTUAL_ARRIVAL,
                       ACTUAL_COMPLETION,
                       ACTUAL_INVENTORY,
                       ACTUAL_INVENTORY_AGE,
                       ACTUAL_HANDLE_TIME,
                       ACTUAL_STAFF_HOURS,
                       BUCKET_START_DATE,
                       BUCKET_END_DATE,
                       JEOPARDY_FLAG)
                    VALUES
                      (SEQ_PP_DAD_ID.NEXTVAL,
                       CASE
                           WHEN RECS.COMPLETE_DATE IS NULL THEN TRUNC(SYSDATE)
                            ELSE RECS.COMPLETE_DATE
                       END,
                       RECS.D_HOUR,
                       RECS.USR_ID,
                       RECS.TASK_ID,
                       0,
                       CASE
                           WHEN RECS.COMPLETE_DATE IS NULL THEN 0
                            ELSE 1
                       END,
                       CASE
                           WHEN RECS.COMPLETE_DATE IS NULL THEN 1
                            ELSE 0
                       END,
                       0,
                       0,
                       0,
                       CASE
                           WHEN RECS.COMPLETE_DATE IS NULL THEN TRUNC(SYSDATE)
                            ELSE RECS.COMPLETE_DATE
                       END,
                       CASE
                           WHEN RECS.COMPLETE_DATE IS NULL THEN TO_DATE('07/07/2077','MM/DD/YYYY')
                            ELSE RECS.COMPLETE_DATE
                       END,
                       RECS.JEOPARDY_FLAG                 
                       );
         END CASE;              
  END LOOP;
  INSERT INTO PP_STG_LOG
      (PP_STG_ID, LOG_TYPE, PROCESS_DATE, PROCESS, DESCRIPTION, CREATE_DATE)
      VALUES (SEQ_PP_STG_ID.NEXTVAL,'LOG',SYSDATE,'PP_Actuals_Process_v3','MW Actual Details Completions - Processed', SYSDATE); 
  COMMIT;


EXCEPTION
WHEN OTHERS 
  THEN 
    ROLLBACK;
    V_ERRCODE := SQLCODE;
    V_ERRMSG := SUBSTR(SQLERRM, 1, 3000);                 
    INSERT INTO PP_STG_LOG
      (PP_STG_ID, LOG_TYPE, PROCESS_DATE, PROCESS, DESCRIPTION, CREATE_DATE)
      VALUES (SEQ_PP_STG_ID.NEXTVAL,'ERR',SYSDATE,'PP_Actuals_Process_v3','MW Actual Details Completions - ' || V_ERRCODE || ' : ' || V_ERRMSG,SYSDATE); 
      COMMIT; 
    RAISE;
END;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>T</sendOneStatement>
      <connection>MAXDAT</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>701</xloc>
      <yloc>1481</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>Actuals Backfill Missing Days</name>
      <description/>
      <type>SQL</type>
      <attributes/>
      <sql>DECLARE
V_ERRCODE varchar2(50);
V_ERRMSG varchar2(3000);

BEGIN
  FOR 
    RECS IN
    (               
                 WITH DAYS AS
                  (SELECT TRUNC(SYSDATE - 730) + ROWNUM missing_date
                     FROM ALL_OBJECTS
                    WHERE ROWNUM &lt;= 730),
                 ALL_DAYS AS
                  (SELECT DAYS.missing_date FROM DAYS)
                 
                 SELECT Y.D_DATE,
                        Y.D_HOUR,
                        Y.UOW_ID,
                        Y.PROJECT_ID,
                        Y.PROGRAM_ID,
                        Y.GEOGRAPHY_MASTER_ID
                   FROM (SELECT AD.MISSING_DATE AS D_DATE,
                                X.CFG_UOW_ID AS UOW_ID,
                                0 AS D_HOUR,
                                (SELECT CFG_PROJECT_CONFIG_ID
                                   FROM PP_CFG_PROJECT_CONFIG) AS PROJECT_ID,
                                (SELECT CFG_PROGRAM_CONFIG_ID
                                   FROM PP_CFG_PROGRAM_CONFIG) AS PROGRAM_ID,
                                (SELECT CFG_GEOGRAPHY_CONFIG_ID
                                   FROM PP_CFG_GEOGRAPHY_CONFIG) AS GEOGRAPHY_MASTER_ID
                           FROM ALL_DAYS AD,
                                (SELECT DISTINCT UOW.CFG_UOW_ID
                                   FROM PP_CFG_UNIT_OF_WORK UOW
                                  INNER JOIN PP_D_UOW_SOURCE_REF USR
                                     ON UOW.CFG_UOW_ID = USR.UOW_ID
                                    AND SYSDATE BETWEEN USR.EFFECTIVE_DATE AND
                                        USR.END_DATE
                                  INNER JOIN PP_D_SOURCE_REF_TYPE SRT
                                     ON USR.SOURCE_REF_TYPE_ID =
                                        SRT.SOURCE_REF_TYPE_ID
                                    AND SRT.SOURCE_REF_TYPE_NAME = 'TASK TYPE'
                                  INNER JOIN PP_D_SOURCE S
                                     ON SRT.SOURCE_ID = S.SOURCE_ID
                                    AND S.SOURCE_NAME = 'MANAGE WORK STG') X) Y
                  WHERE (SELECT ACTUALS_ID
                           FROM PP_F_ACTUALS
                          WHERE D_DATE = Y.D_DATE
                            AND D_HOUR = Y.D_HOUR
                            AND UOW_ID = Y.UOW_ID
                            AND PROJECT_ID = Y.PROJECT_ID
                            AND PROGRAM_ID = Y.PROGRAM_ID
                            AND GEOGRAPHY_MASTER_ID = Y.GEOGRAPHY_MASTER_ID) IS NULL
                  ORDER BY Y.D_DATE, Y.D_HOUR, Y.UOW_ID
    ) 
    LOOP  
        INSERT INTO PP_F_ACTUALS
          (ACTUALS_ID,
           D_DATE,
           D_HOUR,
           UOW_ID,
           PROJECT_ID,
           PROGRAM_ID,
           GEOGRAPHY_MASTER_ID,
           ACTL_ARRIVAL,
           ACTL_COMPLETION,
           ACTL_INVENTORY,
           ACTL_INVENTORY_AGE_AVG,
           ACTL_INVENTORY_AGE_MIN,
           ACTL_INVENTORY_AGE_MAX,
           ACTL_INVENTORY_AGE_MEAN,
           ACTL_INVENTORY_AGE_MEDIAN,
           ACTL_INVENTORY_AGE_SD,
           ACTL_INVENTORY_JEOPARDY,
           ACTL_HANDLE_TIME_AVG,
           ACTL_HANDLE_TIME_MIN,
           ACTL_HANDLE_TIME_MAX,
           ACTL_HANDLE_TIME_MEAN,
           ACTL_HANDLE_TIME_MEDIAN,
           ACTL_HANDLE_TIME_SD,
           ACTL_STAFF_HOURS)
        VALUES
          (SEQ_PP_F_ACTUALS_ID.NEXTVAL,
           RECS.D_DATE,
           RECS.D_HOUR,
           RECS.UOW_ID,
           RECS.PROJECT_ID,
           RECS.PROGRAM_ID,
           RECS.GEOGRAPHY_MASTER_ID,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0,
           0);
    END LOOP;
  INSERT INTO PP_STG_LOG
      (PP_STG_ID, LOG_TYPE, PROCESS_DATE, PROCESS, DESCRIPTION, CREATE_DATE)
      VALUES (SEQ_PP_STG_ID.NEXTVAL,'LOG',SYSDATE,'PP_Actuals_Process_v3','Actuals Backfill Missing Days - Processed', SYSDATE); 
  COMMIT;


EXCEPTION
WHEN OTHERS 
  THEN 
    ROLLBACK;
    V_ERRCODE := SQLCODE;
    V_ERRMSG := SUBSTR(SQLERRM, 1, 3000);                 
    INSERT INTO PP_STG_LOG
      (PP_STG_ID, LOG_TYPE, PROCESS_DATE, PROCESS, DESCRIPTION, CREATE_DATE)
      VALUES (SEQ_PP_STG_ID.NEXTVAL,'ERR',SYSDATE,'PP_Actuals_Process_v3','Actuals Backfill Missing Days - ' || V_ERRCODE || ' : ' || V_ERRMSG,SYSDATE); 
      COMMIT; 
	  RAISE;
END;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>T</sendOneStatement>
      <connection>MAXDAT</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>694</xloc>
      <yloc>1623</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>Success</name>
      <description/>
      <type>SUCCESS</type>
      <attributes/>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>1561</xloc>
      <yloc>1634</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>Avg Handle Times and Staff Hours From MW_Tasks</name>
      <description/>
      <type>SQL</type>
      <attributes/>
      <sql>DECLARE
V_ERRCODE varchar2(50);
V_ERRMSG varchar2(3000);

BEGIN
  
  INSERT INTO PP_STG_LOG
      (PP_STG_ID, LOG_TYPE, PROCESS_DATE, PROCESS, DESCRIPTION, CREATE_DATE)
      VALUES (SEQ_PP_STG_ID.NEXTVAL,'LOG',SYSDATE,'PP_Actuals_Process_v3','Avg Handle Times and Staff Hours From MW_Tasks - Begin', SYSDATE); 
  COMMIT;
  FOR RECS IN 
    (
        with ht as
        ( 
          select mw.task_id, 
               MW.task_type_id,
                trunc(MW.COMPLETE_DATE) as D_DATE,
				(MW.COMPLETE_DATE - COALESCE(MW.CURR_CLAIM_DATE,MW.CREATE_DATE)) as Handle_Time
          from D_MW_TASK_INSTANCE_SV MW
             where trunc(MW.COMPLETE_DATE) > trunc(sysdate - 500)
               and MW.CURR_CLAIM_DATE IS NOT NULL
               and MW.task_type_id in
                   (SELECT USR.SOURCE_REF_ID
                      FROM PP_CFG_UNIT_OF_WORK UOW
                     INNER JOIN PP_D_UOW_SOURCE_REF USR
                        ON UOW.CFG_UOW_ID = USR.UOW_ID
                       AND SYSDATE BETWEEN USR.EFFECTIVE_DATE AND USR.END_DATE
                     INNER JOIN PP_D_SOURCE_REF_TYPE SRT
                        ON USR.SOURCE_REF_TYPE_ID = SRT.SOURCE_REF_TYPE_ID
                       AND SRT.SOURCE_REF_TYPE_NAME = 'TASK TYPE'
                     INNER JOIN PP_D_SOURCE S
                        ON SRT.SOURCE_ID = S.SOURCE_ID
                       AND S.SOURCE_NAME = 'MANAGE WORK STG'
                     WHERE UOW.HOURLY_FLAG = 'N')
       )
        select 
               distinct ht.D_DATE,  
               usr.uow_id,
               AVG(Handle_Time) over (partition by D_DATE, uow_id) as avg_handle_time, 
               MIN(Handle_Time) over (partition by D_DATE, uow_id) as min_handle_time,
               STDDEV(Handle_Time) over (partition by D_DATE, uow_id) as stdev_handle_time,
               MEDIAN(Handle_Time) over (partition by D_DATE, uow_id) as median_handle_time,
               MAX(Handle_Time) over (partition by D_DATE, uow_id) as max_handle_time,
               (SUM(Handle_Time) over (partition by D_DATE, uow_id)*24) as staff_hours, --Handle Times are in days and staff hours are converted to hours
               SUM(Handle_Time) over (partition by D_DATE, uow_id) as sum_ht,
               count(1) over (partition by D_DATE, uow_id) as count_ht
          from ht
          join pp_d_uow_source_ref usr
           on ht.task_type_id = usr.source_ref_id
           and usr.source_ref_detail_identifier='TASK ID' and 
           SYSDATE BETWEEN USR.EFFECTIVE_DATE AND USR.END_DATE

) 
    LOOP
              
              
              UPDATE PP_F_ACTUALS 
                 SET actl_handle_time_avg=RECS.avg_handle_time,
                     actl_handle_time_min=RECS.min_handle_time,
                     actl_handle_time_max=RECS.max_handle_time,
                     actl_handle_time_mean=RECS.avg_handle_time,
                     actl_handle_time_median=RECS.median_handle_time,
                     actl_handle_time_sd=RECS.stdev_handle_time,
                     actl_staff_hours=RECS.staff_hours
               WHERE d_date=RECS.d_date and uow_id=RECS.uow_id;
               

  END LOOP;
  INSERT INTO PP_STG_LOG
      (PP_STG_ID, LOG_TYPE, PROCESS_DATE, PROCESS, DESCRIPTION, CREATE_DATE)
      VALUES (SEQ_PP_STG_ID.NEXTVAL,'LOG',SYSDATE,'PP_Actuals_Process_v3','Avg Handle Times and Staff Hours From MW_Tasks - Processed', SYSDATE); 
  COMMIT;


EXCEPTION
WHEN OTHERS 
  THEN 
    ROLLBACK;
    V_ERRCODE := SQLCODE;
    V_ERRMSG := SUBSTR(SQLERRM, 1, 3000);                 
    INSERT INTO PP_STG_LOG
      (PP_STG_ID, LOG_TYPE, PROCESS_DATE, PROCESS, DESCRIPTION, CREATE_DATE)
      VALUES (SEQ_PP_STG_ID.NEXTVAL,'ERR',SYSDATE,'PP_Actuals_Process_v3','Avg Handle Times and Staff Hours From MW_Tasks - Processed - ' || V_ERRCODE || ' : ' || V_ERRMSG,SYSDATE); 
      COMMIT; 
    RAISE;
END;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>T</sendOneStatement>
      <connection>MAXDAT</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>691</xloc>
      <yloc>1229</yloc>
      <attributes_kjc/>
    </entry>
  </entries>
  <hops>
    <hop>
      <from>START</from>
      <to>Check Db connections</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>Y</unconditional>
    </hop>
    <hop>
      <from>Check Db connections</from>
      <to>Set Log Vars</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>N</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Set Log Vars</from>
      <to>Write Log</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Check Db connections</from>
      <to>Set Log Vars 23</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>Y</unconditional>
    </hop>
    <hop>
      <from>Set Log Vars 23</from>
      <to>Write Log 14</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>Y</unconditional>
    </hop>
    <hop>
      <from>Write Log 14</from>
      <to>MW Arrivals</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>MW Arrivals</from>
      <to>MW Completions</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>MW Completions</from>
      <to>MW Inventory Jeopardy</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>MW Inventory Jeopardy</from>
      <to>MW Inventory Min,Max, etc</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>MW Inventory Min,Max, etc</from>
      <to>MW Zero HandleTime and Staff</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>MW Zero HandleTime and Staff</from>
      <to>MW Inventory Avg Age</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>MW Actual Details Arrivals</from>
      <to>MW Actual Details Completions</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Actuals Backfill Missing Days</from>
      <to>Success</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>MW Arrivals</from>
      <to>Abort job 2</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>N</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>MW Completions</from>
      <to>Abort job 2</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>N</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>MW Inventory Jeopardy</from>
      <to>Abort job 2</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>N</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>MW Inventory Min,Max, etc</from>
      <to>Abort job 2</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>N</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>MW Zero HandleTime and Staff</from>
      <to>Abort job 2</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>N</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>MW Inventory Avg Age</from>
      <to>Abort job 2</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>N</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>MW Actual Details Arrivals</from>
      <to>Abort job 2</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>N</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>MW Actual Details Completions</from>
      <to>Abort job 2</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>N</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Actuals Backfill Missing Days</from>
      <to>Abort job 2</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>N</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>MW Actual Details Completions</from>
      <to>Actuals Backfill Missing Days</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Write Log</from>
      <to>Abort job 2</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>N</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>MW Inventory Avg Age</from>
      <to>Avg Handle Times and Staff Hours From MW_Tasks</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Avg Handle Times and Staff Hours From MW_Tasks</from>
      <to>MW Actual Details Arrivals</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Avg Handle Times and Staff Hours From MW_Tasks</from>
      <to>Abort job 2</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>N</evaluation>
      <unconditional>N</unconditional>
    </hop>
  </hops>
  <notepads>
  </notepads>
  <attributes/>
</job>
