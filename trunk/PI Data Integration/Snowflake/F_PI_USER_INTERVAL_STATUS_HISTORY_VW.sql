CREATE OR REPLACE VIEW F_PI_USER_INTERVAL_STATUS_HISTORY_VW AS 
SELECT CAST(USIH.PROJECTID AS varchar) AS PROJECTID,
	CAST(USIH.PROJECTNAME AS varchar) AS PROJECTNAME,
	CAST(USIH.PROGRAMID AS varchar) AS PROGRAMID,
	CAST(USIH.PROGRAMNAME AS varchar) AS PROGRAMNAME,
	CAST(INTERVALSTARTTIME AS varchar) AS INTERVALSTARTTIME,
	convert_timezone('UTC',pr.projectTimezone,cast (INTERVALSTARTTIME as DATETIME)) as projectINTERVALSTARTTIME,
to_date(convert_timezone('UTC',pr.projectTimezone,cast (INTERVALSTARTTIME as DATETIME))) as projectINTERVALSTARTDate,
	CAST(USERNAME AS varchar) AS USERNAME ,		
CAST(USERID AS varchar) AS USERID,
	CAST(OFFLINEDURATION AS varchar) AS OFFLINEDURATION,
	CAST(AVAILABLEDURATION AS varchar) AS AVAILABLEDURATION ,
	CAST(ONQUEUEDURATION AS varchar) AS ONQUEUEDURATION,
	CAST(AWAYDURATION AS varchar) AS AWAYDURATION,
	CAST(BUSYDURATION AS varchar) AS BUSYDURATION ,
	CAST(MEALDURATION AS varchar) AS MEALDURATION,
	CAST(MEETINGDURATION AS varchar) AS MEETINGDURATION,
	CAST(TRAININGDURATION AS varchar) AS TRAININGDURATION,
	CAST(BREAKDURATION AS varchar) AS BREAKDURATION ,
	CAST(IDLEDURATION AS varchar) AS IDLEDURATION,
	CAST(NOTANSWERINGDURATION AS varchar) AS NOTANSWERINGDURATION,
	CAST(INTERACTINGDURATION AS varchar) AS INTERACTINGDURATION,
	CAST(SYSTEMAWAYDURATION AS varchar) AS SYSTEMAWAYDURATION	
FROM
	RAW.USER_STATUS_INTERVAL_HISTORY USIH
INNER JOIN PUBLIC.D_PI_PROJECTS pr
ON
	USIH.projectId = pr.projectId;