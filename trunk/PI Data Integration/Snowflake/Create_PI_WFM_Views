USE DATABASE PUREINSIGHTS_UAT;
USE SCHEMA PUBLIC;

CREATE OR REPLACE VIEW F_PI_WFM_FORECAST_DATA_VW AS
SELECT FD.FORECASTID, 
FD.WEEKDATE, 
FD.BUSINESSUNITNAME, 
FD.BUSINESSUNITID, 
FD.INTERVALSTARTTIME, 
FD.LOCALDATE, 
FD.PLANNINGGROUPID, 
FD.PLANNINGGROUPNAME, 
FD.INTERVALSTART12HOURFORMAT, 
FD.INTERVALSTART24HOURFORMAT, 
FD.INTERVALSTARTDAYINDEX, 
FD.FORECASTOFFERED, 
FD.FORECASTAVERAGEHANDLETIMEDURATION, 
FD.ACTUALOFFERED, 
FD.ACTUALTOTALHANDLETIMEDURATION, 
FD.ACTUALTOTALHANDLECOUNT, 
FD.PROJECTID, 
FD.PROJECTNAME, 
FD.PROGRAMID, 
FD.PROGRAMNAME,
FD.MEDIATYPE, 
FD.DIRECTION, 
FD.QUEUENAME,
FD.SKILLNAME, 
FD.LANGUAGENAME 
FROM RAW.wfm_forecast_data FD  
join PUBLIC.D_PI_PROJECTS pr
on FD.projectId = pr.projectId;
 --911756
;
CREATE OR REPLACE VIEW D_PI_wfm_management_unit_shrinkage_configuration_VW AS
SELECT MUSC.MANAGEMENTUNITNAME, 
MUSC.MANAGEMENTUNITID, 
MUSC.DAYOFWEEK, 
MUSC.INTERVALSTART12HOURFORMAT, 
MUSC.INTERVALSTART24HOURFORMAT, 
MUSC.INTERVALSTARTDAYINDEX, 
MUSC.SHRINKAGEPERCENT, 
MUSC.PROJECTID, 
MUSC.PROJECTNAME, 
MUSC.PROGRAMID, 
MUSC.PROGRAMNAME
 FROM RAW.wfm_management_unit_shrinkage_configuration MUSC
join PUBLIC.D_PI_PROJECTS pr
on MUSC.projectId = pr.projectId; -- 2688

CREATE OR REPLACE VIEW D_PI_wfm_planning_group_route_path_configuration_VW AS
SELECT PGRPC.PLANNINGGROUPID,
PGRPC.PLANNINGGROUPNAME, 
PGRPC.BUSINESSUNITID, 
PGRPC.BUSINESSUNITNAME, 
PGRPC.ROUTEPATHINDEX, 
PGRPC.QUEUENAME, 
PGRPC.MEDIATYPE, 
PGRPC.LANGUAGENAME, 
PGRPC.PROJECTID, 
PGRPC.PROJECTNAME, 
PGRPC.PROGRAMID, 
PGRPC.PROGRAMNAME
FROM RAW.wfm_planning_group_route_path_configuration PGRPC
join PUBLIC.D_PI_PROJECTS pr
on PGRPC.projectId = pr.projectId; --39

CREATE OR REPLACE VIEW D_PI_wfm_planning_group_route_path_skill_configuration_VW AS
SELECT PGRPSC.PLANNINGGROUPID, 
PGRPSC.PLANNINGGROUPNAME, 
PGRPSC.ROUTEPATHINDEX, 
PGRPSC.SKILLID, 
PGRPSC.SKILLNAME, 
PGRPSC.PROJECTID, 
PGRPSC.PROJECTNAME, 
PGRPSC.PROGRAMID, 
PGRPSC.PROGRAMNAME
FROM RAW.wfm_planning_group_route_path_skill_configuration PGRPSC
join PUBLIC.D_PI_PROJECTS pr
on PGRPSC.projectId = pr.projectId; -- 39

CREATE OR REPLACE VIEW D_PI_wfm_forecasts_VW AS
SELECT FC.BUSINESSUNITNAME, 
FC.BUSINESSUNITID, 
FC.WEEKDATE, 
FC.FORECASTID, 
FC.WEEKCOUNT, 
FC.CREATIONMETHOD, 
FC.DESCRIPTION, 
FC.LASTMODIFIEDBY, 
FC.LASTMODIFIEDTIME, 
FC.CANUSEFORSCHEDULING, 
FC.PROJECTID, 
FC.PROJECTNAME, 
FC.PROGRAMID, 
FC.PROGRAMNAME
 FROM RAW.wfm_forecasts FC
join PUBLIC.D_PI_PROJECTS pr
on FC.projectId = pr.projectId; -- 9

CREATE OR REPLACE VIEW F_PI_wfm_forecast_generation_results_VW AS
SELECT FGR.FORECASTID, 
FGR.WEEKDATE, 
FGR.BUSINESSUNITNAME, 
FGR.BUSINESSUNITID, 
FGR.PLANNINGGROUPID, 
FGR.PLANNINGGROUPNAME, 
FGR.METRIC, 
FGR.FORECASTINGMETHOD, 
FGR.FORECASTTYPE, 
FGR.PROJECTID, 
FGR.PROJECTNAME, 
FGR.PROGRAMID, 
FGR.PROGRAMNAME
 FROM RAW.wfm_forecast_generation_results FGR
join PUBLIC.D_PI_PROJECTS pr
on FGR.projectId = pr.projectId;

CREATE OR REPLACE VIEW D_PI_wfm_planning_group_configuration_VW AS
SELECT pgc.ID, 
pgc."NAME", 
pgc.LASTMODIFIEDTIME,
pgc.BUSINESSUNITID, 
pgc.BUSINESSUNITNAME, 
pgc.PROJECTID, 
pgc.PROJECTNAME, 
pgc.PROGRAMID, 
pgc.PROGRAMNAME 
FROM RAW.wfm_planning_group_configuration pgc
join PUBLIC.D_PI_PROJECTS pr
on pgc.projectId = pr.projectId;

CREATE OR REPLACE VIEW F_PI_wfm_schedule_activity_summary_VW AS
SELECT sas.SCHEDULEID, 
sas.SCHEDULEWEEK, 
sas.INTERVALSTARTTIME, 
sas.LOCALDATE, 
sas.BUSINESSUNITID, 
sas.BUSINESSUNITNAME, 
sas.MANAGEMENTUNITID, 
sas.MANAGEMENTUNITNAME, 
sas.INTERVALSTART12HOURFORMAT, 
sas.INTERVALSTART24HOURFORMAT, 
sas.INTERVALSTARTDAYINDEX, 
sas.ONQUEUE, 
sas.BREAK, 
sas.MEAL, 
sas.TIMEOFF, 
sas.TRAINING, 
sas.OFFQUEUE, 
sas.UNAVAILABLE, 
sas.MEETING, 
sas.PROJECTID, 
sas.PROJECTNAME, 
sas.PROGRAMID, 
sas.PROGRAMNAME
 FROM RAW.wfm_schedule_activity_summary sas
join PUBLIC.D_PI_PROJECTS pr
on sas.projectId = pr.projectId;

CREATE OR REPLACE VIEW F_PI_wfm_schedule_forecast_summary_VW AS
SELECT sfs.SCHEDULEID, 
sfs.SCHEDULEWEEK, 
sfs.BUSINESSUNITID, 
sfs.BUSINESSUNITNAME, 
sfs.INTERVALSTARTTIME, 
sfs.LOCALDATE, 
sfs.PLANNINGGROUPID, 
sfs.PLANNINGGROUPNAME, 
sfs.INTERVALSTART12HOURFORMAT, 
sfs.INTERVALSTART24HOURFORMAT, 
sfs.INTERVALSTARTDAYINDEX, 
sfs.FORECAST, 
sfs.FORECASTWITHSHRINKAGE, 
sfs.PROJECTID, 
sfs.PROJECTNAME, 
sfs.PROGRAMID, 
sfs.PROGRAMNAME
FROM RAW.wfm_schedule_forecast_summary sfs
join PUBLIC.D_PI_PROJECTS pr
on sfs.projectId = pr.projectId;

CREATE OR REPLACE VIEW F_PI_wfm_schedule_onqueue_summary_VW AS
SELECT sos.SCHEDULEID, 
sos.SCHEDULEWEEK, 
sos.INTERVALSTARTTIME, 
sos.LOCALDATE, 
sos.BUSINESSUNITID, 
sos.BUSINESSUNITNAME, 
sos.MANAGEMENTUNITID, 
sos.MANAGEMENTUNITNAME, 
sos.INTERVALSTART12HOURFORMAT, 
sos.INTERVALSTART24HOURFORMAT, 
sos.INTERVALSTARTDAYINDEX, 
sos.AGENTSSCHEDULED, 
sos.PROJECTID, 
sos.PROJECTNAME, 
sos.PROGRAMID, 
sos.PROGRAMNAME
FROM RAW.wfm_schedule_onqueue_summary sos
join PUBLIC.D_PI_PROJECTS pr
on sos.projectId = pr.projectId;

CREATE OR REPLACE VIEW F_PI_wfm_intraday_VW AS
SELECT sos.BUSINESSUNITID, 
sos.LOCALDATE, 
sos.PLANNINGGROUPID, 
sos.PLANNINGGROUPNAME, 
sos.SCHEDULEID, 
sos.SCHEDULEWEEK, 
sos.MEDIATYPE, 
sos.SHORTTERMFORECASTID, 
sos.INTERVALSTARTTIME, 
sos.INTERVALSTART12HOURFORMAT, 
sos.INTERVALSTART24HOURFORMAT, 
sos.INTERVALSTARTDAYINDEX, 
sos.SERVICELEVELPREDICTED, 
sos.SERVICELEVELNUMERATOR, 
sos.SERVICELEVELDENOMINATOR, 
sos.SERVICELEVELACTUAL, 
sos.OFFEREDPREDICTED, 
sos.OFFEREDACTUAL, 
sos.ANSWEREDACTUAL, 
sos.ABANDONEDACTUAL, 
sos.AGENTSSCHEDULED, 
sos.AGENTSACTUAL, 
sos.AVERAGEHANDLETIMEPREDICTEDDURATION, 
sos.AVERAGEANSWERTIMEPREDICTEDDURATION, 
sos.OCCUPANCYPREDICTED, 
sos.OCCUPANCYACTUALNUMERATOR, 
sos.OCCUPANCYACTUAL, 
sos.COMPLETEDCOUNT, 
sos.TOTALHANDLED, 
sos.TOTALHANDLETIMEACTUALDURATION, 
sos.TOTALANSWERTIMEACTUALDURATION, 
sos.PROJECTID, 
sos.PROJECTNAME, 
sos.PROGRAMID, 
sos.PROGRAMNAME, 
sos.BUSINESSUNITNAME, 
sos.OCCUPANCYACTUALDENOMINATOR
FROM RAW.wfm_intraday sos
join PUBLIC.D_PI_PROJECTS pr
on sos.projectId = pr.projectId;





USE DATABASE DECISIONPOINT_UAT;
USE SCHEMA PUREINSIGHTS;

CREATE OR REPLACE VIEW F_PI_WFM_FORECAST_DATA_VW AS
SELECT FD.FORECASTID, 
FD.WEEKDATE, 
FD.BUSINESSUNITNAME, 
FD.BUSINESSUNITID, 
FD.INTERVALSTARTTIME, 
FD.LOCALDATE, 
FD.PLANNINGGROUPID, 
FD.PLANNINGGROUPNAME, 
FD.INTERVALSTART12HOURFORMAT, 
FD.INTERVALSTART24HOURFORMAT, 
FD.INTERVALSTARTDAYINDEX, 
FD.FORECASTOFFERED, 
FD.FORECASTAVERAGEHANDLETIMEDURATION, 
FD.ACTUALOFFERED, 
FD.ACTUALTOTALHANDLETIMEDURATION, 
FD.ACTUALTOTALHANDLECOUNT, 
FD.PROJECTID, 
FD.PROJECTNAME, 
FD.PROGRAMID, 
FD.PROGRAMNAME,
FD.MEDIATYPE, 
FD.DIRECTION, 
FD.QUEUENAME,
FD.SKILLNAME, 
FD.LANGUAGENAME 
FROM PUREINSIGHTS_UAT.RAW.wfm_forecast_data FD  
join PUREINSIGHTS_UAT.PUBLIC.D_PI_PROJECTS pr
on FD.projectId = pr.projectId;
 --911756
;
CREATE OR REPLACE VIEW D_PI_wfm_management_unit_shrinkage_configuration_VW AS
SELECT MUSC.MANAGEMENTUNITNAME, 
MUSC.MANAGEMENTUNITID, 
MUSC.DAYOFWEEK, 
MUSC.INTERVALSTART12HOURFORMAT, 
MUSC.INTERVALSTART24HOURFORMAT, 
MUSC.INTERVALSTARTDAYINDEX, 
MUSC.SHRINKAGEPERCENT, 
MUSC.PROJECTID, 
MUSC.PROJECTNAME, 
MUSC.PROGRAMID, 
MUSC.PROGRAMNAME
 FROM PUREINSIGHTS_UAT.RAW.wfm_management_unit_shrinkage_configuration MUSC
join PUREINSIGHTS_UAT.PUBLIC.D_PI_PROJECTS pr
on MUSC.projectId = pr.projectId; -- 2688

CREATE OR REPLACE VIEW D_PI_wfm_planning_group_route_path_configuration_VW AS
SELECT PGRPC.PLANNINGGROUPID,
PGRPC.PLANNINGGROUPNAME, 
PGRPC.BUSINESSUNITID, 
PGRPC.BUSINESSUNITNAME, 
PGRPC.ROUTEPATHINDEX, 
PGRPC.QUEUENAME, 
PGRPC.MEDIATYPE, 
PGRPC.LANGUAGENAME, 
PGRPC.PROJECTID, 
PGRPC.PROJECTNAME, 
PGRPC.PROGRAMID, 
PGRPC.PROGRAMNAME
FROM PUREINSIGHTS_UAT.RAW.wfm_planning_group_route_path_configuration PGRPC
join PUREINSIGHTS_UAT.PUBLIC.D_PI_PROJECTS pr
on PGRPC.projectId = pr.projectId; --39

CREATE OR REPLACE VIEW D_PI_wfm_planning_group_route_path_skill_configuration_VW AS
SELECT PGRPSC.PLANNINGGROUPID, 
PGRPSC.PLANNINGGROUPNAME, 
PGRPSC.ROUTEPATHINDEX, 
PGRPSC.SKILLID, 
PGRPSC.SKILLNAME, 
PGRPSC.PROJECTID, 
PGRPSC.PROJECTNAME, 
PGRPSC.PROGRAMID, 
PGRPSC.PROGRAMNAME
FROM PUREINSIGHTS_UAT.RAW.wfm_planning_group_route_path_skill_configuration PGRPSC
join PUREINSIGHTS_UAT.PUBLIC.D_PI_PROJECTS pr
on PGRPSC.projectId = pr.projectId; -- 39

CREATE OR REPLACE VIEW D_PI_wfm_forecasts_VW AS
SELECT FC.BUSINESSUNITNAME, 
FC.BUSINESSUNITID, 
FC.WEEKDATE, 
FC.FORECASTID, 
FC.WEEKCOUNT, 
FC.CREATIONMETHOD, 
FC.DESCRIPTION, 
FC.LASTMODIFIEDBY, 
FC.LASTMODIFIEDTIME, 
FC.CANUSEFORSCHEDULING, 
FC.PROJECTID, 
FC.PROJECTNAME, 
FC.PROGRAMID, 
FC.PROGRAMNAME
 FROM PUREINSIGHTS_UAT.RAW.wfm_forecasts FC
join PUREINSIGHTS_UAT.PUBLIC.D_PI_PROJECTS pr
on FC.projectId = pr.projectId; -- 9

CREATE OR REPLACE VIEW F_PI_wfm_forecast_generation_results_VW AS
SELECT FGR.FORECASTID, 
FGR.WEEKDATE, 
FGR.BUSINESSUNITNAME, 
FGR.BUSINESSUNITID, 
FGR.PLANNINGGROUPID, 
FGR.PLANNINGGROUPNAME, 
FGR.METRIC, 
FGR.FORECASTINGMETHOD, 
FGR.FORECASTTYPE, 
FGR.PROJECTID, 
FGR.PROJECTNAME, 
FGR.PROGRAMID, 
FGR.PROGRAMNAME
 FROM PUREINSIGHTS_UAT.RAW.wfm_forecast_generation_results FGR
join PUREINSIGHTS_UAT.PUBLIC.D_PI_PROJECTS pr
on FGR.projectId = pr.projectId;

CREATE OR REPLACE VIEW D_PI_wfm_planning_group_configuration_VW AS
SELECT pgc.ID, 
pgc."NAME", 
pgc.LASTMODIFIEDTIME,
pgc.BUSINESSUNITID, 
pgc.BUSINESSUNITNAME, 
pgc.PROJECTID, 
pgc.PROJECTNAME, 
pgc.PROGRAMID, 
pgc.PROGRAMNAME 
FROM PUREINSIGHTS_UAT.RAW.wfm_planning_group_configuration pgc
join PUREINSIGHTS_UAT.PUBLIC.D_PI_PROJECTS pr
on pgc.projectId = pr.projectId;

CREATE OR REPLACE VIEW F_PI_wfm_schedule_activity_summary_VW AS
SELECT sas.SCHEDULEID, 
sas.SCHEDULEWEEK, 
sas.INTERVALSTARTTIME, 
sas.LOCALDATE, 
sas.BUSINESSUNITID, 
sas.BUSINESSUNITNAME, 
sas.MANAGEMENTUNITID, 
sas.MANAGEMENTUNITNAME, 
sas.INTERVALSTART12HOURFORMAT, 
sas.INTERVALSTART24HOURFORMAT, 
sas.INTERVALSTARTDAYINDEX, 
sas.ONQUEUE, 
sas.BREAK, 
sas.MEAL, 
sas.TIMEOFF, 
sas.TRAINING, 
sas.OFFQUEUE, 
sas.UNAVAILABLE, 
sas.MEETING, 
sas.PROJECTID, 
sas.PROJECTNAME, 
sas.PROGRAMID, 
sas.PROGRAMNAME
 FROM PUREINSIGHTS_UAT.RAW.wfm_schedule_activity_summary sas
join PUREINSIGHTS_UAT.PUBLIC.D_PI_PROJECTS pr
on sas.projectId = pr.projectId;

CREATE OR REPLACE VIEW F_PI_wfm_schedule_forecast_summary_VW AS
SELECT sfs.SCHEDULEID, 
sfs.SCHEDULEWEEK, 
sfs.BUSINESSUNITID, 
sfs.BUSINESSUNITNAME, 
sfs.INTERVALSTARTTIME, 
sfs.LOCALDATE, 
sfs.PLANNINGGROUPID, 
sfs.PLANNINGGROUPNAME, 
sfs.INTERVALSTART12HOURFORMAT, 
sfs.INTERVALSTART24HOURFORMAT, 
sfs.INTERVALSTARTDAYINDEX, 
sfs.FORECAST, 
sfs.FORECASTWITHSHRINKAGE, 
sfs.PROJECTID, 
sfs.PROJECTNAME, 
sfs.PROGRAMID, 
sfs.PROGRAMNAME
FROM PUREINSIGHTS_UAT.RAW.wfm_schedule_forecast_summary sfs
join PUREINSIGHTS_UAT.PUBLIC.D_PI_PROJECTS pr
on sfs.projectId = pr.projectId;

CREATE OR REPLACE VIEW F_PI_wfm_schedule_onqueue_summary_VW AS
SELECT sos.SCHEDULEID, 
sos.SCHEDULEWEEK, 
sos.INTERVALSTARTTIME, 
sos.LOCALDATE, 
sos.BUSINESSUNITID, 
sos.BUSINESSUNITNAME, 
sos.MANAGEMENTUNITID, 
sos.MANAGEMENTUNITNAME, 
sos.INTERVALSTART12HOURFORMAT, 
sos.INTERVALSTART24HOURFORMAT, 
sos.INTERVALSTARTDAYINDEX, 
sos.AGENTSSCHEDULED, 
sos.PROJECTID, 
sos.PROJECTNAME, 
sos.PROGRAMID, 
sos.PROGRAMNAME
FROM PUREINSIGHTS_UAT.RAW.wfm_schedule_onqueue_summary sos
join PUREINSIGHTS_UAT.PUBLIC.D_PI_PROJECTS pr
on sos.projectId = pr.projectId;

CREATE OR REPLACE VIEW F_PI_wfm_intraday_VW AS
SELECT sos.BUSINESSUNITID, 
sos.LOCALDATE, 
sos.PLANNINGGROUPID, 
sos.PLANNINGGROUPNAME, 
sos.SCHEDULEID, 
sos.SCHEDULEWEEK, 
sos.MEDIATYPE, 
sos.SHORTTERMFORECASTID, 
sos.INTERVALSTARTTIME, 
sos.INTERVALSTART12HOURFORMAT, 
sos.INTERVALSTART24HOURFORMAT, 
sos.INTERVALSTARTDAYINDEX, 
sos.SERVICELEVELPREDICTED, 
sos.SERVICELEVELNUMERATOR, 
sos.SERVICELEVELDENOMINATOR, 
sos.SERVICELEVELACTUAL, 
sos.OFFEREDPREDICTED, 
sos.OFFEREDACTUAL, 
sos.ANSWEREDACTUAL, 
sos.ABANDONEDACTUAL, 
sos.AGENTSSCHEDULED, 
sos.AGENTSACTUAL, 
sos.AVERAGEHANDLETIMEPREDICTEDDURATION, 
sos.AVERAGEANSWERTIMEPREDICTEDDURATION, 
sos.OCCUPANCYPREDICTED, 
sos.OCCUPANCYACTUALNUMERATOR, 
sos.OCCUPANCYACTUAL, 
sos.COMPLETEDCOUNT, 
sos.TOTALHANDLED, 
sos.TOTALHANDLETIMEACTUALDURATION, 
sos.TOTALANSWERTIMEACTUALDURATION, 
sos.PROJECTID, 
sos.PROJECTNAME, 
sos.PROGRAMID, 
sos.PROGRAMNAME, 
sos.BUSINESSUNITNAME, 
sos.OCCUPANCYACTUALDENOMINATOR
FROM PUREINSIGHTS_UAT.RAW.wfm_intraday sos
join PUREINSIGHTS_UAT.PUBLIC.D_PI_PROJECTS pr
on sos.projectId = pr.projectId;