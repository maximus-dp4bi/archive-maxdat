CREATE TABLE PP_STG_EVENTS
(
PSE_ID NUMBER NOT NULL,
D_DATE DATE  NOT NULL,
UOW_ID NUMBER  NOT NULL,
EVENTS VARCHAR2(4000),
EVENT_IDS VARCHAR2(4000),
IS_PROCESSED CHAR(1) DEFAULT 'N' NOT NULL,
PP_CREATE_DATE DATE DEFAULT sysdate  NOT NULL , 
PP_LAST_UPDATE_DATE DATE DEFAULT sysdate  NOT NULL 
);

ALTER TABLE PP_STG_EVENTS 
    ADD CONSTRAINT PP_STG_EVENTS_PK PRIMARY KEY ( PSE_ID ) ;
ALTER TABLE PP_STG_EVENTS 
    ADD CONSTRAINT PP_STG_EVENTS__UN UNIQUE ( D_DATE , UOW_ID ) ;

CREATE SEQUENCE SEQ_PP_PSE_ID
MINVALUE 1
MAXVALUE 999999999999999999999999999
START WITH 1
INCREMENT BY 1
CACHE 20;

create or replace trigger TRG_BIU_PP_STG_EVENTS
before insert or update on PP_STG_EVENTS 
for each row 
begin 
  if inserting then 
    if :new.PSE_ID is null then
      :new.PSE_ID := SEQ_PP_PSE_ID.nextval;
    end if;
  end if;
  :new.PP_LAST_UPDATE_DATE := sysdate;
end;
/