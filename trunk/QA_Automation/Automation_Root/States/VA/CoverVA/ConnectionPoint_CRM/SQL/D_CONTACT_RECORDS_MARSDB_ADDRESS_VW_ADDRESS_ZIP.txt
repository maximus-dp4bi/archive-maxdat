select ADDRESS_ZIP
     FROM (SELECT  AD.CONTACT_TYPE_ID
                ,AD.PROJECT_ID
                ,AD.ADDRESS_VERIFIED
                ,AD.ADDRESS_HOUSE_CODE
                ,AD.ADDRESS_STREET_1
                ,AD.ADDRESS_STREET_2
                ,AD.ADDRESS_ZIP
                ,AD.ADDRESS_ZIP_FOUR
                ,AD.ADDRESS_TYPE
                ,AD.ADDRESS_CITY
                ,AD.ADDRESS_STATE
                ,AD.ADDRESS_COUNTY
                ,AD.PRIMARY_INDICATOR
                ,CNO.EXTERNAL_REF_ID
                ,CNO.EXTERNAL_REF_TYPE                
                ,RANK() OVER (PARTITION BY CNO.EXTERNAL_REF_ID, CT.PROJECT_ID ORDER BY DECODE(PRIMARY_INDICATOR,1,1,DECODE(UPPER(ADDRESS_TYPE),'PHYSICAL',2,3)),AD.EFFECTIVE_END_DATE DESC NULLS FIRST,AD.ADDRESS_ID) arnk
          FROM  MARS_DP4BI_DEV.MARSDB.MARSDB_CONTACTS_OWNER_VW CNO
            LEFT JOIN MARS_DP4BI_DEV.MARSDB.MARSDB_CONTACTS_VW CT ON CNO.CONTACT_OWNER_ID = CT.OWNER_ID AND CT.PROJECT_ID = CNO.PROJECT_ID AND CT.CONTACT_TYPE = 'ADDRESS'
            LEFT JOIN  MARS_DP4BI_DEV.MARSDB.MARSDB_ADDRESS_VW AD  ON AD.CONTACT_TYPE_ID = CT.CONTACT_TYPE_ID AND AD.PROJECT_ID = CT.PROJECT_ID
          WHERE UPPER(CNO.EXTERNAL_REF_TYPE) = 'CONSUMER'          
          )
      WHERE arnk = 1
        AND PROJECT_ID = '419'
        AND EXTERNAL_REF_ID = '121136';