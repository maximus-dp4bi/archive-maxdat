select	distinct coalesce(pa11.D_DATE, pa12.D_DATE)  D_DATE,
	 a13.D_YEAR||a13.D_MONTH_NUM  D_MONTH,
	a13.D_MONTH_NAME  D_MONTH_NAME,
	coalesce(pa11.WEEKEND_FLAG, pa12.WEEKEND_FLAG)  WEEKEND_FLAG,
	coalesce(pa11.INTERVAL_START_DATE, pa12.INTERVAL_START_DATE)  INTERVAL_START_DATE,
	coalesce(pa11.PROJECT_NAME, pa12.PROJECT_NAME)  PROJECT_NAME,
	coalesce(pa11.PROGRAM_ID, pa12.PROGRAM_ID)  PROGRAM_ID,
	a14.PROGRAM_NAME  PROGRAM_NAME,
	coalesce(pa11.QUEUE_TYPE, pa12.QUEUE_TYPE)  QUEUE_TYPE,
	coalesce(pa11.QUEUE_NAME, pa12.QUEUE_NAME)  QUEUE_NAME,
    pa11.WJXBFS1  CONTACTS_ABANDONED,
	pa11.WJXBFS2  CONTACTS_HANDLED,
	pa11.WJXBFS3  MAX_SPEED_OF_ANSWER,
	pa12.WJXBFS1  SERVICE_LEVEL_ABANDONED,
	pa11.WJXBFS5  CONTACTS_OFFERED,
	pa11.WJXBFS6  OUTFLOW_CONTACTS,
	pa11.WJXBFS7  ERROR_COUNT,
	pa11.WJXBFS8  ABANDON_TIME_TOTAL,
	pa11.WJXBFS9  INCOMPLETE_CALLS,
	pa11.WJXBFSa  SHORT_CALLS,
	pa11.WJXBFSb  AGENT_ERROR_COUNT,
	pa11.WJXBFSc  CALLS_ROUTED_NON_AGENT,
	pa11.WJXBFSd  CALLS_RONA,
	pa11.WJXBFSe  RETURN_RELEASE,
	pa11.WJXBFSf  RETURN_BUSY,
	pa11.WJXBFS10  RETURN_RING,
	pa11.WJXBFS11  NETWORK_DEFAULT_ROUTED,
	pa11.WJXBFS12  ICR_DEFAULT_ROUTED,
	pa11.WJXBFS13  CALLS_GIVEN_ROUTE_TO,
	pa11.WJXBFS14  CALLS_GIVEN_FORCE_DISCONNECT,
	pa11.WJXBFS15  HOLD_TIME_TOTAL,
	pa11.WJXBFS16  ANSWER_WAIT_TIME_TOTAL,
	pa11.WJXBFS17  CONTACTS_TRANSFERRED,
	pa11.WJXBFS18  CALLS_ANSWERED,
	pa11.WJXBFS19  TALK_TIME_TOTAL,
	pa11.WJXBFS1a  AFTER_CALL_WORK_TIME_TOTAL
from	
(
select	a12.WEEKEND_FLAG  WEEKEND_FLAG,
	a13.QUEUE_NAME  QUEUE_NAME,
	a15.PROJECT_NAME  PROJECT_NAME,
	a11.D_PROGRAM_ID  PROGRAM_ID,
	trunc(a14.INTERVAL_START_DATE,'HH')  INTERVAL_START_DATE,
	a12.D_DATE  D_DATE,
	a13.QUEUE_TYPE  QUEUE_TYPE,
	sum(a11.CONTACTS_ABANDONED)  WJXBFS1,
	sum(a11.CONTACTS_HANDLED)  WJXBFS2,
	max(a11.MAX_SPEED_OF_ANSWER)  WJXBFS3,
	sum(a11.SERVICE_LEVEL_ABANDONED)  WJXBFS4,
	sum(a11.CONTACTS_OFFERED)  WJXBFS5,
	sum(a11.OUTFLOW_CONTACTS)  WJXBFS6,
	sum(a11.ERROR_COUNT)  WJXBFS7,
	sum(a11.ABANDON_TIME_TOTAL)  WJXBFS8,
	sum(a11.INCOMPLETE_CALLS)  WJXBFS9,
	sum(a11.SHORT_CALLS)  WJXBFSa,
	sum(a11.AGENT_ERROR_COUNT)  WJXBFSb,
	sum(a11.CALLS_ROUTED_NON_AGENT)  WJXBFSc,
	sum(a11.CALLS_RONA)  WJXBFSd,
	sum(a11.RETURN_RELEASE)  WJXBFSe,
	sum(a11.RETURN_BUSY)  WJXBFSf,
	sum(a11.RETURN_RING)  WJXBFS10,
	sum(a11.NETWORK_DEFAULT_ROUTED)  WJXBFS11,
	sum(a11.ICR_DEFAULT_ROUTED)  WJXBFS12,
	sum(a11.CALLS_GIVEN_ROUTE_TO)  WJXBFS13,
	sum(a11.CALLS_GIVEN_FORCE_DISCONNECT)  WJXBFS14,
	sum(a11.HOLD_TIME_TOTAL)  WJXBFS15,
	sum(a11.ANSWER_WAIT_TIME_TOTAL)  WJXBFS16,
	sum(a11.CONTACTS_TRANSFERRED)  WJXBFS17,
	sum(a11.CALLS_ANSWERED)  WJXBFS18,
	sum(a11.TALK_TIME_TOTAL)  WJXBFS19,
	sum(a11.AFTER_CALL_WORK_TIME_TOTAL)  WJXBFS1a
from	
(
SELECT CC_F_ACTUALS_QUEUE_INTERVAL.F_CALL_CENTER_ACTLS_INTRVL_ID,
    CC_F_ACTUALS_QUEUE_INTERVAL.D_DATE_ID,
    CC_D_CONTACT_QUEUE.D_PROJECT_ID,
    CC_D_CONTACT_QUEUE.D_PROGRAM_ID,
    CC_D_CONTACT_QUEUE.D_GEOGRAPHY_MASTER_ID,
    CC_D_CONTACT_QUEUE.D_UNIT_OF_WORK_ID,
    CC_F_ACTUALS_QUEUE_INTERVAL.D_CONTACT_QUEUE_ID,
    CC_F_ACTUALS_QUEUE_INTERVAL.D_INTERVAL_ID,
    CC_F_ACTUALS_QUEUE_INTERVAL.D_AGENT_ID,
    CC_F_ACTUALS_QUEUE_INTERVAL.CONTACTS_RECEIVED_FROM_IVR,
    CC_F_ACTUALS_QUEUE_INTERVAL.CALLS_ANSWERED,
    CC_F_ACTUALS_QUEUE_INTERVAL.CONTACTS_OFFERED,
    CC_F_ACTUALS_QUEUE_INTERVAL.CONTACTS_HANDLED,
    CC_F_ACTUALS_QUEUE_INTERVAL.CONTACTS_ABANDONED,
    CC_F_ACTUALS_QUEUE_INTERVAL.MIN_HANDLE_TIME,
    CC_F_ACTUALS_QUEUE_INTERVAL.MAX_HANDLE_TIME,
    CC_F_ACTUALS_QUEUE_INTERVAL.MEAN_HANDLE_TIME,
    CC_F_ACTUALS_QUEUE_INTERVAL.MEDIAN_HANDLE_TIME,
    CC_F_ACTUALS_QUEUE_INTERVAL.STDDEV_HANDLE_TIME,
    CC_F_ACTUALS_QUEUE_INTERVAL.MIN_SPEED_TO_HANDLE,
    CC_F_ACTUALS_QUEUE_INTERVAL.MAX_SPEED_TO_HANDLE,
    CC_F_ACTUALS_QUEUE_INTERVAL.MEAN_SPEED_TO_HANDLE,
    CC_F_ACTUALS_QUEUE_INTERVAL.MEDIAN_SPEED_TO_HANDLE,
    CC_F_ACTUALS_QUEUE_INTERVAL.STDDEV_SPEED_TO_HANDLE,
    CC_F_ACTUALS_QUEUE_INTERVAL.MIN_SPEED_OF_ANSWER,
    CC_F_ACTUALS_QUEUE_INTERVAL.MAX_SPEED_OF_ANSWER,
    CC_F_ACTUALS_QUEUE_INTERVAL.MEAN_SPEED_OF_ANSWER,
    CC_F_ACTUALS_QUEUE_INTERVAL.MEDIAN_SPEED_OF_ANSWER,
    CC_F_ACTUALS_QUEUE_INTERVAL.STDDEV_SPEED_OF_ANSWER,
    CC_F_ACTUALS_QUEUE_INTERVAL.SPEED_OF_ANSWER_PERIOD_1,
    CC_F_ACTUALS_QUEUE_INTERVAL.SPEED_OF_ANSWER_PERIOD_2,
    CC_F_ACTUALS_QUEUE_INTERVAL.SPEED_OF_ANSWER_PERIOD_3,
    CC_F_ACTUALS_QUEUE_INTERVAL.SPEED_OF_ANSWER_PERIOD_4,
    CC_F_ACTUALS_QUEUE_INTERVAL.SPEED_OF_ANSWER_PERIOD_5,
    CC_F_ACTUALS_QUEUE_INTERVAL.SPEED_OF_ANSWER_PERIOD_6,
    CC_F_ACTUALS_QUEUE_INTERVAL.SPEED_OF_ANSWER_PERIOD_7,
    CC_F_ACTUALS_QUEUE_INTERVAL.SPEED_OF_ANSWER_PERIOD_8,
    CC_F_ACTUALS_QUEUE_INTERVAL.SPEED_OF_ANSWER_PERIOD_9,
    CC_F_ACTUALS_QUEUE_INTERVAL.SPEED_OF_ANSWER_PERIOD_10,
    CC_F_ACTUALS_QUEUE_INTERVAL.CALLS_ABANDONED_PERIOD_1,
    CC_F_ACTUALS_QUEUE_INTERVAL.CALLS_ABANDONED_PERIOD_2,
    CC_F_ACTUALS_QUEUE_INTERVAL.CALLS_ABANDONED_PERIOD_3,
    CC_F_ACTUALS_QUEUE_INTERVAL.CALLS_ABANDONED_PERIOD_4,
    CC_F_ACTUALS_QUEUE_INTERVAL.CALLS_ABANDONED_PERIOD_5,
    CC_F_ACTUALS_QUEUE_INTERVAL.CALLS_ABANDONED_PERIOD_6,
    CC_F_ACTUALS_QUEUE_INTERVAL.CALLS_ABANDONED_PERIOD_7,
    CC_F_ACTUALS_QUEUE_INTERVAL.CALLS_ABANDONED_PERIOD_8,
    CC_F_ACTUALS_QUEUE_INTERVAL.CALLS_ABANDONED_PERIOD_9,
    CC_F_ACTUALS_QUEUE_INTERVAL.CALLS_ABANDONED_PERIOD_10,
    CC_F_ACTUALS_QUEUE_INTERVAL.LABOR_MINUTES_TOTAL,
    CC_F_ACTUALS_QUEUE_INTERVAL.LABOR_MINUTES_AVAILABLE,
    CC_F_ACTUALS_QUEUE_INTERVAL.LABOR_MINUTES_WAITING,
    CC_F_ACTUALS_QUEUE_INTERVAL.HEADCOUNT_TOTAL,
    CC_F_ACTUALS_QUEUE_INTERVAL.HEADCOUNT_AVAILABLE,
    CC_F_ACTUALS_QUEUE_INTERVAL.HEADCOUNT_UNAVAILABLE,
    CC_F_ACTUALS_QUEUE_INTERVAL.CONTACT_INVENTORY,
    CC_F_ACTUALS_QUEUE_INTERVAL.CONTACT_INVENTORY_JEOPARDY,
    CC_F_ACTUALS_QUEUE_INTERVAL.MIN_CONTACT_INVENTORY_AGE,
    CC_F_ACTUALS_QUEUE_INTERVAL.MAX_CONTACT_INVENTORY_AGE,
    CC_F_ACTUALS_QUEUE_INTERVAL.MEAN_CONTACT_INVENTORY_AGE,
    CC_F_ACTUALS_QUEUE_INTERVAL.MEDIAN_CONTACT_INVENTORY_AGE,
    CC_F_ACTUALS_QUEUE_INTERVAL.STDDEV_CONTACT_INVENTORY_AGE,
    CC_F_ACTUALS_QUEUE_INTERVAL.CONTACTS_TRANSFERRED,
    CC_F_ACTUALS_QUEUE_INTERVAL.OUTFLOW_CONTACTS,
    CC_F_ACTUALS_QUEUE_INTERVAL.ANSWER_WAIT_TIME_TOTAL,
    CC_F_ACTUALS_QUEUE_INTERVAL.ABANDON_TIME_TOTAL,
    CC_F_ACTUALS_QUEUE_INTERVAL.TALK_TIME_TOTAL,
    CC_F_ACTUALS_QUEUE_INTERVAL.AFTER_CALL_WORK_TIME_TOTAL,
    CC_F_ACTUALS_QUEUE_INTERVAL.SERVICE_LEVEL_ANSWERED_PERCENT,
    CC_F_ACTUALS_QUEUE_INTERVAL.SERVICE_LEVEL_ANSWERED_COUNT,
    CC_F_ACTUALS_QUEUE_INTERVAL.SERVICE_LEVEL_ABANDONED,
    CC_F_ACTUALS_QUEUE_INTERVAL.CALLS_ON_HOLD,
    CC_F_ACTUALS_QUEUE_INTERVAL.HOLD_TIME_TOTAL,
    CC_F_ACTUALS_QUEUE_INTERVAL.SHORT_ABANDONS,
    CC_F_ACTUALS_QUEUE_INTERVAL.CONTACTS_BLOCKED,
    CC_F_ACTUALS_QUEUE_INTERVAL.ICR_DEFAULT_ROUTED,
    CC_F_ACTUALS_QUEUE_INTERVAL.NETWORK_DEFAULT_ROUTED,
    CC_F_ACTUALS_QUEUE_INTERVAL.RETURN_BUSY,
    CC_F_ACTUALS_QUEUE_INTERVAL.CALLS_RONA,
    CC_F_ACTUALS_QUEUE_INTERVAL.RETURN_RELEASE,
    CC_F_ACTUALS_QUEUE_INTERVAL.CALLS_ROUTED_NON_AGENT,
    CC_F_ACTUALS_QUEUE_INTERVAL.ERROR_COUNT,
    CC_F_ACTUALS_QUEUE_INTERVAL.AGENT_ERROR_COUNT,
    CC_F_ACTUALS_QUEUE_INTERVAL.RETURN_RING,
    CC_F_ACTUALS_QUEUE_INTERVAL.INCOMPLETE_CALLS,
    CC_F_ACTUALS_QUEUE_INTERVAL.CALLS_GIVEN_FORCE_DISCONNECT,
    CC_F_ACTUALS_QUEUE_INTERVAL.CALLS_GIVEN_ROUTE_TO,
    CC_F_ACTUALS_QUEUE_INTERVAL.CREATE_DATE,
    CC_F_ACTUALS_QUEUE_INTERVAL.SHORT_CALLS,
    CC_F_ACTUALS_QUEUE_INTERVAL.LAST_UPDATE_DATE,
    CC_F_ACTUALS_QUEUE_INTERVAL.MAX_ABANDON_TIME,
    CC_F_ACTUALS_QUEUE_INTERVAL.QUEUE_NUMBER,
    CC_F_ACTUALS_QUEUE_INTERVAL.AGENT_LOGIN_ID,
    CC_F_ACTUALS_QUEUE_INTERVAL.ABANDON_THRESHOLD,
    CC_F_ACTUALS_QUEUE_INTERVAL.MAX_CALLS_QUEUED,
    CC_F_ACTUALS_QUEUE_INTERVAL.HANDLE_TIME,
    CC_F_ACTUALS_QUEUE_INTERVAL.CTVRU_TIME,
    CC_F_ACTUALS_QUEUE_INTERVAL.SERVICE_LEVEL_CALLS,
    CC_F_ACTUALS_QUEUE_INTERVAL.ROUTER_QUEUE_WAIT_TIME,
    CC_F_ACTUALS_QUEUE_INTERVAL.RAW_CONTACTS_OFFERED,
    ROUND( ( CASE WHEN (CC_F_ACTUALS_QUEUE_INTERVAL.CONTACTS_ABANDONED)!=0 THEN ((CC_F_ACTUALS_QUEUE_INTERVAL.ABANDON_TIME_TOTAL)/(CC_F_ACTUALS_QUEUE_INTERVAL.CONTACTS_ABANDONED))ELSE NULL END ),2) AVG_TIME_TO_ABANDON
  FROM CISCO_ENTERPRISE_CC.CC_F_ACTUALS_QUEUE_INTERVAL
  INNER JOIN CISCO_ENTERPRISE_CC.CC_D_CONTACT_QUEUE
  ON CC_F_ACTUALS_QUEUE_INTERVAL.D_CONTACT_QUEUE_ID = CC_D_CONTACT_QUEUE.D_CONTACT_QUEUE_ID
)	a11
	join	CISCO_ENTERPRISE_CC.CC_D_DATES	a12
	  on 	(a11.D_DATE_ID = a12.D_DATE_ID)
	left outer join	CISCO_ENTERPRISE_CC.CC_D_CONTACT_QUEUE	a13
	  on 	(a11.D_CONTACT_QUEUE_ID = a13.D_CONTACT_QUEUE_ID)
	left outer join	CISCO_ENTERPRISE_CC.CC_D_INTERVAL	a14
	  on 	(a11.D_INTERVAL_ID = a14.D_INTERVAL_ID)
	left outer join	CISCO_ENTERPRISE_CC.CC_D_PROJECT	a15
	  on 	(a11.D_PROJECT_ID = a15.PROJECT_ID)
	left outer join	CISCO_ENTERPRISE_CC.CC_D_PROGRAM	a16
	  on 	(a11.D_PROGRAM_ID = a16.PROGRAM_ID)
where	(a12.D_DATE between To_Date('01-06-2020', 'dd-mm-yyyy') and To_Date('30-06-2020', 'dd-mm-yyyy')
 and a15.PROJECT_NAME in ('NC UI')
 and a16.PROGRAM_NAME in ('Unemployment Insurance Helpline'))
group by	a12.WEEKEND_FLAG,
	a13.QUEUE_NAME,
	a15.PROJECT_NAME,
	a11.D_PROGRAM_ID,
	trunc(a14.INTERVAL_START_DATE,'HH'),
	a12.D_DATE,
	a13.QUEUE_TYPE 
)	pa11
	full outer join	
	(
	select	pa11.WEEKEND_FLAG  WEEKEND_FLAG,
	pa11.QUEUE_NAME  QUEUE_NAME,
	pa11.PROJECT_NAME  PROJECT_NAME,
	pa11.PROGRAM_ID  PROGRAM_ID,
	pa11.INTERVAL_START_DATE  INTERVAL_START_DATE,
	pa11.D_DATE  D_DATE,
	pa11.QUEUE_TYPE  QUEUE_TYPE,
	sum(pa11.WJXBFS4)  WJXBFS1
from	
(
select	a12.WEEKEND_FLAG  WEEKEND_FLAG,
	a13.QUEUE_NAME  QUEUE_NAME,
	a15.PROJECT_NAME  PROJECT_NAME,
	a11.D_PROGRAM_ID  PROGRAM_ID,
	trunc(a14.INTERVAL_START_DATE,'HH')  INTERVAL_START_DATE,
	a12.D_DATE  D_DATE,
	a13.QUEUE_TYPE  QUEUE_TYPE,
	sum(a11.CONTACTS_ABANDONED)  WJXBFS1,
	sum(a11.CONTACTS_HANDLED)  WJXBFS2,
	max(a11.MAX_SPEED_OF_ANSWER)  WJXBFS3,
	sum(a11.SERVICE_LEVEL_ABANDONED)  WJXBFS4,
	sum(a11.CONTACTS_OFFERED)  WJXBFS5,
	sum(a11.OUTFLOW_CONTACTS)  WJXBFS6,
	sum(a11.ERROR_COUNT)  WJXBFS7,
	sum(a11.ABANDON_TIME_TOTAL)  WJXBFS8,
	sum(a11.INCOMPLETE_CALLS)  WJXBFS9,
	sum(a11.SHORT_CALLS)  WJXBFSa,
	sum(a11.AGENT_ERROR_COUNT)  WJXBFSb,
	sum(a11.CALLS_ROUTED_NON_AGENT)  WJXBFSc,
	sum(a11.CALLS_RONA)  WJXBFSd,
	sum(a11.RETURN_RELEASE)  WJXBFSe,
	sum(a11.RETURN_BUSY)  WJXBFSf,
	sum(a11.RETURN_RING)  WJXBFS10,
	sum(a11.NETWORK_DEFAULT_ROUTED)  WJXBFS11,
	sum(a11.ICR_DEFAULT_ROUTED)  WJXBFS12,
	sum(a11.CALLS_GIVEN_ROUTE_TO)  WJXBFS13,
	sum(a11.CALLS_GIVEN_FORCE_DISCONNECT)  WJXBFS14,
	sum(a11.HOLD_TIME_TOTAL)  WJXBFS15,
	sum(a11.ANSWER_WAIT_TIME_TOTAL)  WJXBFS16,
	sum(a11.CONTACTS_TRANSFERRED)  WJXBFS17,
	sum(a11.CALLS_ANSWERED)  WJXBFS18,
	sum(a11.TALK_TIME_TOTAL)  WJXBFS19,
	sum(a11.AFTER_CALL_WORK_TIME_TOTAL)  WJXBFS1a
from	
(
SELECT CC_F_ACTUALS_QUEUE_INTERVAL.F_CALL_CENTER_ACTLS_INTRVL_ID,
    CC_F_ACTUALS_QUEUE_INTERVAL.D_DATE_ID,
    CC_D_CONTACT_QUEUE.D_PROJECT_ID,
    CC_D_CONTACT_QUEUE.D_PROGRAM_ID,
    CC_D_CONTACT_QUEUE.D_GEOGRAPHY_MASTER_ID,
    CC_D_CONTACT_QUEUE.D_UNIT_OF_WORK_ID,
    CC_F_ACTUALS_QUEUE_INTERVAL.D_CONTACT_QUEUE_ID,
    CC_F_ACTUALS_QUEUE_INTERVAL.D_INTERVAL_ID,
    CC_F_ACTUALS_QUEUE_INTERVAL.D_AGENT_ID,
    CC_F_ACTUALS_QUEUE_INTERVAL.CONTACTS_RECEIVED_FROM_IVR,
    CC_F_ACTUALS_QUEUE_INTERVAL.CALLS_ANSWERED,
    CC_F_ACTUALS_QUEUE_INTERVAL.CONTACTS_OFFERED,
    CC_F_ACTUALS_QUEUE_INTERVAL.CONTACTS_HANDLED,
    CC_F_ACTUALS_QUEUE_INTERVAL.CONTACTS_ABANDONED,
    CC_F_ACTUALS_QUEUE_INTERVAL.MIN_HANDLE_TIME,
    CC_F_ACTUALS_QUEUE_INTERVAL.MAX_HANDLE_TIME,
    CC_F_ACTUALS_QUEUE_INTERVAL.MEAN_HANDLE_TIME,
    CC_F_ACTUALS_QUEUE_INTERVAL.MEDIAN_HANDLE_TIME,
    CC_F_ACTUALS_QUEUE_INTERVAL.STDDEV_HANDLE_TIME,
    CC_F_ACTUALS_QUEUE_INTERVAL.MIN_SPEED_TO_HANDLE,
    CC_F_ACTUALS_QUEUE_INTERVAL.MAX_SPEED_TO_HANDLE,
    CC_F_ACTUALS_QUEUE_INTERVAL.MEAN_SPEED_TO_HANDLE,
    CC_F_ACTUALS_QUEUE_INTERVAL.MEDIAN_SPEED_TO_HANDLE,
    CC_F_ACTUALS_QUEUE_INTERVAL.STDDEV_SPEED_TO_HANDLE,
    CC_F_ACTUALS_QUEUE_INTERVAL.MIN_SPEED_OF_ANSWER,
    CC_F_ACTUALS_QUEUE_INTERVAL.MAX_SPEED_OF_ANSWER,
    CC_F_ACTUALS_QUEUE_INTERVAL.MEAN_SPEED_OF_ANSWER,
    CC_F_ACTUALS_QUEUE_INTERVAL.MEDIAN_SPEED_OF_ANSWER,
    CC_F_ACTUALS_QUEUE_INTERVAL.STDDEV_SPEED_OF_ANSWER,
    CC_F_ACTUALS_QUEUE_INTERVAL.SPEED_OF_ANSWER_PERIOD_1,
    CC_F_ACTUALS_QUEUE_INTERVAL.SPEED_OF_ANSWER_PERIOD_2,
    CC_F_ACTUALS_QUEUE_INTERVAL.SPEED_OF_ANSWER_PERIOD_3,
    CC_F_ACTUALS_QUEUE_INTERVAL.SPEED_OF_ANSWER_PERIOD_4,
    CC_F_ACTUALS_QUEUE_INTERVAL.SPEED_OF_ANSWER_PERIOD_5,
    CC_F_ACTUALS_QUEUE_INTERVAL.SPEED_OF_ANSWER_PERIOD_6,
    CC_F_ACTUALS_QUEUE_INTERVAL.SPEED_OF_ANSWER_PERIOD_7,
    CC_F_ACTUALS_QUEUE_INTERVAL.SPEED_OF_ANSWER_PERIOD_8,
    CC_F_ACTUALS_QUEUE_INTERVAL.SPEED_OF_ANSWER_PERIOD_9,
    CC_F_ACTUALS_QUEUE_INTERVAL.SPEED_OF_ANSWER_PERIOD_10,
    CC_F_ACTUALS_QUEUE_INTERVAL.CALLS_ABANDONED_PERIOD_1,
    CC_F_ACTUALS_QUEUE_INTERVAL.CALLS_ABANDONED_PERIOD_2,
    CC_F_ACTUALS_QUEUE_INTERVAL.CALLS_ABANDONED_PERIOD_3,
    CC_F_ACTUALS_QUEUE_INTERVAL.CALLS_ABANDONED_PERIOD_4,
    CC_F_ACTUALS_QUEUE_INTERVAL.CALLS_ABANDONED_PERIOD_5,
    CC_F_ACTUALS_QUEUE_INTERVAL.CALLS_ABANDONED_PERIOD_6,
    CC_F_ACTUALS_QUEUE_INTERVAL.CALLS_ABANDONED_PERIOD_7,
    CC_F_ACTUALS_QUEUE_INTERVAL.CALLS_ABANDONED_PERIOD_8,
    CC_F_ACTUALS_QUEUE_INTERVAL.CALLS_ABANDONED_PERIOD_9,
    CC_F_ACTUALS_QUEUE_INTERVAL.CALLS_ABANDONED_PERIOD_10,
    CC_F_ACTUALS_QUEUE_INTERVAL.LABOR_MINUTES_TOTAL,
    CC_F_ACTUALS_QUEUE_INTERVAL.LABOR_MINUTES_AVAILABLE,
    CC_F_ACTUALS_QUEUE_INTERVAL.LABOR_MINUTES_WAITING,
    CC_F_ACTUALS_QUEUE_INTERVAL.HEADCOUNT_TOTAL,
    CC_F_ACTUALS_QUEUE_INTERVAL.HEADCOUNT_AVAILABLE,
    CC_F_ACTUALS_QUEUE_INTERVAL.HEADCOUNT_UNAVAILABLE,
    CC_F_ACTUALS_QUEUE_INTERVAL.CONTACT_INVENTORY,
    CC_F_ACTUALS_QUEUE_INTERVAL.CONTACT_INVENTORY_JEOPARDY,
    CC_F_ACTUALS_QUEUE_INTERVAL.MIN_CONTACT_INVENTORY_AGE,
    CC_F_ACTUALS_QUEUE_INTERVAL.MAX_CONTACT_INVENTORY_AGE,
    CC_F_ACTUALS_QUEUE_INTERVAL.MEAN_CONTACT_INVENTORY_AGE,
    CC_F_ACTUALS_QUEUE_INTERVAL.MEDIAN_CONTACT_INVENTORY_AGE,
    CC_F_ACTUALS_QUEUE_INTERVAL.STDDEV_CONTACT_INVENTORY_AGE,
    CC_F_ACTUALS_QUEUE_INTERVAL.CONTACTS_TRANSFERRED,
    CC_F_ACTUALS_QUEUE_INTERVAL.OUTFLOW_CONTACTS,
    CC_F_ACTUALS_QUEUE_INTERVAL.ANSWER_WAIT_TIME_TOTAL,
    CC_F_ACTUALS_QUEUE_INTERVAL.ABANDON_TIME_TOTAL,
    CC_F_ACTUALS_QUEUE_INTERVAL.TALK_TIME_TOTAL,
    CC_F_ACTUALS_QUEUE_INTERVAL.AFTER_CALL_WORK_TIME_TOTAL,
    CC_F_ACTUALS_QUEUE_INTERVAL.SERVICE_LEVEL_ANSWERED_PERCENT,
    CC_F_ACTUALS_QUEUE_INTERVAL.SERVICE_LEVEL_ANSWERED_COUNT,
    CC_F_ACTUALS_QUEUE_INTERVAL.SERVICE_LEVEL_ABANDONED,
    CC_F_ACTUALS_QUEUE_INTERVAL.CALLS_ON_HOLD,
    CC_F_ACTUALS_QUEUE_INTERVAL.HOLD_TIME_TOTAL,
    CC_F_ACTUALS_QUEUE_INTERVAL.SHORT_ABANDONS,
    CC_F_ACTUALS_QUEUE_INTERVAL.CONTACTS_BLOCKED,
    CC_F_ACTUALS_QUEUE_INTERVAL.ICR_DEFAULT_ROUTED,
    CC_F_ACTUALS_QUEUE_INTERVAL.NETWORK_DEFAULT_ROUTED,
    CC_F_ACTUALS_QUEUE_INTERVAL.RETURN_BUSY,
    CC_F_ACTUALS_QUEUE_INTERVAL.CALLS_RONA,
    CC_F_ACTUALS_QUEUE_INTERVAL.RETURN_RELEASE,
    CC_F_ACTUALS_QUEUE_INTERVAL.CALLS_ROUTED_NON_AGENT,
    CC_F_ACTUALS_QUEUE_INTERVAL.ERROR_COUNT,
    CC_F_ACTUALS_QUEUE_INTERVAL.AGENT_ERROR_COUNT,
    CC_F_ACTUALS_QUEUE_INTERVAL.RETURN_RING,
    CC_F_ACTUALS_QUEUE_INTERVAL.INCOMPLETE_CALLS,
    CC_F_ACTUALS_QUEUE_INTERVAL.CALLS_GIVEN_FORCE_DISCONNECT,
    CC_F_ACTUALS_QUEUE_INTERVAL.CALLS_GIVEN_ROUTE_TO,
    CC_F_ACTUALS_QUEUE_INTERVAL.CREATE_DATE,
    CC_F_ACTUALS_QUEUE_INTERVAL.SHORT_CALLS,
    CC_F_ACTUALS_QUEUE_INTERVAL.LAST_UPDATE_DATE,
    CC_F_ACTUALS_QUEUE_INTERVAL.MAX_ABANDON_TIME,
    CC_F_ACTUALS_QUEUE_INTERVAL.QUEUE_NUMBER,
    CC_F_ACTUALS_QUEUE_INTERVAL.AGENT_LOGIN_ID,
    CC_F_ACTUALS_QUEUE_INTERVAL.ABANDON_THRESHOLD,
    CC_F_ACTUALS_QUEUE_INTERVAL.MAX_CALLS_QUEUED,
    CC_F_ACTUALS_QUEUE_INTERVAL.HANDLE_TIME,
    CC_F_ACTUALS_QUEUE_INTERVAL.CTVRU_TIME,
    CC_F_ACTUALS_QUEUE_INTERVAL.SERVICE_LEVEL_CALLS,
    CC_F_ACTUALS_QUEUE_INTERVAL.ROUTER_QUEUE_WAIT_TIME,
    CC_F_ACTUALS_QUEUE_INTERVAL.RAW_CONTACTS_OFFERED,
    ROUND( ( CASE WHEN (CC_F_ACTUALS_QUEUE_INTERVAL.CONTACTS_ABANDONED)!=0 THEN ((CC_F_ACTUALS_QUEUE_INTERVAL.ABANDON_TIME_TOTAL)/(CC_F_ACTUALS_QUEUE_INTERVAL.CONTACTS_ABANDONED))ELSE NULL END ),2) AVG_TIME_TO_ABANDON
  FROM CISCO_ENTERPRISE_CC.CC_F_ACTUALS_QUEUE_INTERVAL
  INNER JOIN CISCO_ENTERPRISE_CC.CC_D_CONTACT_QUEUE
  ON CC_F_ACTUALS_QUEUE_INTERVAL.D_CONTACT_QUEUE_ID = CC_D_CONTACT_QUEUE.D_CONTACT_QUEUE_ID
)	a11
	join	CISCO_ENTERPRISE_CC.CC_D_DATES	a12
	  on 	(a11.D_DATE_ID = a12.D_DATE_ID)
	left outer join	CISCO_ENTERPRISE_CC.CC_D_CONTACT_QUEUE	a13
	  on 	(a11.D_CONTACT_QUEUE_ID = a13.D_CONTACT_QUEUE_ID)
	left outer join	CISCO_ENTERPRISE_CC.CC_D_INTERVAL	a14
	  on 	(a11.D_INTERVAL_ID = a14.D_INTERVAL_ID)
	left outer join	CISCO_ENTERPRISE_CC.CC_D_PROJECT	a15
	  on 	(a11.D_PROJECT_ID = a15.PROJECT_ID)
	left outer join	CISCO_ENTERPRISE_CC.CC_D_PROGRAM	a16
	  on 	(a11.D_PROGRAM_ID = a16.PROGRAM_ID)
where	(a12.D_DATE between To_Date('01-06-2020', 'dd-mm-yyyy') and To_Date('30-06-2020', 'dd-mm-yyyy')
 and a15.PROJECT_NAME in ('NC UI')
 and a16.PROGRAM_NAME in ('Unemployment Insurance Helpline'))
group by	a12.WEEKEND_FLAG,
	a13.QUEUE_NAME,
	a15.PROJECT_NAME,
	a11.D_PROGRAM_ID,
	trunc(a14.INTERVAL_START_DATE,'HH'),
	a12.D_DATE,
	a13.QUEUE_TYPE 
)	pa11
	left outer join	CISCO_ENTERPRISE_CC.CC_D_PROGRAM	a12
	  on 	(pa11.PROGRAM_ID = a12.PROGRAM_ID)
where	(pa11.D_DATE between To_Date('01-06-2020', 'dd-mm-yyyy') and To_Date('30-06-2020', 'dd-mm-yyyy')
 and pa11.PROJECT_NAME in ('NC UI')
 and a12.PROGRAM_NAME in ('Unemployment Insurance Helpline'))
group by	pa11.WEEKEND_FLAG,
	pa11.QUEUE_NAME,
	pa11.PROJECT_NAME,
	pa11.PROGRAM_ID,
	pa11.INTERVAL_START_DATE,
	pa11.D_DATE,
	pa11.QUEUE_TYPE 
)	pa12
	  on 	(pa11.D_DATE = pa12.D_DATE and 
	pa11.INTERVAL_START_DATE = pa12.INTERVAL_START_DATE and 
	pa11.PROGRAM_ID = pa12.PROGRAM_ID and 
	pa11.PROJECT_NAME = pa12.PROJECT_NAME and 
	pa11.QUEUE_NAME = pa12.QUEUE_NAME and 
	pa11.QUEUE_TYPE = pa12.QUEUE_TYPE and 
	pa11.WEEKEND_FLAG = pa12.WEEKEND_FLAG)
	left outer join	CISCO_ENTERPRISE_CC.CC_D_DATES	a13
	  on 	(coalesce(pa11.D_DATE, pa12.D_DATE) = a13.D_DATE and 
	coalesce(pa11.WEEKEND_FLAG, pa12.WEEKEND_FLAG) = a13.WEEKEND_FLAG)
	left outer join	CISCO_ENTERPRISE_CC.CC_D_PROGRAM	a14
	  on 	(coalesce(pa11.PROGRAM_ID, pa12.PROGRAM_ID) = a14.PROGRAM_ID)
order by coalesce(pa11.D_DATE, pa12.D_DATE)
